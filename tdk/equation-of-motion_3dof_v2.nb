(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    192199,       5167]
NotebookOptionsPosition[    186316,       4973]
NotebookOutlinePosition[    186659,       4988]
CellTagsIndexPosition[    186616,       4985]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.6971365613031254`*^9, 3.6971365613061275`*^9}}],

Cell[CellGroupData[{

Cell["Angular velocities", "Subsection",
 CellChangeTimes->{{3.6984308605013776`*^9, 3.698430864163656*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"theta0", " ", "=", " ", 
  RowBox[{"fi0", "+", 
   RowBox[{"q0", "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"theta1", " ", "=", " ", 
  RowBox[{"theta0", "+", 
   RowBox[{"q1", "[", "t", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"theta2", " ", "=", " ", 
  RowBox[{"theta1", " ", "+", 
   RowBox[{"q2", "[", "t", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7142864116030264`*^9, 3.714286429594742*^9}, {
  3.7142864762366505`*^9, 3.7142865261112113`*^9}, {3.7142865617120247`*^9, 
  3.714286600466032*^9}, {3.7142866734917626`*^9, 3.7142866760457926`*^9}}],

Cell[BoxData[
 RowBox[{"fi0", "+", 
  RowBox[{"q0", "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{3.714286676862116*^9, 3.714722660009731*^9}],

Cell[BoxData[
 RowBox[{"fi0", "+", 
  RowBox[{"q0", "[", "t", "]"}], "+", 
  RowBox[{"q1", "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{3.714286676862116*^9, 3.714722660011733*^9}],

Cell[BoxData[
 RowBox[{"fi0", "+", 
  RowBox[{"q0", "[", "t", "]"}], "+", 
  RowBox[{"q1", "[", "t", "]"}], "+", 
  RowBox[{"q2", "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{3.714286676862116*^9, 3.714722660012734*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"omega0", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"theta0", ",", "t"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"omega1", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"theta1", ",", "t"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"omega2", " ", "=", " ", 
  RowBox[{"D", "[", 
   RowBox[{"theta2", ",", "t"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7142866293099937`*^9, 3.7142866696174893`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["q0", "\[Prime]",
   MultilineFunction->None], "[", "t", "]"}]], "Output",
 CellChangeTimes->{3.714286680848472*^9, 3.7147226600767994`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["q0", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "+", 
  RowBox[{
   SuperscriptBox["q1", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{3.714286680848472*^9, 3.7147226600788*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["q0", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "+", 
  RowBox[{
   SuperscriptBox["q1", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}], "+", 
  RowBox[{
   SuperscriptBox["q2", "\[Prime]",
    MultilineFunction->None], "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{3.714286680848472*^9, 3.7147226600797997`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rang", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Lang", " ", 
     RowBox[{"Cos", "[", "ang", "]"}]}], ",", 
    RowBox[{"Lang", " ", 
     RowBox[{"Sin", "[", "ang", "]"}]}], ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.714286824277787*^9, 3.714286883401086*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Lang", " ", 
    RowBox[{"Cos", "[", "ang", "]"}]}], ",", 
   RowBox[{"Lang", " ", 
    RowBox[{"Sin", "[", "ang", "]"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.7142868851907935`*^9, 3.714722660105818*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Position vectors", "Subsection",
 CellChangeTimes->{{3.6984308399903936`*^9, 3.6984308461805573`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"r0", " ", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x0", "[", "t", "]"}], ",", " ", 
    RowBox[{"y0", "[", "t", "]"}], ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"r1", " ", "=", 
  RowBox[{"r0", "+", 
   RowBox[{"(", 
    RowBox[{"rang", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lang", "\[Rule]", "l0"}], ",", 
       RowBox[{"ang", "\[Rule]", "theta0"}]}], "}"}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"rang", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lang", "\[Rule]", 
        RowBox[{"l1", "/", "2"}]}], ",", 
       RowBox[{"ang", "\[Rule]", "theta1"}]}], "}"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"r2", " ", "=", " ", 
  RowBox[{"r0", "+", 
   RowBox[{"(", 
    RowBox[{"rang", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lang", "\[Rule]", "l0"}], ",", 
       RowBox[{"ang", "\[Rule]", "theta0"}]}], "}"}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"rang", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lang", "\[Rule]", "l1"}], ",", 
       RowBox[{"ang", "\[Rule]", "theta1"}]}], "}"}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"rang", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lang", "\[Rule]", 
        RowBox[{"l2", "/", "2"}]}], ",", 
       RowBox[{"ang", "\[Rule]", "theta2"}]}], "}"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"rd", " ", "=", " ", 
  RowBox[{"r0", "+", 
   RowBox[{"(", 
    RowBox[{"rang", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lang", "\[Rule]", "l0"}], ",", 
       RowBox[{"ang", "\[Rule]", "theta0"}]}], "}"}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"rang", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lang", "\[Rule]", "l1"}], ",", 
       RowBox[{"ang", "\[Rule]", "theta1"}]}], "}"}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"rang", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lang", "\[Rule]", "l2"}], ",", 
       RowBox[{"ang", "\[Rule]", "theta2"}]}], "}"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"r10", " ", "=", 
  RowBox[{"r0", "+", 
   RowBox[{"(", 
    RowBox[{"rang", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lang", "\[Rule]", "l0"}], ",", 
       RowBox[{"ang", "\[Rule]", "theta0"}]}], "}"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"r20", " ", "=", 
  RowBox[{"r0", "+", 
   RowBox[{"(", 
    RowBox[{"rang", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lang", "\[Rule]", "l0"}], ",", 
       RowBox[{"ang", "\[Rule]", "theta0"}]}], "}"}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"rang", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lang", "\[Rule]", "l1"}], ",", 
       RowBox[{"ang", "\[Rule]", "theta1"}]}], "}"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.6984280056741705`*^9, 3.6984282717928925`*^9}, {
  3.7088609353946524`*^9, 3.708860940705777*^9}, {3.7088609797511244`*^9, 
  3.7088610208683567`*^9}, {3.7098926402694263`*^9, 3.709892648331767*^9}, {
  3.7142823897919264`*^9, 3.7142823945812683`*^9}, {3.7142867203560143`*^9, 
  3.7142868018393893`*^9}, {3.7142868969789524`*^9, 3.7142870128560095`*^9}, {
  3.7142870583441205`*^9, 3.7142870791394076`*^9}, {3.7142871370592065`*^9, 
  3.7142871603987613`*^9}, {3.7142871933169746`*^9, 3.714287284053377*^9}, {
  3.7142884663155956`*^9, 3.7142884805202007`*^9}, {3.714723557428215*^9, 
  3.714723618258305*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x0", "[", "t", "]"}], ",", 
   RowBox[{"y0", "[", "t", "]"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6984282817739153`*^9, 3.6989923837228546`*^9, 3.6989930670400066`*^9, 
   3.6990397790414057`*^9, 3.699042574255638*^9, 3.6990839484285307`*^9, 
   3.699085079519115*^9, 3.7018625455916657`*^9, 3.70886102758255*^9, 
   3.709529638470129*^9, 3.709892071101638*^9, {3.7098926509565077`*^9, 
   3.709892657536871*^9}, 3.7098950529658923`*^9, 3.7106759292078123`*^9, 
   3.714282403125633*^9, 3.7142828633208613`*^9, 3.7142869905875196`*^9, 
   3.7142870243863306`*^9, 3.714287066364941*^9, 3.7142872315133333`*^9, {
   3.714287271321179*^9, 3.714287286423515*^9}, 3.714288482054431*^9, 
   3.7147226601158237`*^9, {3.714723600797925*^9, 3.7147236190895224`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"l0", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "l1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"x0", "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{"l0", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "l1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"y0", "[", "t", "]"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6984282817739153`*^9, 3.6989923837228546`*^9, 3.6989930670400066`*^9, 
   3.6990397790414057`*^9, 3.699042574255638*^9, 3.6990839484285307`*^9, 
   3.699085079519115*^9, 3.7018625455916657`*^9, 3.70886102758255*^9, 
   3.709529638470129*^9, 3.709892071101638*^9, {3.7098926509565077`*^9, 
   3.709892657536871*^9}, 3.7098950529658923`*^9, 3.7106759292078123`*^9, 
   3.714282403125633*^9, 3.7142828633208613`*^9, 3.7142869905875196`*^9, 
   3.7142870243863306`*^9, 3.714287066364941*^9, 3.7142872315133333`*^9, {
   3.714287271321179*^9, 3.714287286423515*^9}, 3.714288482054431*^9, 
   3.7147226601158237`*^9, {3.714723600797925*^9, 3.7147236190945244`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"l0", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"l1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "l2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"x0", "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{"l0", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"l1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{
     FractionBox["1", "2"], " ", "l2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"y0", "[", "t", "]"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6984282817739153`*^9, 3.6989923837228546`*^9, 3.6989930670400066`*^9, 
   3.6990397790414057`*^9, 3.699042574255638*^9, 3.6990839484285307`*^9, 
   3.699085079519115*^9, 3.7018625455916657`*^9, 3.70886102758255*^9, 
   3.709529638470129*^9, 3.709892071101638*^9, {3.7098926509565077`*^9, 
   3.709892657536871*^9}, 3.7098950529658923`*^9, 3.7106759292078123`*^9, 
   3.714282403125633*^9, 3.7142828633208613`*^9, 3.7142869905875196`*^9, 
   3.7142870243863306`*^9, 3.714287066364941*^9, 3.7142872315133333`*^9, {
   3.714287271321179*^9, 3.714287286423515*^9}, 3.714288482054431*^9, 
   3.7147226601158237`*^9, {3.714723600797925*^9, 3.7147236190985274`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"l0", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"l1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"l2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"x0", "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{"l0", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"l1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"l2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"y0", "[", "t", "]"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6984282817739153`*^9, 3.6989923837228546`*^9, 3.6989930670400066`*^9, 
   3.6990397790414057`*^9, 3.699042574255638*^9, 3.6990839484285307`*^9, 
   3.699085079519115*^9, 3.7018625455916657`*^9, 3.70886102758255*^9, 
   3.709529638470129*^9, 3.709892071101638*^9, {3.7098926509565077`*^9, 
   3.709892657536871*^9}, 3.7098950529658923`*^9, 3.7106759292078123`*^9, 
   3.714282403125633*^9, 3.7142828633208613`*^9, 3.7142869905875196`*^9, 
   3.7142870243863306`*^9, 3.714287066364941*^9, 3.7142872315133333`*^9, {
   3.714287271321179*^9, 3.714287286423515*^9}, 3.714288482054431*^9, 
   3.7147226601158237`*^9, {3.714723600797925*^9, 3.71472361910153*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"l0", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"x0", "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{"l0", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"y0", "[", "t", "]"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6984282817739153`*^9, 3.6989923837228546`*^9, 3.6989930670400066`*^9, 
   3.6990397790414057`*^9, 3.699042574255638*^9, 3.6990839484285307`*^9, 
   3.699085079519115*^9, 3.7018625455916657`*^9, 3.70886102758255*^9, 
   3.709529638470129*^9, 3.709892071101638*^9, {3.7098926509565077`*^9, 
   3.709892657536871*^9}, 3.7098950529658923`*^9, 3.7106759292078123`*^9, 
   3.714282403125633*^9, 3.7142828633208613`*^9, 3.7142869905875196`*^9, 
   3.7142870243863306`*^9, 3.714287066364941*^9, 3.7142872315133333`*^9, {
   3.714287271321179*^9, 3.714287286423515*^9}, 3.714288482054431*^9, 
   3.7147226601158237`*^9, {3.714723600797925*^9, 3.7147236191045303`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"l0", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"l1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"x0", "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{"l0", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"l1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"y0", "[", "t", "]"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6984282817739153`*^9, 3.6989923837228546`*^9, 3.6989930670400066`*^9, 
   3.6990397790414057`*^9, 3.699042574255638*^9, 3.6990839484285307`*^9, 
   3.699085079519115*^9, 3.7018625455916657`*^9, 3.70886102758255*^9, 
   3.709529638470129*^9, 3.709892071101638*^9, {3.7098926509565077`*^9, 
   3.709892657536871*^9}, 3.7098950529658923`*^9, 3.7106759292078123`*^9, 
   3.714282403125633*^9, 3.7142828633208613`*^9, 3.7142869905875196`*^9, 
   3.7142870243863306`*^9, 3.714287066364941*^9, 3.7142872315133333`*^9, {
   3.714287271321179*^9, 3.714287286423515*^9}, 3.714288482054431*^9, 
   3.7147226601158237`*^9, {3.714723600797925*^9, 3.7147236191075325`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Center of mass", "Subsection",
 CellChangeTimes->{{3.698430829680691*^9, 3.6984308321185875`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"com", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"m0", " ", "r0"}], "+", 
     RowBox[{"m1", " ", "r1"}], "+", 
     RowBox[{"m2", " ", "r2"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.698428293716056*^9, 3.698428325486007*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{"m0", "+", "m1", "+", "m2"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"m0", " ", 
       RowBox[{"x0", "[", "t", "]"}]}], "+", 
      RowBox[{"m1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"l0", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"fi0", "+", 
            RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{
          FractionBox["1", "2"], " ", "l1", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"fi0", "+", 
            RowBox[{"q0", "[", "t", "]"}], "+", 
            RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"x0", "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{"m2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"l0", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"fi0", "+", 
            RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"l1", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"fi0", "+", 
            RowBox[{"q0", "[", "t", "]"}], "+", 
            RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{
          FractionBox["1", "2"], " ", "l2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"fi0", "+", 
            RowBox[{"q0", "[", "t", "]"}], "+", 
            RowBox[{"q1", "[", "t", "]"}], "+", 
            RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"x0", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"m0", "+", "m1", "+", "m2"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"m0", " ", 
       RowBox[{"y0", "[", "t", "]"}]}], "+", 
      RowBox[{"m1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"l0", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"fi0", "+", 
            RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{
          FractionBox["1", "2"], " ", "l1", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"fi0", "+", 
            RowBox[{"q0", "[", "t", "]"}], "+", 
            RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"y0", "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{"m2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"l0", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"fi0", "+", 
            RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"l1", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"fi0", "+", 
            RowBox[{"q0", "[", "t", "]"}], "+", 
            RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{
          FractionBox["1", "2"], " ", "l2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"fi0", "+", 
            RowBox[{"q0", "[", "t", "]"}], "+", 
            RowBox[{"q1", "[", "t", "]"}], "+", 
            RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"y0", "[", "t", "]"}]}], ")"}]}]}], ")"}]}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6984283308326015`*^9, 3.6989923837418675`*^9, 
  3.698993067061015*^9, 3.699039779059571*^9, 3.6990425742736483`*^9, 
  3.699083948451539*^9, 3.6990850795351257`*^9, 3.7018625456106777`*^9, 
  3.7088610335981474`*^9, 3.709529640344378*^9, 3.709892071140663*^9, 
  3.709892657552879*^9, 3.709895052991909*^9, 3.7106759308408957`*^9, 
  3.714282403158166*^9, 3.7142828633358746`*^9, 3.7142873165089293`*^9, 
  3.7147226601353407`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Position vectors relative to the center of mass", "Subsection",
 CellChangeTimes->{{3.6984308107559185`*^9, 3.6984308518922863`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rho0", "=", 
  RowBox[{
   RowBox[{"r0", "-", "com"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"rho1", "=", 
  RowBox[{
   RowBox[{"r1", "-", "com"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"rho2", "=", 
  RowBox[{
   RowBox[{"r2", "-", "com"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"rhod", "=", 
  RowBox[{
   RowBox[{"rd", "-", "com"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"rho10", "=", 
  RowBox[{
   RowBox[{"r10", "-", "com"}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"rho20", "=", 
  RowBox[{
   RowBox[{"r20", "-", "com"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.6984283667485223`*^9, 3.698428370548628*^9}, {
   3.6984284361487255`*^9, 3.6984285100473022`*^9}, 3.7095296516369*^9, {
   3.714287321282016*^9, 3.714287327221554*^9}, {3.714288508831519*^9, 
   3.7142885151247025`*^9}, {3.7147236353858733`*^9, 3.7147236451870995`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"2", " ", "l0", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", "m2"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"l1", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", 
         RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}], "+", 
         RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"l2", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}], "+", 
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"2", " ", "l0", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", "m2"}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"l1", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", 
         RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}], "+", 
         RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"l2", " ", "m2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}], "+", 
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6984284755077267`*^9, 3.6984285105431643`*^9}, 
   3.6989923846454706`*^9, 3.6989930678955717`*^9, 3.6990397800707817`*^9, 
   3.699042575310317*^9, 3.6990839496313286`*^9, 3.699085080424719*^9, 
   3.7018625467744536`*^9, 3.7088610384984164`*^9, {3.70952964408887*^9, 
   3.7095296602466354`*^9}, 3.7098920724925575`*^9, 3.7098926585005054`*^9, 
   3.709895054006581*^9, 3.7106759342289095`*^9, 3.7142824048716526`*^9, 
   3.7142828645424056`*^9, 3.7142873285689692`*^9, 3.7142885169193945`*^9, 
   3.7147226609205403`*^9, 3.7147236461862755`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "l0", " ", "m0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "-", "m2"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "-", 
     RowBox[{"l2", " ", "m2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "l0", " ", "m0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "-", "m2"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "-", 
     RowBox[{"l2", " ", "m2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6984284755077267`*^9, 3.6984285105431643`*^9}, 
   3.6989923846454706`*^9, 3.6989930678955717`*^9, 3.6990397800707817`*^9, 
   3.699042575310317*^9, 3.6990839496313286`*^9, 3.699085080424719*^9, 
   3.7018625467744536`*^9, 3.7088610384984164`*^9, {3.70952964408887*^9, 
   3.7095296602466354`*^9}, 3.7098920724925575`*^9, 3.7098926585005054`*^9, 
   3.709895054006581*^9, 3.7106759342289095`*^9, 3.7142824048716526`*^9, 
   3.7142828645424056`*^9, 3.7142873285689692`*^9, 3.7142885169193945`*^9, 
   3.7147226609205403`*^9, 3.7147236461912775`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "l0", " ", "m0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"l2", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "+", "m1"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "l0", " ", "m0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"l2", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "+", "m1"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6984284755077267`*^9, 3.6984285105431643`*^9}, 
   3.6989923846454706`*^9, 3.6989930678955717`*^9, 3.6990397800707817`*^9, 
   3.699042575310317*^9, 3.6990839496313286`*^9, 3.699085080424719*^9, 
   3.7018625467744536`*^9, 3.7088610384984164`*^9, {3.70952964408887*^9, 
   3.7095296602466354`*^9}, 3.7098920724925575`*^9, 3.7098926585005054`*^9, 
   3.709895054006581*^9, 3.7106759342289095`*^9, 3.7142824048716526`*^9, 
   3.7142828645424056`*^9, 3.7142873285689692`*^9, 3.7142885169193945`*^9, 
   3.7147226609205403`*^9, 3.7147236461952972`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "l0", " ", "m0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"l2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", 
        RowBox[{"2", " ", "m1"}], "+", "m2"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "l0", " ", "m0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"l2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", 
        RowBox[{"2", " ", "m1"}], "+", "m2"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6984284755077267`*^9, 3.6984285105431643`*^9}, 
   3.6989923846454706`*^9, 3.6989930678955717`*^9, 3.6990397800707817`*^9, 
   3.699042575310317*^9, 3.6990839496313286`*^9, 3.699085080424719*^9, 
   3.7018625467744536`*^9, 3.7088610384984164`*^9, {3.70952964408887*^9, 
   3.7095296602466354`*^9}, 3.7098920724925575`*^9, 3.7098926585005054`*^9, 
   3.709895054006581*^9, 3.7106759342289095`*^9, 3.7142824048716526`*^9, 
   3.7142828645424056`*^9, 3.7142873285689692`*^9, 3.7142885169193945`*^9, 
   3.7147226609205403`*^9, 3.7147236461992917`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "l0", " ", "m0", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"l1", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", 
         RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}], "+", 
         RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"l2", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}], "+", 
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "l0", " ", "m0", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"l1", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", 
         RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}], "+", 
         RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"l2", " ", "m2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}], "+", 
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6984284755077267`*^9, 3.6984285105431643`*^9}, 
   3.6989923846454706`*^9, 3.6989930678955717`*^9, 3.6990397800707817`*^9, 
   3.699042575310317*^9, 3.6990839496313286`*^9, 3.699085080424719*^9, 
   3.7018625467744536`*^9, 3.7088610384984164`*^9, {3.70952964408887*^9, 
   3.7095296602466354`*^9}, 3.7098920724925575`*^9, 3.7098926585005054`*^9, 
   3.709895054006581*^9, 3.7106759342289095`*^9, 3.7142824048716526`*^9, 
   3.7142828645424056`*^9, 3.7142873285689692`*^9, 3.7142885169193945`*^9, 
   3.7147226609205403`*^9, 3.7147236463764143`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "l0", " ", "m0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "-", 
     RowBox[{"l2", " ", "m2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "l0", " ", "m0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "-", 
     RowBox[{"l2", " ", "m2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6984284755077267`*^9, 3.6984285105431643`*^9}, 
   3.6989923846454706`*^9, 3.6989930678955717`*^9, 3.6990397800707817`*^9, 
   3.699042575310317*^9, 3.6990839496313286`*^9, 3.699085080424719*^9, 
   3.7018625467744536`*^9, 3.7088610384984164`*^9, {3.70952964408887*^9, 
   3.7095296602466354`*^9}, 3.7098920724925575`*^9, 3.7098926585005054`*^9, 
   3.709895054006581*^9, 3.7106759342289095`*^9, 3.7142824048716526`*^9, 
   3.7142828645424056`*^9, 3.7142873285689692`*^9, 3.7142885169193945`*^9, 
   3.7147226609205403`*^9, 3.7147236465386553`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Velocity vectors", "Subsection",
 CellChangeTimes->{{3.69843079953032*^9, 3.6984308042501507`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"v0", "=", 
  RowBox[{"D", "[", 
   RowBox[{"rho0", ",", "t"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"v1", "=", 
  RowBox[{"D", "[", 
   RowBox[{"rho1", ",", "t"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"v2", "=", 
  RowBox[{"D", "[", 
   RowBox[{"rho2", ",", "t"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"vd", "=", 
  RowBox[{"D", "[", 
   RowBox[{"rhod", ",", "t"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.697135776515443*^9, 3.6971358334930573`*^9}, {
   3.6971359184542656`*^9, 3.6971359657885733`*^9}, {3.697136229985115*^9, 
   3.6971362313530207`*^9}, 3.6971363593814106`*^9, {3.6971366253625035`*^9, 
   3.697136831742402*^9}, {3.6971371169471846`*^9, 3.6971371740809836`*^9}, {
   3.6971419863900104`*^9, 3.697142010299828*^9}, {3.6972235572631454`*^9, 
   3.6972235994251213`*^9}, {3.697223663567761*^9, 3.6972237035282745`*^9}, {
   3.6972239170903006`*^9, 3.697223943922103*^9}, {3.6972239985044236`*^9, 
   3.6972240193482523`*^9}, {3.6984286022862396`*^9, 3.698428637879175*^9}, {
   3.7142885263071566`*^9, 3.7142885318707685`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "l0", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", "m2"}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["q0", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "-", 
      RowBox[{"l1", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", 
         RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}], "+", 
         RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q0", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q1", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
      RowBox[{"l2", " ", "m2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}], "+", 
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q0", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q1", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q2", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"2", " ", "l0", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", "m2"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["q0", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{"l1", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", 
         RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}], "+", 
         RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q0", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q1", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
      RowBox[{"l2", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"fi0", "+", 
         RowBox[{"q0", "[", "t", "]"}], "+", 
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q0", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q1", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q2", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.698428665148799*^9, 3.6989923855650835`*^9, 
  3.698993068842203*^9, 3.699039781169641*^9, 3.6990425762441325`*^9, 
  3.6990839505699663`*^9, 3.6990850814804296`*^9, 3.701862548260443*^9, 
  3.70886104367562*^9, 3.709892073805435*^9, 3.709892659731321*^9, 
  3.709895055329458*^9, 3.7106759380974736`*^9, 3.7142824062072515`*^9, 
  3.7142828658019943`*^9, 3.714287333986226*^9, 3.714288532443118*^9, 
  3.714722661816888*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "l0", " ", "m0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["q0", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "-", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "-", "m2"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
     RowBox[{"l2", " ", "m2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "l0", " ", "m0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["q0", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "-", "m2"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
     RowBox[{"l2", " ", "m2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.698428665148799*^9, 3.6989923855650835`*^9, 
  3.698993068842203*^9, 3.699039781169641*^9, 3.6990425762441325`*^9, 
  3.6990839505699663`*^9, 3.6990850814804296`*^9, 3.701862548260443*^9, 
  3.70886104367562*^9, 3.709892073805435*^9, 3.709892659731321*^9, 
  3.709895055329458*^9, 3.7106759380974736`*^9, 3.7142824062072515`*^9, 
  3.7142828658019943`*^9, 3.714287333986226*^9, 3.714288532443118*^9, 
  3.714722661822891*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "l0", " ", "m0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["q0", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "-", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
     RowBox[{"l2", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "+", "m1"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "l0", " ", "m0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["q0", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
     RowBox[{"l2", " ", 
      RowBox[{"(", 
       RowBox[{"m0", "+", "m1"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.698428665148799*^9, 3.6989923855650835`*^9, 
  3.698993068842203*^9, 3.699039781169641*^9, 3.6990425762441325`*^9, 
  3.6990839505699663`*^9, 3.6990850814804296`*^9, 3.701862548260443*^9, 
  3.70886104367562*^9, 3.709892073805435*^9, 3.709892659731321*^9, 
  3.709895055329458*^9, 3.7106759380974736`*^9, 3.7142824062072515`*^9, 
  3.7142828658019943`*^9, 3.714287333986226*^9, 3.714288532443118*^9, 
  3.7147226618283978`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "l0", " ", "m0", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["q0", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "-", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
     RowBox[{"l2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", 
        RowBox[{"2", " ", "m1"}], "+", "m2"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "l0", " ", "m0", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["q0", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
     RowBox[{"l2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", 
        RowBox[{"2", " ", "m1"}], "+", "m2"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"fi0", "+", 
        RowBox[{"q0", "[", "t", "]"}], "+", 
        RowBox[{"q1", "[", "t", "]"}], "+", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.698428665148799*^9, 3.6989923855650835`*^9, 
  3.698993068842203*^9, 3.699039781169641*^9, 3.6990425762441325`*^9, 
  3.6990839505699663`*^9, 3.6990850814804296`*^9, 3.701862548260443*^9, 
  3.70886104367562*^9, 3.709892073805435*^9, 3.709892659731321*^9, 
  3.709895055329458*^9, 3.7106759380974736`*^9, 3.7142824062072515`*^9, 
  3.7142828658019943`*^9, 3.714287333986226*^9, 3.714288532443118*^9, 
  3.7147226618328867`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinetic energy", "Subsection",
 CellChangeTimes->{{3.69843078671669*^9, 3.6984307896020613`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"T0", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "m0", " ", 
     RowBox[{"v0", ".", "v0"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "I0", " ", 
     RowBox[{"omega0", "^", "2"}]}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"T1", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "m1", " ", 
     RowBox[{"v1", ".", "v1"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "I1", " ", 
     RowBox[{"omega1", "^", "2"}]}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"T2", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "m2", " ", 
     RowBox[{"v2", ".", "v2"}]}], "+", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "I2", " ", 
     RowBox[{"omega2", "^", "2"}]}]}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.697136851618552*^9, 3.697136983773234*^9}, {
  3.6971372475617657`*^9, 3.6971372502625513`*^9}, {3.697137388384928*^9, 
  3.6971374475627136`*^9}, {3.697137590126026*^9, 3.6971375903011427`*^9}, {
  3.697137634849477*^9, 3.6971378475112753`*^9}, {3.697138634477439*^9, 
  3.697138658625415*^9}, {3.69714201472366*^9, 3.6971420167189813`*^9}, {
  3.6984286882486515`*^9, 3.698428762475522*^9}, {3.6984288036321526`*^9, 
  3.698428811058424*^9}, {3.698428843514561*^9, 3.6984288550375934`*^9}, {
  3.7098949804448333`*^9, 3.7098950443291683`*^9}, {3.7142873594171753`*^9, 
  3.7142874143892756`*^9}, {3.7142875698444724`*^9, 3.714287605275374*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"I0", " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["q0", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}], "2"]}]], 
     RowBox[{"m0", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "l0", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["q0", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", 
              RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}], "+", 
              RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q0", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q1", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
           RowBox[{"l2", " ", "m2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}], "+", 
              RowBox[{"q1", "[", "t", "]"}], "+", 
              RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q0", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q1", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q2", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}],
          "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "l0", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", "m2"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["q0", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", 
              RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}], "+", 
              RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q0", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q1", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
           RowBox[{"l2", " ", "m2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}], "+", 
              RowBox[{"q1", "[", "t", "]"}], "+", 
              RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q0", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q1", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q2", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}],
          "2"]}], ")"}]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.6971369847738996`*^9, 3.6971371805022297`*^9, 3.6971372510240593`*^9, {
   3.6971374198237247`*^9, 3.6971374485863914`*^9}, {3.6971376362834263`*^9, 
   3.6971377279750905`*^9}, {3.697137801202643*^9, 3.69713780872061*^9}, 
   3.6971378485459576`*^9, 3.6971386646423936`*^9, 3.6971420274360676`*^9, 
   3.6971800379819574`*^9, 3.6972237411002045`*^9, 3.6972239521095333`*^9, 
   3.6972240273065352`*^9, 3.697224340803195*^9, 3.698428768283988*^9, 
   3.6984288176686172`*^9, 3.698428856246887*^9, 3.6989923916931744`*^9, 
   3.698993074686105*^9, 3.699039781804586*^9, 3.699042581932347*^9, 
   3.6990839602544193`*^9, 3.699085087963751*^9, 3.701862556465911*^9, 
   3.708861077057581*^9, 3.709892103532364*^9, 3.709892660541859*^9, 
   3.7098951125559063`*^9, 3.709896013721266*^9, 3.7106759983779893`*^9, 
   3.7142824553183365`*^9, 3.714282868632543*^9, {3.7142873947574897`*^9, 
   3.714287419406248*^9}, 3.714287612218285*^9, 3.714722663747967*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"I1", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}], "2"]}]], 
     RowBox[{"m1", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "l0", " ", "m0", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["q0", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m0", "-", "m2"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}], "+", 
              RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q0", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q1", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
           RowBox[{"l2", " ", "m2", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}], "+", 
              RowBox[{"q1", "[", "t", "]"}], "+", 
              RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q0", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q1", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q2", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}],
          "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "l0", " ", "m0", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["q0", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m0", "-", "m2"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}], "+", 
              RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q0", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q1", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
           RowBox[{"l2", " ", "m2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}], "+", 
              RowBox[{"q1", "[", "t", "]"}], "+", 
              RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q0", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q1", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q2", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}],
          "2"]}], ")"}]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.6971369847738996`*^9, 3.6971371805022297`*^9, 3.6971372510240593`*^9, {
   3.6971374198237247`*^9, 3.6971374485863914`*^9}, {3.6971376362834263`*^9, 
   3.6971377279750905`*^9}, {3.697137801202643*^9, 3.69713780872061*^9}, 
   3.6971378485459576`*^9, 3.6971386646423936`*^9, 3.6971420274360676`*^9, 
   3.6971800379819574`*^9, 3.6972237411002045`*^9, 3.6972239521095333`*^9, 
   3.6972240273065352`*^9, 3.697224340803195*^9, 3.698428768283988*^9, 
   3.6984288176686172`*^9, 3.698428856246887*^9, 3.6989923916931744`*^9, 
   3.698993074686105*^9, 3.699039781804586*^9, 3.699042581932347*^9, 
   3.6990839602544193`*^9, 3.699085087963751*^9, 3.701862556465911*^9, 
   3.708861077057581*^9, 3.709892103532364*^9, 3.709892660541859*^9, 
   3.7098951125559063`*^9, 3.709896013721266*^9, 3.7106759983779893`*^9, 
   3.7142824553183365`*^9, 3.714282868632543*^9, {3.7142873947574897`*^9, 
   3.714287419406248*^9}, 3.714287612218285*^9, 3.714722666429884*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"I2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["q0", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["q2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}], "2"]}], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}], "2"]}]], 
     RowBox[{"m2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "l0", " ", "m0", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["q0", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}], "+", 
              RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q0", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q1", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m0", "+", "m1"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}], "+", 
              RowBox[{"q1", "[", "t", "]"}], "+", 
              RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q0", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q1", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q2", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}],
          "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "l0", " ", "m0", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{
             SuperscriptBox["q0", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], "+", 
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}], "+", 
              RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q0", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q1", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
           RowBox[{"l2", " ", 
            RowBox[{"(", 
             RowBox[{"m0", "+", "m1"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"fi0", "+", 
              RowBox[{"q0", "[", "t", "]"}], "+", 
              RowBox[{"q1", "[", "t", "]"}], "+", 
              RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q0", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q1", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}], "+", 
              RowBox[{
               SuperscriptBox["q2", "\[Prime]",
                MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}],
          "2"]}], ")"}]}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.6971369847738996`*^9, 3.6971371805022297`*^9, 3.6971372510240593`*^9, {
   3.6971374198237247`*^9, 3.6971374485863914`*^9}, {3.6971376362834263`*^9, 
   3.6971377279750905`*^9}, {3.697137801202643*^9, 3.69713780872061*^9}, 
   3.6971378485459576`*^9, 3.6971386646423936`*^9, 3.6971420274360676`*^9, 
   3.6971800379819574`*^9, 3.6972237411002045`*^9, 3.6972239521095333`*^9, 
   3.6972240273065352`*^9, 3.697224340803195*^9, 3.698428768283988*^9, 
   3.6984288176686172`*^9, 3.698428856246887*^9, 3.6989923916931744`*^9, 
   3.698993074686105*^9, 3.699039781804586*^9, 3.699042581932347*^9, 
   3.6990839602544193`*^9, 3.699085087963751*^9, 3.701862556465911*^9, 
   3.708861077057581*^9, 3.709892103532364*^9, 3.709892660541859*^9, 
   3.7098951125559063`*^9, 3.709896013721266*^9, 3.7106759983779893`*^9, 
   3.7142824553183365`*^9, 3.714282868632543*^9, {3.7142873947574897`*^9, 
   3.714287419406248*^9}, 3.714287612218285*^9, 3.7147226692829638`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Total kinetic energy", "Subsection",
 CellChangeTimes->{{3.698430766666456*^9, 3.6984307795105667`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"T", "=", 
  RowBox[{"T0", "+", "T1", "+", "T2"}]}]], "Input",
 CellChangeTimes->{{3.697136377861639*^9, 3.6971364324947796`*^9}, {
   3.6971368452143145`*^9, 3.6971368659480305`*^9}, {3.6971383921137543`*^9, 
   3.697138421350093*^9}, {3.6971386867890453`*^9, 3.6971387180970016`*^9}, 
   3.698428911355877*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"I2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q0", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q1", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q2", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}], "2"]}], "+", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}], "2"]}]], 
      RowBox[{"m2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "l0", " ", "m0", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["q0", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}], "+", 
               RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q0", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q1", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{"l2", " ", 
             RowBox[{"(", 
              RowBox[{"m0", "+", "m1"}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}], "+", 
               RowBox[{"q1", "[", "t", "]"}], "+", 
               RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q0", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q1", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q2", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
           ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "l0", " ", "m0", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["q0", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}], "+", 
               RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q0", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q1", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{"l2", " ", 
             RowBox[{"(", 
              RowBox[{"m0", "+", "m1"}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}], "+", 
               RowBox[{"q1", "[", "t", "]"}], "+", 
               RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q0", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q1", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q2", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
           ")"}], "2"]}], ")"}]}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"I1", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q0", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["q1", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}], "2"]}], "+", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}], "2"]}]], 
      RowBox[{"m1", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "l0", " ", "m0", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["q0", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"(", 
              RowBox[{"m0", "-", "m2"}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}], "+", 
               RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q0", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q1", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
            RowBox[{"l2", " ", "m2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}], "+", 
               RowBox[{"q1", "[", "t", "]"}], "+", 
               RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q0", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q1", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q2", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
           ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "l0", " ", "m0", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["q0", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"(", 
              RowBox[{"m0", "-", "m2"}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}], "+", 
               RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q0", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q1", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
            RowBox[{"l2", " ", "m2", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}], "+", 
               RowBox[{"q1", "[", "t", "]"}], "+", 
               RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q0", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q1", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q2", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
           ")"}], "2"]}], ")"}]}]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"I0", " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["q0", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}], "2"]}]], 
      RowBox[{"m0", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "l0", " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", "m2"}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["q0", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", 
               RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}], "+", 
               RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q0", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q1", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{"l2", " ", "m2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}], "+", 
               RowBox[{"q1", "[", "t", "]"}], "+", 
               RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q0", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q1", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q2", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
           ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "l0", " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", "m2"}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{
              SuperscriptBox["q0", "\[Prime]",
               MultilineFunction->None], "[", "t", "]"}]}], "+", 
            RowBox[{"l1", " ", 
             RowBox[{"(", 
              RowBox[{"m1", "+", 
               RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}], "+", 
               RowBox[{"q1", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q0", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q1", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
            RowBox[{"l2", " ", "m2", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"fi0", "+", 
               RowBox[{"q0", "[", "t", "]"}], "+", 
               RowBox[{"q1", "[", "t", "]"}], "+", 
               RowBox[{"q2", "[", "t", "]"}]}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q0", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q1", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}], "+", 
               RowBox[{
                SuperscriptBox["q2", "\[Prime]",
                 MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
           ")"}], "2"]}], ")"}]}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.6984289123198004`*^9, 3.698992406128326*^9, 
  3.6989930906612916`*^9, 3.6990397876403713`*^9, 3.699042595781864*^9, 
  3.6990839784663534`*^9, 3.699085102140765*^9, 3.7018625771857157`*^9, 
  3.7088612026153665`*^9, 3.7098921913063993`*^9, 3.7098926945571947`*^9, 
  3.709897188777042*^9, 3.7106764097455263`*^9, 3.7142828003277245`*^9, 
  3.714283097105301*^9, 3.714287647037219*^9, 3.714722669341507*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2nd order Lagrange equations", "Subsection",
 CellChangeTimes->{{3.698430745698352*^9, 3.698430759547435*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq1", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"T", ",", " ", 
          RowBox[{
           RowBox[{"q0", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
      "-", 
      RowBox[{"D", "[", 
       RowBox[{"T", ",", " ", 
        RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["q0", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], ",", 
      RowBox[{
       SuperscriptBox["q1", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], ",", 
      RowBox[{
       SuperscriptBox["q2", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q0", "'"}], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q1", "'"}], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q2", "'"}], "[", "t", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.697140476897582*^9, 3.697140490620663*^9}, {
   3.697140524983392*^9, 3.6971405549862404`*^9}, {3.697140715057235*^9, 
   3.6971407210572047`*^9}, {3.697140805242278*^9, 3.6971408154090014`*^9}, {
   3.697140974652294*^9, 3.697141030466217*^9}, 3.6972238003615246`*^9, {
   3.6984289421526947`*^9, 3.6984289665203295`*^9}, 3.7088613770858603`*^9, {
   3.714287736489806*^9, 3.7142877393406916`*^9}, {3.7142878034599257`*^9, 
   3.7142878317746086`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"l0", " ", "m0", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"l1", " ", 
        RowBox[{"(", 
         RowBox[{"m1", "+", 
          RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"l2", " ", "m2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["q1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "2"]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]}], "-", 
  FractionBox[
   RowBox[{"l2", " ", "m2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"l1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", "l0", " ", "m0", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["q1", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["q2", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "l1", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "-", 
      RowBox[{"l1", " ", "l2", " ", "m1", " ", "m2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "-", 
      RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["q2", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], "+", 
  RowBox[{
   RowBox[{
    SuperscriptBox["q0", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"l0", " ", "m0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l1", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", 
             RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"l2", " ", "m2", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"q1", "[", "t", "]"}], "+", 
             RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], 
       RowBox[{"m0", "+", "m1", "+", "m2"}]]}], "-", 
     FractionBox[
      RowBox[{"l2", " ", "m2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"l1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"2", " ", "l0", " ", "m0", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"q1", "[", "t", "]"}], "+", 
            RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["q2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "I0", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I1", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I0", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I1", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["l0", "2"], " ", "m0", " ", "m1"}], "+", 
      RowBox[{
       SuperscriptBox["l1", "2"], " ", "m0", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I0", " ", "m2"}], "+", 
      RowBox[{"4", " ", "I1", " ", "m2"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["l0", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["l1", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l1", "2"], " ", "m1", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
      RowBox[{"4", " ", "l0", " ", "l1", " ", "m0", " ", "m1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"8", " ", "l0", " ", "l1", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"4", " ", "l1", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", "l1", " ", "l2", " ", "m1", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"4", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["q0", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "I1", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I1", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
      RowBox[{
       SuperscriptBox["l1", "2"], " ", "m0", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I1", " ", "m2"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["l1", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l1", "2"], " ", "m1", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
      RowBox[{"2", " ", "l0", " ", "l1", " ", "m0", " ", "m1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"4", " ", "l0", " ", "l1", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"4", " ", "l1", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", "l1", " ", "l2", " ", "m1", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["q1", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
      RowBox[{"2", " ", "l1", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"l1", " ", "l2", " ", "m1", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["q2", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.709897194804398*^9, 3.7142828004818363`*^9, 
  3.714283097170349*^9, 3.714287709706545*^9, 3.714287748589176*^9, 
  3.714287835599779*^9, 3.7147226711044197`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq2", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"T", ",", " ", 
          RowBox[{
           RowBox[{"q1", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
      "-", 
      RowBox[{"D", "[", 
       RowBox[{"T", ",", " ", 
        RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["q0", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], ",", 
      RowBox[{
       SuperscriptBox["q1", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], ",", 
      RowBox[{
       SuperscriptBox["q2", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q0", "'"}], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q1", "'"}], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q2", "'"}], "[", "t", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6971410824996395`*^9, 3.6971410926093326`*^9}, {
   3.697141574687008*^9, 3.6971415802016582`*^9}, {3.6971421059690237`*^9, 
   3.697142194894163*^9}, {3.6971423510704803`*^9, 3.697142385318035*^9}, {
   3.69714254412173*^9, 3.697142546172125*^9}, {3.697223760135835*^9, 
   3.697223770474697*^9}, {3.698429033104514*^9, 3.698429042866946*^9}, 
   3.7088614064375343`*^9, {3.71428775747344*^9, 3.7142877620987883`*^9}, {
   3.714287885458619*^9, 3.714287895412835*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"l0", " ", "m0", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"l1", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", 
         RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"l2", " ", "m2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["q0", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"l1", " ", "l2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"q2", "[", "t", "]"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["q0", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["q2", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{"l1", " ", "l2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"q2", "[", "t", "]"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["q1", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["q2", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "l1", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "-", 
      RowBox[{"l1", " ", "l2", " ", "m1", " ", "m2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["q2", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "I1", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I1", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
      RowBox[{
       SuperscriptBox["l1", "2"], " ", "m0", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I1", " ", "m2"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["l1", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l1", "2"], " ", "m1", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
      RowBox[{"2", " ", "l0", " ", "l1", " ", "m0", " ", "m1", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"4", " ", "l0", " ", "l1", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"4", " ", "l1", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", "l1", " ", "l2", " ", "m1", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["q0", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "I1", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I1", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
      RowBox[{
       SuperscriptBox["l1", "2"], " ", "m0", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I1", " ", "m2"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["l1", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l1", "2"], " ", "m1", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
      RowBox[{"4", " ", "l1", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", "l1", " ", "l2", " ", "m1", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["q1", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
      RowBox[{"2", " ", "l1", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"l1", " ", "l2", " ", "m1", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["q2", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.7098971999666786`*^9, 3.7142828005478835`*^9, 
  3.7142830972353926`*^9, 3.7142877657452292`*^9, 3.7142878979564977`*^9, 
  3.714722671986973*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq3", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"T", ",", " ", 
          RowBox[{
           RowBox[{"q2", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
      "-", 
      RowBox[{"D", "[", 
       RowBox[{"T", ",", " ", 
        RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["q0", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], ",", 
      RowBox[{
       SuperscriptBox["q1", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], ",", 
      RowBox[{
       SuperscriptBox["q2", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q0", "'"}], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q1", "'"}], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q2", "'"}], "[", "t", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6971425620164156`*^9, 3.6971425757513967`*^9}, {
   3.698429067755388*^9, 3.698429074701991*^9}, 3.708861416834231*^9, {
   3.714287906766923*^9, 3.7142879162374372`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"l2", " ", "m2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"l1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", "l0", " ", "m0", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["q0", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"l1", " ", "l2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"q2", "[", "t", "]"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["q0", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], " ", 
    RowBox[{
     SuperscriptBox["q1", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"l1", " ", "l2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"q2", "[", "t", "]"}], "]"}], " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["q1", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}], "2"]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
      RowBox[{"2", " ", "l1", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"l1", " ", "l2", " ", "m1", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"q1", "[", "t", "]"}], "+", 
         RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["q0", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
      RowBox[{"2", " ", "l1", " ", "l2", " ", "m0", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"l1", " ", "l2", " ", "m1", " ", "m2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"q2", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["q1", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
      RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
      RowBox[{
       SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}]}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["q2", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "t", "]"}]}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.7098972037045717`*^9, 3.7142828006595106`*^9, 
  3.714283097343487*^9, 3.714287918930713*^9, 3.714722672507414*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elements of Mass Matrix", "Subsection",
 CellChangeTimes->{{3.6984298896104555`*^9, 3.69842989794198*^9}, 
   3.698429947206812*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m11", "=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{
        RowBox[{"q0", "''"}], "[", "t", "]"}]}], "]"}], ",", "2"}], "]"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.698429111721833*^9, 3.6984291133407764`*^9}, {
  3.6984294857692585`*^9, 3.698429539824229*^9}, {3.6984297131045017`*^9, 
  3.6984297256681356`*^9}, {3.6984298654345484`*^9, 3.698429873952174*^9}, {
  3.6984301255733805`*^9, 3.6984301269983683`*^9}, {3.714287966580713*^9, 
  3.7142879674179363`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", "I0", " ", "m0"}], "+", 
    RowBox[{"4", " ", "I1", " ", "m0"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
    RowBox[{"4", " ", "I0", " ", "m1"}], "+", 
    RowBox[{"4", " ", "I1", " ", "m1"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["l0", "2"], " ", "m0", " ", "m1"}], "+", 
    RowBox[{
     SuperscriptBox["l1", "2"], " ", "m0", " ", "m1"}], "+", 
    RowBox[{"4", " ", "I0", " ", "m2"}], "+", 
    RowBox[{"4", " ", "I1", " ", "m2"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["l0", "2"], " ", "m0", " ", "m2"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["l1", "2"], " ", "m0", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l1", "2"], " ", "m1", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
    RowBox[{"4", " ", "l0", " ", "l1", " ", "m0", " ", 
     RowBox[{"(", 
      RowBox[{"m1", "+", 
       RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{"2", " ", "l1", " ", "l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{"4", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6984300707217336`*^9, 3.698430129500738*^9, 
  3.6984302596443453`*^9, 3.698992417729071*^9, 3.6989931017522125`*^9, 
  3.6990397949179487`*^9, 3.6990426060381365`*^9, 3.699083996083654*^9, 
  3.699085112690523*^9, 3.701862593962895*^9, 3.7088614319620876`*^9, 
  3.70989219659403*^9, 3.7098926981520767`*^9, 3.7098972194707355`*^9, 
  3.714282806203581*^9, 3.7142831027975864`*^9, 3.7142879682932787`*^9, 
  3.7147226726865416`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m12", "=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{
        RowBox[{"q1", "''"}], "[", "t", "]"}]}], "]"}], ",", "2"}], "]"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.698429989850542*^9, 3.6984299899455833`*^9}, {
  3.698430132689392*^9, 3.6984301342103567`*^9}, {3.698430210940984*^9, 
  3.6984302235756707`*^9}, {3.7142879764866314`*^9, 3.7142879772087526`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", "I1", " ", "m0"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
    RowBox[{"4", " ", "I1", " ", "m1"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
    RowBox[{
     SuperscriptBox["l1", "2"], " ", "m0", " ", "m1"}], "+", 
    RowBox[{"4", " ", "I1", " ", "m2"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["l1", "2"], " ", "m0", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l1", "2"], " ", "m1", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
    RowBox[{"2", " ", "l0", " ", "l1", " ", "m0", " ", 
     RowBox[{"(", 
      RowBox[{"m1", "+", 
       RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{"2", " ", "l1", " ", "l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.698430072103788*^9, 3.6984301361934443`*^9, 
  3.6984302611013737`*^9, 3.6989924180442796`*^9, 3.6989931020644193`*^9, 
  3.69903979523217*^9, 3.69904260631583*^9, 3.69908399639086*^9, 
  3.6990851129647055`*^9, 3.7018625944632273`*^9, 3.708861441989359*^9, 
  3.709892202375727*^9, 3.7098927024219065`*^9, 3.7098972471372194`*^9, 
  3.71428281252607*^9, 3.714283108325874*^9, 3.7142879786245384`*^9, 
  3.714722672800621*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m13", "=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"eq1", ",", 
       RowBox[{
        RowBox[{"q2", "''"}], "[", "t", "]"}]}], "]"}], ",", "2"}], "]"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6984300125342417`*^9, 3.6984300132414713`*^9}, {
  3.698430138874095*^9, 3.698430140027175*^9}, {3.698430215530653*^9, 
  3.69843021784346*^9}, {3.71428798167831*^9, 3.7142879823062177`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
   RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
   RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
   RowBox[{
    SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
   RowBox[{
    SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
   RowBox[{"l1", " ", "l2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
   RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"q1", "[", "t", "]"}], "+", 
      RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.6984300732100306`*^9, 3.698430141126342*^9, 
  3.6984302648059998`*^9, 3.6989924182974486`*^9, 3.6989931022935734`*^9, 
  3.6990397953042245`*^9, 3.6990426065364895`*^9, 3.6990839966560354`*^9, 
  3.699085113188855*^9, 3.7018625947914467`*^9, 3.7088614449724345`*^9, 
  3.709892203585573*^9, 3.7098927038913827`*^9, 3.709897274914661*^9, 
  3.7142828149758086`*^9, 3.7142831103665686`*^9, 3.714287982986916*^9, 
  3.714722672871215*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m21", "=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"eq2", ",", 
       RowBox[{
        RowBox[{"q0", "''"}], "[", "t", "]"}]}], "]"}], ",", "2"}], "]"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.698429111721833*^9, 3.6984291133407764`*^9}, {
  3.6984294857692585`*^9, 3.698429539824229*^9}, {3.6984297131045017`*^9, 
  3.6984297256681356`*^9}, {3.6984298654345484`*^9, 3.698429873952174*^9}, {
  3.698430052881228*^9, 3.6984300540759754`*^9}, {3.698430143769902*^9, 
  3.698430146815391*^9}, {3.698430229931389*^9, 3.6984302331554766`*^9}, {
  3.7142879869893155`*^9, 3.7142879876473484`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", "I1", " ", "m0"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
    RowBox[{"4", " ", "I1", " ", "m1"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
    RowBox[{
     SuperscriptBox["l1", "2"], " ", "m0", " ", "m1"}], "+", 
    RowBox[{"4", " ", "I1", " ", "m2"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["l1", "2"], " ", "m0", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l1", "2"], " ", "m1", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
    RowBox[{"2", " ", "l0", " ", "l1", " ", "m0", " ", 
     RowBox[{"(", 
      RowBox[{"m1", "+", 
       RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{"2", " ", "l1", " ", "l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6984300789352646`*^9, 3.69843014755467*^9, 
  3.69843027741413*^9, 3.698992418316461*^9, 3.698993102318596*^9, 
  3.6990397953722744`*^9, 3.6990426065449967`*^9, 3.6990839966660433`*^9, 
  3.699085113198861*^9, 3.7018625948644953`*^9, 3.708861450189891*^9, 
  3.709892205727197*^9, 3.709892705038311*^9, 3.70989730706697*^9, 
  3.714282820705937*^9, 3.714283115657338*^9, 3.714287988253406*^9, 
  3.71472267288023*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m22", "=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"eq2", ",", 
       RowBox[{
        RowBox[{"q1", "''"}], "[", "t", "]"}]}], "]"}], ",", "2"}], "]"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.698429989850542*^9, 3.6984299899455833`*^9}, {
  3.6984300578955393`*^9, 3.698430059385915*^9}, {3.698430150493467*^9, 
  3.6984301515475097`*^9}, {3.6984302352312107`*^9, 3.6984302365143747`*^9}, {
  3.714287991647028*^9, 3.714287992145108*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
   RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
   RowBox[{
    SuperscriptBox["l1", "2"], " ", "m0", " ", "m1"}], "+", 
   RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
   RowBox[{"4", " ", 
    SuperscriptBox["l1", "2"], " ", "m0", " ", "m2"}], "+", 
   RowBox[{
    SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
   RowBox[{
    SuperscriptBox["l1", "2"], " ", "m1", " ", "m2"}], "+", 
   RowBox[{
    SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
   RowBox[{"4", " ", "I1", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}], "+", 
   RowBox[{"2", " ", "l1", " ", "l2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"q2", "[", "t", "]"}], "]"}]}]}], 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.6984300825563326`*^9, 3.698430152261149*^9, 
  3.698430282719278*^9, 3.6989924186556883`*^9, 3.6989931026778293`*^9, 
  3.699039795723522*^9, 3.699042606866226*^9, 3.6990839970162773`*^9, 
  3.6990851135190773`*^9, 3.701862595499918*^9, 3.7088614599482136`*^9, 
  3.709892206628847*^9, 3.709892706315383*^9, 3.709897311929192*^9, 
  3.7142828229444103`*^9, 3.7142831178950214`*^9, 3.7142879928828335`*^9, 
  3.7147226729392633`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m23", "=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"eq2", ",", 
       RowBox[{
        RowBox[{"q2", "''"}], "[", "t", "]"}]}], "]"}], ",", "2"}], "]"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6984300125342417`*^9, 3.6984300132414713`*^9}, {
  3.698430060413967*^9, 3.6984300610180426`*^9}, {3.698430157355527*^9, 
  3.6984301580820513`*^9}, {3.6984302393306847`*^9, 3.6984302408571343`*^9}, {
  3.714287996484978*^9, 3.714287997113106*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["l2", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1"}], ")"}], " ", "m2"}], "+", 
   RowBox[{"4", " ", "I2", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}], "+", 
   RowBox[{"l1", " ", "l2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"q2", "[", "t", "]"}], "]"}]}]}], 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.6984300869440455`*^9, 3.698430159138588*^9, 
  3.698430285093936*^9, 3.6989924189068556`*^9, 3.6989931029380026`*^9, 
  3.699039795817132*^9, 3.6990426070914245`*^9, 3.699083997249939*^9, 
  3.699085113784252*^9, 3.7018625959412127`*^9, 3.708861462984866*^9, 
  3.7098922073163023`*^9, 3.709892707041972*^9, 3.7098973152744093`*^9, 
  3.7142828257041454`*^9, 3.7142831204958696`*^9, 3.7142879977326794`*^9, 
  3.71472267297479*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m31", "=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"eq3", ",", 
       RowBox[{
        RowBox[{"q0", "''"}], "[", "t", "]"}]}], "]"}], ",", "2"}], "]"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.698429111721833*^9, 3.6984291133407764`*^9}, {
  3.6984294857692585`*^9, 3.698429539824229*^9}, {3.6984297131045017`*^9, 
  3.6984297256681356`*^9}, {3.6984298654345484`*^9, 3.698429873952174*^9}, {
  3.6984300620364*^9, 3.698430062649788*^9}, {3.698430171184702*^9, 
  3.6984301730239096`*^9}, {3.6984302476107407`*^9, 3.6984302488259826`*^9}, {
  3.7142880025259867`*^9, 3.714288003073162*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
   RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
   RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
   RowBox[{
    SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
   RowBox[{
    SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
   RowBox[{"l1", " ", "l2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
   RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"q1", "[", "t", "]"}], "+", 
      RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.698430100692977*^9, 3.6984301742483177`*^9, 
  3.69843028763516*^9, 3.6989924189528875`*^9, 3.698993102988036*^9, 
  3.6990397958616667`*^9, 3.6990426072685533`*^9, 3.699083997446581*^9, 
  3.6990851139873877`*^9, 3.701862596293447*^9, 3.708861471284336*^9, 
  3.7098922081118298`*^9, 3.709892707530481*^9, 3.7098973186126223`*^9, 
  3.7142828275769806`*^9, 3.7142831223141594`*^9, 3.7142880037155037`*^9, 
  3.7147226729817934`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m32", "=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"eq3", ",", 
       RowBox[{
        RowBox[{"q1", "''"}], "[", "t", "]"}]}], "]"}], ",", "2"}], "]"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.698429989850542*^9, 3.6984299899455833`*^9}, {
  3.6984300636913958`*^9, 3.6984300648020887`*^9}, {3.698430176942359*^9, 
  3.6984301777530127`*^9}, {3.6984302517581425`*^9, 3.698430253974242*^9}, {
  3.7142880068507824`*^9, 3.714288007565568*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["l2", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1"}], ")"}], " ", "m2"}], "+", 
   RowBox[{"4", " ", "I2", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}], "+", 
   RowBox[{"l1", " ", "l2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"q2", "[", "t", "]"}], "]"}]}]}], 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.6984301031176734`*^9, 3.698430178565543*^9, 
  3.698430289561638*^9, 3.6989924189759026`*^9, 3.698993103013055*^9, 
  3.6990397958866835`*^9, 3.6990426072915683`*^9, 3.699083997481604*^9, 
  3.6990851140234127`*^9, 3.7018625963414793`*^9, 3.7088614734406586`*^9, 
  3.7098922085231037`*^9, 3.7098927081389246`*^9, 3.7098973212163477`*^9, 
  3.7142828294625783`*^9, 3.7142831241870084`*^9, 3.714288011387283*^9, 
  3.7147226729897985`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m33", "=", 
  RowBox[{
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"eq3", ",", 
       RowBox[{
        RowBox[{"q2", "''"}], "[", "t", "]"}]}], "]"}], ",", "2"}], "]"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6984300125342417`*^9, 3.6984300132414713`*^9}, {
  3.6984300662914886`*^9, 3.69843006711356*^9}, {3.6984301826649685`*^9, 
  3.698430184230986*^9}, {3.714288016931308*^9, 3.714288017430457*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["l2", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1"}], ")"}], " ", "m2"}], "+", 
   RowBox[{"4", " ", "I2", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]}], 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.698430108092101*^9, 3.6984301849353867`*^9, 
  3.6984302933450603`*^9, 3.698992419085975*^9, 3.698993103127129*^9, 
  3.6990397960176682`*^9, 3.69904260739264*^9, 3.699083997618694*^9, 
  3.6990851141304865`*^9, 3.7018625965185966`*^9, 3.7088614750627184`*^9, 
  3.7098922085961504`*^9, 3.7098927081829576`*^9, 3.709897356939022*^9, 
  3.7142828318212843`*^9, 3.714283126341117*^9, 3.7142880183324056`*^9, 
  3.714722673016816*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elements of C Matrix", "Subsection",
 CellChangeTimes->{{3.698430332641156*^9, 3.698430343296714*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"c1", "=", 
  RowBox[{
   RowBox[{"eq1", "-", 
    RowBox[{"m11", "*", 
     RowBox[{
      RowBox[{"q0", "''"}], "[", "t", "]"}]}], "-", 
    RowBox[{"m12", "*", 
     RowBox[{
      RowBox[{"q1", "''"}], "[", "t", "]"}]}], "-", 
    RowBox[{"m13", "*", 
     RowBox[{
      RowBox[{"q2", "''"}], "[", "t", "]"}]}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.698992120342472*^9, 3.698992122408848*^9}, {
   3.6989922151087027`*^9, 3.6989922779259305`*^9}, 3.6989923643975115`*^9, {
   3.698993026734345*^9, 3.69899302807224*^9}, {3.7142880289080496`*^9, 
   3.714288029631003*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "l0", " ", "m0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{"m1", "+", 
           RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"l2", " ", "m2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q1", "[", "t", "]"}], "+", 
           RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["q1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{"2", " ", "l2", " ", "m2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", "l0", " ", "m0", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q1", "[", "t", "]"}], "+", 
           RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["q1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["q2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"l2", " ", "m2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", "l0", " ", "m0", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q1", "[", "t", "]"}], "+", 
           RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["q2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{"2", " ", 
      RowBox[{
       SuperscriptBox["q0", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "l0", " ", "m0", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{"m1", "+", 
              RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"l2", " ", "m2", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q1", "[", "t", "]"}], "+", 
              RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["q1", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"l2", " ", "m2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "l0", " ", "m0", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"q1", "[", "t", "]"}], "+", 
              RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["q2", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.6989928033772173`*^9, {3.69899303137444*^9, 3.698993055005971*^9}, 
   3.6989931042218604`*^9, 3.699039796980358*^9, 3.699042608348197*^9, 
   3.699083998734439*^9, 3.699085115113139*^9, 3.7018625981516857`*^9, 
   3.708861564729598*^9, 3.709892257656005*^9, 3.7098927271003985`*^9, 
   3.7098980119646935`*^9, 3.714282851581913*^9, 3.7142831530632286`*^9, 
   3.714288031842717*^9, 3.7147226735447016`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"c2", "=", 
  RowBox[{
   RowBox[{"eq2", "-", 
    RowBox[{"m21", "*", 
     RowBox[{
      RowBox[{"q0", "''"}], "[", "t", "]"}]}], "-", 
    RowBox[{"m22", "*", 
     RowBox[{
      RowBox[{"q1", "''"}], "[", "t", "]"}]}], "-", 
    RowBox[{"m23", "*", 
     RowBox[{
      RowBox[{"q2", "''"}], "[", "t", "]"}]}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.698993132300815*^9, 3.698993152501542*^9}, {
  3.7142880364430714`*^9, 3.7142880369357967`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "l0", " ", "m0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{"m1", "+", 
           RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"l2", " ", "m2", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q1", "[", "t", "]"}], "+", 
           RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["q0", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{"2", " ", "l1", " ", "l2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"q2", "[", "t", "]"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["q0", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["q2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"l1", " ", "l2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"q2", "[", "t", "]"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["q2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{
          SuperscriptBox["q1", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["q2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.698993146074249*^9, 3.698993153435161*^9}, 
   3.6990397975077314`*^9, 3.6990426089586334`*^9, 3.699083999269796*^9, 
   3.6990851156124725`*^9, 3.701862598863158*^9, 3.7088616086930676`*^9, 
   3.7098922777425776`*^9, 3.7098927443518324`*^9, 3.70989835662916*^9, 
   3.7142831811110835`*^9, 3.714288038262187*^9, 3.714722673819237*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"c3", "=", 
  RowBox[{
   RowBox[{"eq3", "-", 
    RowBox[{"m31", "*", 
     RowBox[{
      RowBox[{"q0", "''"}], "[", "t", "]"}]}], "-", 
    RowBox[{"m32", "*", 
     RowBox[{
      RowBox[{"q1", "''"}], "[", "t", "]"}]}], "-", 
    RowBox[{"m33", "*", 
     RowBox[{
      RowBox[{"q2", "''"}], "[", "t", "]"}]}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6989931655686874`*^9, 3.698993175863556*^9}, {
  3.714288047581545*^9, 3.714288048112632*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"l2", " ", "m2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"2", " ", "l0", " ", "m0", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"q1", "[", "t", "]"}], "+", 
           RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["q0", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{"2", " ", "l1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"q2", "[", "t", "]"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["q0", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["q1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"q2", "[", "t", "]"}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["q1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}]}], 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.698993177108635*^9, 3.69903979778693*^9, 
  3.699042609445486*^9, 3.6990839997401094`*^9, 3.699085116055768*^9, 
  3.7018625994695635`*^9, 3.7088616222983475`*^9, 3.7098922803392973`*^9, 
  3.7098927467734365`*^9, 3.709898427328768*^9, 3.7142831947967033`*^9, 
  3.7142880490684814`*^9, 3.714722673972189*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Angular Momentum", "Section",
 CellChangeTimes->{{3.7098925624069653`*^9, 3.7098925985467744`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"K0", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Last", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{"rho0", ",", " ", 
       RowBox[{"m0", " ", "v0"}]}], "]"}], "]"}], "+", 
    RowBox[{"I0", " ", "omega0"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"K1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Last", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{"rho1", ",", " ", 
       RowBox[{"m1", " ", "v1"}]}], "]"}], "]"}], "+", 
    RowBox[{"I1", " ", "omega1"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"K2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Last", "[", 
     RowBox[{"Cross", "[", 
      RowBox[{"rho2", ",", " ", 
       RowBox[{"m2", " ", "v2"}]}], "]"}], "]"}], "+", 
    RowBox[{"I2", " ", "omega2"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"K", " ", "=", " ", 
  RowBox[{
   RowBox[{"K0", "+", "K1", "+", "K2"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.709907459501396*^9, 3.7099075150423455`*^9}, {
  3.709909674372163*^9, 3.709909692605488*^9}, {3.7142882716856375`*^9, 
  3.714288282649496*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}], "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "I0", " ", 
        SuperscriptBox["m0", "2"]}], "+", 
       RowBox[{"8", " ", "I0", " ", "m0", " ", "m1"}], "+", 
       RowBox[{"4", " ", "I0", " ", 
        SuperscriptBox["m1", "2"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l0", "2"], " ", "m0", " ", 
        SuperscriptBox["m1", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", "m0", " ", 
        SuperscriptBox["m1", "2"]}], "+", 
       RowBox[{"8", " ", "I0", " ", "m0", " ", "m2"}], "+", 
       RowBox[{"8", " ", "I0", " ", "m1", " ", "m2"}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["l0", "2"], " ", "m0", " ", "m1", " ", "m2"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l1", "2"], " ", "m0", " ", "m1", " ", "m2"}], "+", 
       RowBox[{"4", " ", "I0", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l0", "2"], " ", "m0", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l1", "2"], " ", "m0", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", "m0", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{"4", " ", "l0", " ", "l1", " ", "m0", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["m1", "2"], "+", 
          RowBox[{"3", " ", "m1", " ", "m2"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["m2", "2"]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", "l1", " ", "l2", " ", "m0", " ", "m2", " ", 
        RowBox[{"(", 
         RowBox[{"m1", "+", 
          RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
       "4", " ", "l0", " ", "l2", " ", "m0", " ", "m1", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"4", " ", "l0", " ", "l2", " ", "m0", " ", 
        SuperscriptBox["m2", "2"], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["q0", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{"m0", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["l1", "2"], " ", 
           SuperscriptBox["m1", "2"]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["l1", "2"], " ", "m1", " ", "m2"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["l1", "2"], " ", 
           SuperscriptBox["m2", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["l2", "2"], " ", 
           SuperscriptBox["m2", "2"]}], "+", 
          RowBox[{"2", " ", "l0", " ", "l1", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["m1", "2"], "+", 
             RowBox[{"3", " ", "m1", " ", "m2"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["m2", "2"]}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"2", " ", "l1", " ", "l2", " ", "m2", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", 
             RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"2", " ", "l0", " ", "l2", " ", "m1", " ", "m2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"q1", "[", "t", "]"}], "+", 
             RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
          RowBox[{"2", " ", "l0", " ", "l2", " ", 
           SuperscriptBox["m2", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"q1", "[", "t", "]"}], "+", 
             RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["q1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], "+", 
       RowBox[{"l2", " ", "m2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l2", " ", "m2"}], "+", 
          RowBox[{"l1", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", 
             RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"2", " ", "l0", " ", 
           RowBox[{"(", 
            RowBox[{"m1", "+", "m2"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"q1", "[", "t", "]"}], "+", 
             RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["q2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.70989262284988*^9, 3.7098927811838207`*^9, 
  3.7098984880511665`*^9, 3.7099075561352835`*^9, 3.7142832384134526`*^9, 
  3.71428829287708*^9, 3.714722675405242*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}], "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "I1", " ", 
        SuperscriptBox["m0", "2"]}], "+", 
       RowBox[{"8", " ", "I1", " ", "m0", " ", "m1"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l0", "2"], " ", 
        SuperscriptBox["m0", "2"], " ", "m1"}], "+", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", 
        SuperscriptBox["m0", "2"], " ", "m1"}], "+", 
       RowBox[{"4", " ", "I1", " ", 
        SuperscriptBox["m1", "2"]}], "+", 
       RowBox[{"8", " ", "I1", " ", "m0", " ", "m2"}], "+", 
       RowBox[{"8", " ", "I1", " ", "m1", " ", "m2"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["l1", "2"], " ", "m0", " ", "m1", " ", "m2"}], "+", 
       RowBox[{"4", " ", "I1", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", "m1", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", "m1", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{"4", " ", "l0", " ", "l1", " ", "m0", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"m0", "-", "m2"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"2", " ", "l1", " ", "l2", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"m0", "-", "m2"}], ")"}], " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{
       "4", " ", "l0", " ", "l2", " ", "m0", " ", "m1", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["q0", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "I1", " ", 
        SuperscriptBox["m0", "2"]}], "+", 
       RowBox[{"8", " ", "I1", " ", "m0", " ", "m1"}], "+", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", 
        SuperscriptBox["m0", "2"], " ", "m1"}], "+", 
       RowBox[{"4", " ", "I1", " ", 
        SuperscriptBox["m1", "2"]}], "+", 
       RowBox[{"8", " ", "I1", " ", "m0", " ", "m2"}], "+", 
       RowBox[{"8", " ", "I1", " ", "m1", " ", "m2"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["l1", "2"], " ", "m0", " ", "m1", " ", "m2"}], "+", 
       RowBox[{"4", " ", "I1", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", "m1", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", "m1", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{"2", " ", "l0", " ", "l1", " ", "m0", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"m0", "-", "m2"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"2", " ", "l1", " ", "l2", " ", "m1", " ", 
        RowBox[{"(", 
         RowBox[{"m0", "-", "m2"}], ")"}], " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{
       "2", " ", "l0", " ", "l2", " ", "m0", " ", "m1", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["q1", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{"l2", " ", "m1", " ", "m2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"l2", " ", "m2"}], "-", 
       RowBox[{"l1", " ", 
        RowBox[{"(", 
         RowBox[{"m0", "-", "m2"}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}], "-", 
       RowBox[{"2", " ", "l0", " ", "m0", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["q2", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.70989262284988*^9, 3.7098927811838207`*^9, 
  3.7098984880511665`*^9, 3.7099075561352835`*^9, 3.7142832384134526`*^9, 
  3.71428829287708*^9, 3.714722676536049*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}], "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "I2", " ", 
        SuperscriptBox["m0", "2"]}], "+", 
       RowBox[{"8", " ", "I2", " ", "m0", " ", "m1"}], "+", 
       RowBox[{"4", " ", "I2", " ", 
        SuperscriptBox["m1", "2"]}], "+", 
       RowBox[{"8", " ", "I2", " ", "m0", " ", "m2"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l0", "2"], " ", 
        SuperscriptBox["m0", "2"], " ", "m2"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l1", "2"], " ", 
        SuperscriptBox["m0", "2"], " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", 
        SuperscriptBox["m0", "2"], " ", "m2"}], "+", 
       RowBox[{"8", " ", "I2", " ", "m1", " ", "m2"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l1", "2"], " ", "m0", " ", "m1", " ", "m2"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["l2", "2"], " ", "m0", " ", "m1", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", 
        SuperscriptBox["m1", "2"], " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", 
        SuperscriptBox["m1", "2"], " ", "m2"}], "+", 
       RowBox[{"4", " ", "I2", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{"4", " ", "l0", " ", "l1", " ", "m0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", "l1", " ", "l2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["m0", "2"]}], "+", 
          RowBox[{"3", " ", "m0", " ", "m1"}], "+", 
          SuperscriptBox["m1", "2"]}], ")"}], " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"4", " ", "l0", " ", "l2", " ", 
        SuperscriptBox["m0", "2"], " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{
       "4", " ", "l0", " ", "l2", " ", "m0", " ", "m1", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["q0", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "I2", " ", 
        SuperscriptBox["m0", "2"]}], "+", 
       RowBox[{"8", " ", "I2", " ", "m0", " ", "m1"}], "+", 
       RowBox[{"4", " ", "I2", " ", 
        SuperscriptBox["m1", "2"]}], "+", 
       RowBox[{"8", " ", "I2", " ", "m0", " ", "m2"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l1", "2"], " ", 
        SuperscriptBox["m0", "2"], " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", 
        SuperscriptBox["m0", "2"], " ", "m2"}], "+", 
       RowBox[{"8", " ", "I2", " ", "m1", " ", "m2"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l1", "2"], " ", "m0", " ", "m1", " ", "m2"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["l2", "2"], " ", "m0", " ", "m1", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", 
        SuperscriptBox["m1", "2"], " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", 
        SuperscriptBox["m1", "2"], " ", "m2"}], "+", 
       RowBox[{"4", " ", "I2", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{"2", " ", "l0", " ", "l1", " ", "m0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", "l1", " ", "l2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["m0", "2"]}], "+", 
          RowBox[{"3", " ", "m0", " ", "m1"}], "+", 
          SuperscriptBox["m1", "2"]}], ")"}], " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", "l0", " ", "l2", " ", 
        SuperscriptBox["m0", "2"], " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{
       "2", " ", "l0", " ", "l2", " ", "m0", " ", "m1", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["q1", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "I2", " ", 
        SuperscriptBox["m0", "2"]}], "+", 
       RowBox[{"8", " ", "I2", " ", "m0", " ", "m1"}], "+", 
       RowBox[{"4", " ", "I2", " ", 
        SuperscriptBox["m1", "2"]}], "+", 
       RowBox[{"8", " ", "I2", " ", "m0", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", 
        SuperscriptBox["m0", "2"], " ", "m2"}], "+", 
       RowBox[{"8", " ", "I2", " ", "m1", " ", "m2"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["l2", "2"], " ", "m0", " ", "m1", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", 
        SuperscriptBox["m1", "2"], " ", "m2"}], "+", 
       RowBox[{"4", " ", "I2", " ", 
        SuperscriptBox["m2", "2"]}], "+", 
       RowBox[{"l1", " ", "l2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["m0", "2"]}], "+", 
          RowBox[{"3", " ", "m0", " ", "m1"}], "+", 
          SuperscriptBox["m1", "2"]}], ")"}], " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", 
        RowBox[{"(", 
         RowBox[{"m0", "+", "m1"}], ")"}], " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["q2", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.70989262284988*^9, 3.7098927811838207`*^9, 
  3.7098984880511665`*^9, 3.7099075561352835`*^9, 3.7142832384134526`*^9, 
  3.71428829287708*^9, 3.7147226781853876`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "I0", " ", "m0"}], "+", 
       RowBox[{"4", " ", "I1", " ", "m0"}], "+", 
       RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
       RowBox[{"4", " ", "I0", " ", "m1"}], "+", 
       RowBox[{"4", " ", "I1", " ", "m1"}], "+", 
       RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l0", "2"], " ", "m0", " ", "m1"}], "+", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", "m0", " ", "m1"}], "+", 
       RowBox[{"4", " ", "I0", " ", "m2"}], "+", 
       RowBox[{"4", " ", "I1", " ", "m2"}], "+", 
       RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l0", "2"], " ", "m0", " ", "m2"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l1", "2"], " ", "m0", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", "m1", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
       RowBox[{"4", " ", "l0", " ", "l1", " ", "m0", " ", 
        RowBox[{"(", 
         RowBox[{"m1", "+", 
          RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", "l1", " ", "l2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"4", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["q0", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "I1", " ", "m0"}], "+", 
       RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
       RowBox[{"4", " ", "I1", " ", "m1"}], "+", 
       RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", "m0", " ", "m1"}], "+", 
       RowBox[{"4", " ", "I1", " ", "m2"}], "+", 
       RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["l1", "2"], " ", "m0", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", "m1", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
       RowBox[{"2", " ", "l0", " ", "l1", " ", "m0", " ", 
        RowBox[{"(", 
         RowBox[{"m1", "+", 
          RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", "l1", " ", "l2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["q1", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
       RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
       RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
       RowBox[{
        SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
       RowBox[{"l1", " ", "l2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["q2", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.70989262284988*^9, 3.7098927811838207`*^9, 
  3.7098984880511665`*^9, 3.7099075561352835`*^9, 3.7142832384134526`*^9, 
  3.71428829287708*^9, 3.714722679161174*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"K", "/.", 
    RowBox[{"m0", "\[Rule]", "kg"}]}], "/.", 
   RowBox[{"m1", "\[Rule]", "kg"}]}], "/.", 
  RowBox[{"m2", "\[Rule]", "kg"}]}]], "Input",
 CellChangeTimes->{{3.714288363332657*^9, 3.714288406412735*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"12", " ", "kg"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"12", " ", "I0", " ", "kg"}], "+", 
       RowBox[{"12", " ", "I1", " ", "kg"}], "+", 
       RowBox[{"12", " ", "I2", " ", "kg"}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["kg", "2"], " ", 
        SuperscriptBox["l0", "2"]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["kg", "2"], " ", 
        SuperscriptBox["l1", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["kg", "2"], " ", 
        SuperscriptBox["l2", "2"]}], "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["kg", "2"], " ", "l0", " ", "l1", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["kg", "2"], " ", "l1", " ", "l2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["kg", "2"], " ", "l0", " ", "l2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["q0", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"12", " ", "I1", " ", "kg"}], "+", 
       RowBox[{"12", " ", "I2", " ", "kg"}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["kg", "2"], " ", 
        SuperscriptBox["l1", "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["kg", "2"], " ", 
        SuperscriptBox["l2", "2"]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["kg", "2"], " ", "l0", " ", "l1", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"6", " ", 
        SuperscriptBox["kg", "2"], " ", "l1", " ", "l2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["kg", "2"], " ", "l0", " ", "l2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["q1", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"12", " ", "I2", " ", "kg"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["kg", "2"], " ", 
        SuperscriptBox["l2", "2"]}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["kg", "2"], " ", "l1", " ", "l2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["kg", "2"], " ", "l0", " ", "l2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q1", "[", "t", "]"}], "+", 
          RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["q2", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.7142883647075205`*^9, {3.7142883979925656`*^9, 3.714288407679191*^9}, 
   3.7147226791901927`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["End effector desired position", "Section",
 CellChangeTimes->{{3.709900481352768*^9, 3.709900489050125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"c11", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"vd", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"q0", "'"}], "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"c12", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"vd", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"q1", "'"}], "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"c13", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"vd", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"q2", "'"}], "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"c21", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"vd", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"q0", "'"}], "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"c22", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"vd", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"q1", "'"}], "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"c23", "=", 
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"vd", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"q2", "'"}], "[", "t", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"c31", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"K", ",", 
     RowBox[{
      RowBox[{"q0", "'"}], "[", "t", "]"}]}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"c32", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"K", ",", 
     RowBox[{
      RowBox[{"q1", "'"}], "[", "t", "]"}]}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"c33", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"K", ",", 
     RowBox[{
      RowBox[{"q2", "'"}], "[", "t", "]"}]}], "]"}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.7142887733958874`*^9, 3.7142887800849237`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "l0", " ", "m0", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", "l1", " ", "m0", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "-", 
    RowBox[{"l1", " ", "m1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", "l2", " ", "m0", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", "l2", " ", "m1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "-", 
    RowBox[{"l2", " ", "m2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.709900638226445*^9, 3.71428358238167*^9, 
  3.7142836388199778`*^9, 3.7142887809750886`*^9, 3.71428881926528*^9, 
  3.714722679202202*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "l1", " ", "m0", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "-", 
    RowBox[{"l1", " ", "m1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", "l2", " ", "m0", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "-", 
    RowBox[{"2", " ", "l2", " ", "m1", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "-", 
    RowBox[{"l2", " ", "m2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.709900638226445*^9, 3.71428358238167*^9, 
  3.7142836388199778`*^9, 3.7142887809750886`*^9, 3.71428881926528*^9, 
  3.7147226792082057`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", "l2", " ", "m0", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"fi0", "+", 
      RowBox[{"q0", "[", "t", "]"}], "+", 
      RowBox[{"q1", "[", "t", "]"}], "+", 
      RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "-", 
   RowBox[{"2", " ", "l2", " ", "m1", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"fi0", "+", 
      RowBox[{"q0", "[", "t", "]"}], "+", 
      RowBox[{"q1", "[", "t", "]"}], "+", 
      RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "-", 
   RowBox[{"l2", " ", "m2", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"fi0", "+", 
      RowBox[{"q0", "[", "t", "]"}], "+", 
      RowBox[{"q1", "[", "t", "]"}], "+", 
      RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.709900638226445*^9, 3.71428358238167*^9, 
  3.7142836388199778`*^9, 3.7142887809750886`*^9, 3.71428881926528*^9, 
  3.7147226792122097`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "l0", " ", "m0", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", "l1", " ", "m0", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"l1", " ", "m1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", "l2", " ", "m0", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", "l2", " ", "m1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"l2", " ", "m2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.709900638226445*^9, 3.71428358238167*^9, 
  3.7142836388199778`*^9, 3.7142887809750886`*^9, 3.71428881926528*^9, 
  3.714722679216211*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "l1", " ", "m0", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"l1", " ", "m1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", "l2", " ", "m0", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"2", " ", "l2", " ", "m1", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{"l2", " ", "m2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"fi0", "+", 
       RowBox[{"q0", "[", "t", "]"}], "+", 
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.709900638226445*^9, 3.71428358238167*^9, 
  3.7142836388199778`*^9, 3.7142887809750886`*^9, 3.71428881926528*^9, 
  3.714722679220215*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", " ", "l2", " ", "m0", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"fi0", "+", 
      RowBox[{"q0", "[", "t", "]"}], "+", 
      RowBox[{"q1", "[", "t", "]"}], "+", 
      RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
   RowBox[{"2", " ", "l2", " ", "m1", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"fi0", "+", 
      RowBox[{"q0", "[", "t", "]"}], "+", 
      RowBox[{"q1", "[", "t", "]"}], "+", 
      RowBox[{"q2", "[", "t", "]"}]}], "]"}]}], "+", 
   RowBox[{"l2", " ", "m2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"fi0", "+", 
      RowBox[{"q0", "[", "t", "]"}], "+", 
      RowBox[{"q1", "[", "t", "]"}], "+", 
      RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.709900638226445*^9, 3.71428358238167*^9, 
  3.7142836388199778`*^9, 3.7142887809750886`*^9, 3.71428881926528*^9, 
  3.714722679223216*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", "I0", " ", "m0"}], "+", 
    RowBox[{"4", " ", "I1", " ", "m0"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
    RowBox[{"4", " ", "I0", " ", "m1"}], "+", 
    RowBox[{"4", " ", "I1", " ", "m1"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["l0", "2"], " ", "m0", " ", "m1"}], "+", 
    RowBox[{
     SuperscriptBox["l1", "2"], " ", "m0", " ", "m1"}], "+", 
    RowBox[{"4", " ", "I0", " ", "m2"}], "+", 
    RowBox[{"4", " ", "I1", " ", "m2"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["l0", "2"], " ", "m0", " ", "m2"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["l1", "2"], " ", "m0", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l1", "2"], " ", "m1", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
    RowBox[{"4", " ", "l0", " ", "l1", " ", "m0", " ", 
     RowBox[{"(", 
      RowBox[{"m1", "+", 
       RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{"2", " ", "l1", " ", "l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{"4", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.709900638226445*^9, 3.71428358238167*^9, 
  3.7142836388199778`*^9, 3.7142887809750886`*^9, 3.71428881926528*^9, 
  3.714722679234223*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", "I1", " ", "m0"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
    RowBox[{"4", " ", "I1", " ", "m1"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
    RowBox[{
     SuperscriptBox["l1", "2"], " ", "m0", " ", "m1"}], "+", 
    RowBox[{"4", " ", "I1", " ", "m2"}], "+", 
    RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["l1", "2"], " ", "m0", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l1", "2"], " ", "m1", " ", "m2"}], "+", 
    RowBox[{
     SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
    RowBox[{"2", " ", "l0", " ", "l1", " ", "m0", " ", 
     RowBox[{"(", 
      RowBox[{"m1", "+", 
       RowBox[{"2", " ", "m2"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"q1", "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{"2", " ", "l1", " ", "l2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
    RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"q1", "[", "t", "]"}], "+", 
       RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.709900638226445*^9, 3.71428358238167*^9, 
  3.7142836388199778`*^9, 3.7142887809750886`*^9, 3.71428881926528*^9, 
  3.7147226792632456`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"4", " ", "I2", " ", "m0"}], "+", 
   RowBox[{"4", " ", "I2", " ", "m1"}], "+", 
   RowBox[{"4", " ", "I2", " ", "m2"}], "+", 
   RowBox[{
    SuperscriptBox["l2", "2"], " ", "m0", " ", "m2"}], "+", 
   RowBox[{
    SuperscriptBox["l2", "2"], " ", "m1", " ", "m2"}], "+", 
   RowBox[{"l1", " ", "l2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "m0"}], "+", "m1"}], ")"}], " ", "m2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"q2", "[", "t", "]"}], "]"}]}], "+", 
   RowBox[{"2", " ", "l0", " ", "l2", " ", "m0", " ", "m2", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"q1", "[", "t", "]"}], "+", 
      RowBox[{"q2", "[", "t", "]"}]}], "]"}]}]}], 
  RowBox[{"4", " ", 
   RowBox[{"(", 
    RowBox[{"m0", "+", "m1", "+", "m2"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.709900638226445*^9, 3.71428358238167*^9, 
  3.7142836388199778`*^9, 3.7142887809750886`*^9, 3.71428881926528*^9, 
  3.7147226792702503`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c11", ",", "c12", ",", "c13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c21", ",", "c22", ",", "c23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c31", ",", "c32", ",", "c33"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.709900672772542*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"LinearSolve", "[", 
    RowBox[{"A", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "vx", "}"}], ",", " ", 
       RowBox[{"{", "vy", "}"}], ",", " ", 
       RowBox[{"{", "k", "}"}]}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sol", " ", "=", " ", 
   RowBox[{"sol", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"q0", "[", "t", "]"}], "\[Rule]", "q0des"}], ",", 
      RowBox[{
       RowBox[{"q1", "[", "t", "]"}], "\[Rule]", "q1des"}], ",", 
      RowBox[{
       RowBox[{"q2", "[", "t", "]"}], "\[Rule]", "q2des"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"q0", "'"}], "[", "t", "]"}], "\[Rule]", "dq0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"q1", "'"}], "[", "t", "]"}], "\[Rule]", "dq1"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"q2", "'"}], "[", "t", "]"}], "\[Rule]", "dq2"}]}], "}"}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.7099008964128337`*^9, 3.7099009182114334`*^9}, {
  3.7099021115548964`*^9, 3.7099021459740753`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{"rhod", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"q0", "[", "t", "]"}], "\[Rule]", "q0"}], ",", 
     RowBox[{
      RowBox[{"q1", "[", "t", "]"}], "\[Rule]", "q1"}], ",", 
     RowBox[{
      RowBox[{"q2", "[", "t", "]"}], "\[Rule]", "q2"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"q0", "'"}], "[", "t", "]"}], "\[Rule]", "dq0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"q1", "'"}], "[", "t", "]"}], "\[Rule]", "dq1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"q2", "'"}], "[", "t", "]"}], "\[Rule]", "dq2"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6984308962964535`*^9, 3.6984309068364906`*^9}, {
   3.698431366986294*^9, 3.698431367536685*^9}, 3.6984314019301157`*^9, {
   3.698431449216399*^9, 3.698431449283423*^9}, {3.6984314821349735`*^9, 
   3.698431482270014*^9}, {3.6984315211560106`*^9, 3.6984315217423763`*^9}, {
   3.698431569488676*^9, 3.698431585802921*^9}, {3.6984316390540414`*^9, 
   3.698431666827653*^9}, {3.698431704572156*^9, 3.698431730021944*^9}, 
   3.698431767846109*^9, 3.698993412950244*^9, {3.698993512702371*^9, 
   3.698993513054604*^9}, {3.6989935692361765`*^9, 3.6989935693572626`*^9}, {
   3.6989942890748615`*^9, 3.6989942892189565`*^9}, {3.6989944799182873`*^9, 
   3.698994491574068*^9}, {3.6989954938663626`*^9, 3.6989954941095257`*^9}, {
   3.6989955406515255`*^9, 3.698995552013103*^9}, {3.7088616436302366`*^9, 
   3.7088617019638233`*^9}, {3.708861800939823*^9, 3.70886180114857*^9}, {
   3.708861843498722*^9, 3.708861843683202*^9}, {3.708861890270903*^9, 
   3.708861890769312*^9}, {3.708861957309457*^9, 3.70886195768676*^9}, {
   3.7088619886513667`*^9, 3.708861989691452*^9}, {3.7088620238385725`*^9, 
   3.7088620805065517`*^9}, {3.708862121788761*^9, 3.70886212211365*^9}, {
   3.708862158126619*^9, 3.7088621583745775`*^9}, {3.7088622364936004`*^9, 
   3.7088622366526566`*^9}, {3.7088623060450497`*^9, 
   3.7088623063127775`*^9}, {3.7095296718603687`*^9, 3.709529672676911*^9}, {
   3.709531638437243*^9, 3.7095316399702606`*^9}, 3.709892360308299*^9, 
   3.7098929677893515`*^9, {3.709898694498602*^9, 3.7098986959161673`*^9}, {
   3.709898767842194*^9, 3.709898767968639*^9}, {3.7098988091655416`*^9, 
   3.709898836473824*^9}, {3.709898915461712*^9, 3.7098989421681576`*^9}, {
   3.709899099709993*^9, 3.709899130148365*^9}, {3.7098991825630407`*^9, 
   3.7098992092998776`*^9}, {3.7098992413624916`*^9, 3.7098992686122727`*^9}, 
   3.709899342959096*^9, {3.7099007319731655`*^9, 3.70990073414278*^9}, {
   3.7099092592082605`*^9, 3.7099092885805745`*^9}, 3.710676438343677*^9, {
   3.714283785550338*^9, 3.7142837863341923`*^9}, {3.714283856653063*^9, 
   3.7142838573340034`*^9}, {3.714283887942548*^9, 3.714283888860551*^9}, {
   3.7142839416207128`*^9, 3.7142840464192257`*^9}, {3.7142840939466667`*^9, 
   3.7142840941059213`*^9}, {3.71428412924986*^9, 3.714284185274952*^9}, 
   3.714284274313881*^9, {3.7142843182958927`*^9, 3.7142843186403465`*^9}, {
   3.714291410291453*^9, 3.7142914121161833`*^9}, {3.7142914877471423`*^9, 
   3.714291488010956*^9}, {3.7142915402100067`*^9, 3.7142915403455286`*^9}, {
   3.7142915719464054`*^9, 3.7142916541221743`*^9}, {3.7142917013215017`*^9, 
   3.7142917015217066`*^9}, {3.71429175953529*^9, 3.714291790263341*^9}, {
   3.714291852974541*^9, 3.7142918811896567`*^9}, 3.7142919772373805`*^9, {
   3.7142920227802973`*^9, 3.714292023037093*^9}, {3.714722699267579*^9, 
   3.714722700651315*^9}, {3.714723656676718*^9, 3.7147236572373753`*^9}, {
   3.7147238082352133`*^9, 3.714723808388359*^9}, {3.714723926249536*^9, 
   3.7147239271300883`*^9}}],

Cell[BoxData["\<\"[(1/2).*(m0+m1+m2).^(-1).*(2.*l0.*m0.*cos(fi0+q0)+l1.*(2.*\
m0+m1).* ...\\n  \
cos(fi0+q0+q1)+l2.*(2.*m0+2.*m1+m2).*cos(fi0+q0+q1+q2)),(1/2).*( ...\\n  \
m0+m1+m2).^(-1).*(2.*l0.*m0.*sin(fi0+q0)+l1.*(2.*m0+m1).*sin(fi0+ ...\\n  \
q0+q1)+l2.*(2.*m0+2.*m1+m2).*sin(fi0+q0+q1+q2)),0];\\n\"\>"], "Output",
 CellChangeTimes->{
  3.709902189211931*^9, {3.7099092607485495`*^9, 3.7099092896133823`*^9}, 
   3.710676439499446*^9, 3.714283599436302*^9, 3.714283723301687*^9, 
   3.714283787259107*^9, 3.714283857908965*^9, 3.7142838892682853`*^9, {
   3.714283942497851*^9, 3.7142840468650045`*^9}, 3.714284095129099*^9, {
   3.7142841307192297`*^9, 3.714284158035797*^9}, 3.714284188324568*^9, 
   3.714284275319697*^9, 3.7142843195433216`*^9, 3.71428893659019*^9, 
   3.714291415031291*^9, 3.7142914893477073`*^9, 3.7142915415205393`*^9, {
   3.714291572747204*^9, 3.714291596242364*^9}, {3.714291627594028*^9, 
   3.714291654658188*^9}, 3.714291703466922*^9, {3.714291761025118*^9, 
   3.714291790851742*^9}, {3.7142918539519606`*^9, 3.7142918817836447`*^9}, 
   3.7142919786582813`*^9, 3.7142920240591955`*^9, {3.714722685073554*^9, 
   3.714722701419525*^9}, 3.714723663069733*^9, 3.714723810718106*^9, 
   3.714723928162733*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 146, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[729, 26, 108, 1, 49, "Subsection"],
Cell[CellGroupData[{
Cell[862, 31, 594, 12, 72, "Input"],
Cell[1459, 45, 145, 3, 31, "Output"],
Cell[1607, 50, 184, 4, 31, "Output"],
Cell[1794, 56, 223, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2054, 66, 437, 10, 72, "Input"],
Cell[2494, 78, 181, 4, 31, "Output"],
Cell[2678, 84, 292, 8, 31, "Output"],
Cell[2973, 94, 396, 11, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3406, 110, 301, 8, 31, "Input"],
Cell[3710, 120, 271, 7, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4030, 133, 108, 1, 49, "Subsection"],
Cell[CellGroupData[{
Cell[4163, 138, 3400, 96, 132, "Input"],
Cell[7566, 236, 827, 14, 31, "Output"],
Cell[8396, 252, 1541, 36, 55, "Output"],
Cell[9940, 290, 1981, 48, 102, "Output"],
Cell[11924, 340, 1910, 46, 52, "Output"],
Cell[13837, 388, 1121, 24, 31, "Output"],
Cell[14961, 414, 1473, 34, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16483, 454, 104, 1, 49, "Subsection"],
Cell[CellGroupData[{
Cell[16612, 459, 355, 10, 31, "Input"],
Cell[16970, 471, 3460, 92, 196, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20479, 569, 139, 1, 49, "Subsection"],
Cell[CellGroupData[{
Cell[20643, 574, 965, 22, 132, "Input"],
Cell[21611, 598, 2435, 63, 109, "Output"],
Cell[24049, 663, 2177, 55, 109, "Output"],
Cell[26229, 720, 2347, 61, 109, "Output"],
Cell[28579, 783, 2485, 65, 109, "Output"],
Cell[31067, 850, 2365, 61, 109, "Output"],
Cell[33435, 913, 2235, 57, 109, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[35719, 976, 105, 1, 49, "Subsection"],
Cell[CellGroupData[{
Cell[35849, 981, 1087, 21, 92, "Input"],
Cell[36939, 1004, 3962, 107, 109, "Output"],
Cell[40904, 1113, 3659, 99, 109, "Output"],
Cell[44566, 1214, 3831, 105, 109, "Output"],
Cell[48400, 1321, 3969, 109, 109, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52418, 1436, 103, 1, 49, "Subsection"],
Cell[CellGroupData[{
Cell[52546, 1441, 1560, 38, 72, "Input"],
Cell[54109, 1481, 5209, 124, 128, "Output"],
Cell[59321, 1607, 5172, 123, 128, "Output"],
Cell[64496, 1732, 5498, 132, 128, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[70043, 1870, 110, 1, 49, "Subsection"],
Cell[CellGroupData[{
Cell[70178, 1875, 335, 6, 31, "Input"],
Cell[70516, 1883, 13691, 344, 321, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[84256, 2233, 116, 1, 49, "Subsection"],
Cell[CellGroupData[{
Cell[84397, 2238, 1552, 39, 31, "Input"],
Cell[85952, 2279, 9297, 244, 337, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95286, 2528, 1568, 39, 31, "Input"],
Cell[96857, 2569, 6563, 175, 265, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103457, 2749, 1270, 35, 31, "Input"],
Cell[104730, 2786, 4427, 123, 166, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109206, 2915, 138, 2, 49, "Subsection"],
Cell[CellGroupData[{
Cell[109369, 2921, 600, 14, 31, "Input"],
Cell[109972, 2937, 2275, 54, 84, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112284, 2996, 496, 12, 31, "Input"],
Cell[112783, 3010, 1957, 47, 84, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114777, 3062, 490, 12, 31, "Input"],
Cell[115270, 3076, 1291, 30, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116598, 3111, 697, 15, 31, "Input"],
Cell[117298, 3128, 1949, 47, 84, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119284, 3180, 545, 13, 31, "Input"],
Cell[119832, 3195, 1433, 34, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121302, 3234, 547, 13, 31, "Input"],
Cell[121852, 3249, 1034, 25, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122923, 3279, 695, 15, 31, "Input"],
Cell[123621, 3296, 1288, 30, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124946, 3331, 547, 13, 31, "Input"],
Cell[125496, 3346, 1041, 25, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126574, 3376, 493, 12, 31, "Input"],
Cell[127070, 3390, 823, 19, 60, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127942, 3415, 108, 1, 49, "Subsection"],
Cell[CellGroupData[{
Cell[128075, 3420, 622, 17, 31, "Input"],
Cell[128700, 3439, 4206, 112, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132943, 3556, 496, 15, 31, "Input"],
Cell[133442, 3573, 2346, 63, 84, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135825, 3641, 494, 15, 31, "Input"],
Cell[136322, 3658, 1935, 52, 60, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[138306, 3716, 105, 1, 70, "Section"],
Cell[CellGroupData[{
Cell[138436, 3721, 1119, 33, 92, "Input"],
Cell[139558, 3756, 5478, 139, 153, "Output"],
Cell[145039, 3897, 4570, 115, 153, "Output"],
Cell[149612, 4014, 6798, 169, 199, "Output"],
Cell[156413, 4185, 4823, 119, 176, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161273, 4309, 261, 7, 31, "Input"],
Cell[161537, 4318, 3298, 88, 106, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[164884, 4412, 114, 1, 70, "Section"],
Cell[CellGroupData[{
Cell[165023, 4417, 2024, 64, 192, "Input"],
Cell[167050, 4483, 1612, 43, 82, "Output"],
Cell[168665, 4528, 1461, 39, 82, "Output"],
Cell[170129, 4569, 1013, 27, 58, "Output"],
Cell[171145, 4598, 1591, 42, 82, "Output"],
Cell[172739, 4642, 1438, 38, 82, "Output"],
Cell[174180, 4682, 991, 26, 58, "Output"],
Cell[175174, 4710, 1980, 50, 84, "Output"],
Cell[177157, 4762, 1671, 43, 84, "Output"],
Cell[178831, 4807, 995, 26, 60, "Output"]
}, Open  ]],
Cell[179841, 4836, 378, 12, 31, "Input"],
Cell[180222, 4850, 307, 9, 31, "Input"],
Cell[180532, 4861, 815, 23, 31, "Input"],
Cell[CellGroupData[{
Cell[181372, 4888, 3670, 61, 31, "Input"],
Cell[185045, 4951, 1243, 18, 112, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
