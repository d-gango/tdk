classdef wenBayard < handle
    %WENBAYARD Summary of this class goes here
    %   Detailed explanation goes here
    
    properties
        q_des
        dq_des
        ddq_des
        q_error
        P = [25;15];
        D = [17;10];
    end
    
    methods
        function obj = wenBayard()
            global maxStep
            obj.q_des = zeros(3,maxStep);
            obj.dq_des = zeros(3,maxStep);
            obj.ddq_des = zeros(3,maxStep);
            obj.q_error = zeros(2,maxStep);
        end
        
        function u = getU(obj, system)
            global timeStep stateVariables timeVector step desiredPosition
            m0 = system.m0;
            m1 = system.m1;
            m2 = system.m2;
            l0 = system.l0;
            l1 = system.l1;
            l2 = system.l2;
            I0 = system.I0;
            I1 = system.I1;
            I2 = system.I2;
            fi0 = system.fi0;
            
            %TODO calculate the appropriate q values for this
            x0 = 2;%2.4845;
            y0 = 1;%0.9506;
           vx = 0;%-0.1*2*sin(2*timeVector(step));
           vy = 0;%0.1*2*cos(2*timeVector(step));
            k = system.angMom;
          
            if step == 1
                obj.q_des(:,step) = system.jointCoordinates(x0, y0);
                q0des = obj.q_des(1,step);
                q1des = obj.q_des(2,step);
                q2des = obj.q_des(3,step);
                obj.dq_des(:,step) = [-((m0 + m1 + m2)*(8*I1*l2*m0^2*vx*cos(q0des + q1des + q2des) - 4*I2*l1*m1^2*vy*sin(q0des + q1des) - 8*I2*l1*m0^2*vy*sin(q0des + q1des) + 8*I1*l2*m1^2*vx*cos(q0des + q1des + q2des) + 4*I1*l2*m2^2*vx*cos(q0des + q1des + q2des) + 8*I1*l2*m0^2*vy*sin(q0des + q1des + q2des) + 8*I1*l2*m1^2*vy*sin(q0des + q1des + q2des) + 4*I1*l2*m2^2*vy*sin(q0des + q1des + q2des) - 8*I2*l1*m0^2*vx*cos(q0des + q1des) - 4*I2*l1*m1^2*vx*cos(q0des + q1des) - 12*I2*l1*m0*m1*vx*cos(q0des + q1des) - 8*I2*l1*m0*m2*vx*cos(q0des + q1des) - 4*I2*l1*m1*m2*vx*cos(q0des + q1des) - 12*I2*l1*m0*m1*vy*sin(q0des + q1des) - 8*I2*l1*m0*m2*vy*sin(q0des + q1des) - 4*I2*l1*m1*m2*vy*sin(q0des + q1des) + 8*k*l1*l2*m0^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 8*k*l1*l2*m0^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*k*l1*l2*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 4*k*l1*l2*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 2*l1^2*l2*m0*m1^2*vx*cos(q0des + q1des + q2des) + 2*l1^2*l2*m0^2*m1*vx*cos(q0des + q1des + q2des) + 4*l1^2*l2*m0*m2^2*vx*cos(q0des + q1des + q2des) + 8*l1^2*l2*m0^2*m2*vx*cos(q0des + q1des + q2des) + l1^2*l2*m1*m2^2*vx*cos(q0des + q1des + q2des) + 2*l1^2*l2*m1^2*m2*vx*cos(q0des + q1des + q2des) + 2*l1^2*l2*m0*m1^2*vy*sin(q0des + q1des + q2des) + 2*l1^2*l2*m0^2*m1*vy*sin(q0des + q1des + q2des) + 4*l1^2*l2*m0*m2^2*vy*sin(q0des + q1des + q2des) + 8*l1^2*l2*m0^2*m2*vy*sin(q0des + q1des + q2des) + l1^2*l2*m1*m2^2*vy*sin(q0des + q1des + q2des) + 2*l1^2*l2*m1^2*m2*vy*sin(q0des + q1des + q2des) + 16*I1*l2*m0*m1*vx*cos(q0des + q1des + q2des) + 12*I1*l2*m0*m2*vx*cos(q0des + q1des + q2des) + 12*I1*l2*m1*m2*vx*cos(q0des + q1des + q2des) + 16*I1*l2*m0*m1*vy*sin(q0des + q1des + q2des) + 12*I1*l2*m0*m2*vy*sin(q0des + q1des + q2des) + 12*I1*l2*m1*m2*vy*sin(q0des + q1des + q2des) - 2*l1*l2^2*m0^2*m2*vx*cos(q0des + q1des) - l1*l2^2*m1^2*m2*vx*cos(q0des + q1des) - 2*l1*l2^2*m0^2*m2*vy*sin(q0des + q1des) - l1*l2^2*m1^2*m2*vy*sin(q0des + q1des) - 3*l1*l2^2*m0*m1*m2*vy*sin(q0des + q1des) + 2*l1*l2^2*m0*m2^2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 4*l1*l2^2*m0^2*m2*vx*cos(q0des + q1des + q2des)*cos(q2des) + l1*l2^2*m1*m2^2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 2*l1*l2^2*m1^2*m2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 2*l1*l2^2*m0*m2^2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 4*l1*l2^2*m0^2*m2*vy*sin(q0des + q1des + q2des)*cos(q2des) + l1*l2^2*m1*m2^2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 2*l1*l2^2*m1^2*m2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 12*k*l1*l2*m0*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 12*k*l1*l2*m0*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*k*l1*l2*m0*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 4*k*l1*l2*m0*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 2*k*l1*l2*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 2*k*l1*l2*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 11*l1^2*l2*m0*m1*m2*vx*cos(q0des + q1des + q2des) + 11*l1^2*l2*m0*m1*m2*vy*sin(q0des + q1des + q2des) - 4*l1^2*l2*m0^2*m2*vx*cos(q0des + q1des)*cos(q2des) - l1^2*l2*m1^2*m2*vx*cos(q0des + q1des)*cos(q2des) - 4*l1^2*l2*m0^2*m2*vy*sin(q0des + q1des)*cos(q2des) - l1^2*l2*m1^2*m2*vy*sin(q0des + q1des)*cos(q2des) - 3*l1*l2^2*m0*m1*m2*vx*cos(q0des + q1des) + 6*l1*l2^2*m0*m1*m2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 6*l1*l2^2*m0*m1*m2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 4*l0*l1*l2*m0*m1^2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) + 4*l0*l1*l2*m0^2*m1*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) + 4*l0*l1*l2*m0*m2^2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) + 8*l0*l1*l2*m0^2*m2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) - 4*l0*l1*l2*m0^2*m2*vx*cos(q1des - fi0 + q2des)*cos(q0des + q1des) + 4*l0*l1*l2*m0*m1^2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) + 4*l0*l1*l2*m0^2*m1*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) + 4*l0*l1*l2*m0*m2^2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) + 8*l0*l1*l2*m0^2*m2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) - 4*l0*l1*l2*m0^2*m2*vy*cos(q1des - fi0 + q2des)*sin(q0des + q1des) - 4*l1^2*l2*m0*m1*m2*vx*cos(q0des + q1des)*cos(q2des) - 4*l1^2*l2*m0*m1*m2*vy*sin(q0des + q1des)*cos(q2des) + 10*l0*l1*l2*m0*m1*m2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) - 2*l0*l1*l2*m0*m1*m2*vx*cos(q1des - fi0 + q2des)*cos(q0des + q1des) + 10*l0*l1*l2*m0*m1*m2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) - 2*l0*l1*l2*m0*m1*m2*vy*cos(q1des - fi0 + q2des)*sin(q0des + q1des)))/(8*I1*l0*l2*m0^3*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*I1*l0*l2*m0^3*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 8*I0*l1*l2*m0^3*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 8*I0*l1*l2*m0^3*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*I0*l1*l2*m1^3*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*I0*l1*l2*m1^3*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 8*I2*l0*l1*m0^3*cos(fi0 + q0des)*sin(q0des + q1des) - 8*I2*l0*l1*m0^3*cos(q0des + q1des)*sin(fi0 + q0des) - 4*l0^2*l1*l2*m0*m1^3*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*l0^2*l1*l2*m0*m1^3*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 8*l0^2*l1*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 8*l0^2*l1*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 8*l0^2*l1*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 8*l0^2*l1*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*I2*l0*l1*m0*m1^2*cos(fi0 + q0des)*sin(q0des + q1des) - 4*I2*l0*l1*m0*m1^2*cos(q0des + q1des)*sin(fi0 + q0des) + 12*I2*l0*l1*m0^2*m1*cos(fi0 + q0des)*sin(q0des + q1des) - 12*I2*l0*l1*m0^2*m1*cos(q0des + q1des)*sin(fi0 + q0des) + 8*I2*l0*l1*m0^2*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 8*I2*l0*l1*m0^2*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 2*l0*l1^2*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 4*l0*l1^2*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 4*l0*l1^2*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 12*l0^2*l1*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 12*l0^2*l1*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*l0^2*l1*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*l0^2*l1*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 8*I1*l0*l2*m0*m1^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*I1*l0*l2*m0*m1^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 16*I1*l0*l2*m0^2*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 16*I1*l0*l2*m0^2*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 4*I1*l0*l2*m0*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 4*I1*l0*l2*m0*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 12*I1*l0*l2*m0^2*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 12*I1*l0*l2*m0^2*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 16*I0*l1*l2*m0*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 16*I0*l1*l2*m0*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 20*I0*l1*l2*m0^2*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 20*I0*l1*l2*m0^2*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*I0*l1*l2*m0*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*I0*l1*l2*m0*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 12*I0*l1*l2*m0^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 12*I0*l1*l2*m0^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 2*I0*l1*l2*m1*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 2*I0*l1*l2*m1*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 6*I0*l1*l2*m1^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 6*I0*l1*l2*m1^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 2*l0*l1*l2^2*m0^3*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 2*l0*l1*l2^2*m0^3*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 2*l0*l1^2*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 8*l0*l1^2*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*l0*l1^2*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 2*l0*l1^2*l2*m0*m1^3*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 2*l0*l1^2*l2*m0*m1^3*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 4*l0*l1^2*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 4*l0*l1^2*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 8*l0*l1^2*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 8*l0*l1^2*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) + 4*I2*l0*l1*m0*m1*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 4*I2*l0*l1*m0*m1*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 2*l0*l1*l2^2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2^2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 4*l0^2*l1*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 4*l0^2*l1*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 4*l0^2*l1*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 4*l0^2*l1*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 4*l0*l1^2*l2*m0^3*m2*cos(fi0 + q0des)*sin(q0des + q1des)*cos(q2des) - 4*l0*l1^2*l2*m0^3*m2*cos(q0des + q1des)*sin(fi0 + q0des)*cos(q2des) - 6*l0*l1^2*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 6*l0*l1^2*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 4*l0*l1^2*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 4*l0*l1^2*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) + l0*l1^2*l2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - l0*l1^2*l2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 2*l0*l1^2*l2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 11*l0*l1^2*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 11*l0*l1^2*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 4*l0*l1*l2^2*m0^3*m2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 4*l0*l1*l2^2*m0^3*m2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) - 2*l0^2*l1*l2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 2*l0^2*l1*l2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 6*l0^2*l1*l2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 6*l0^2*l1*l2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 16*l0^2*l1*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 16*l0^2*l1*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 12*I1*l0*l2*m0*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 12*I1*l0*l2*m0*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 18*I0*l1*l2*m0*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 18*I0*l1*l2*m0*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*l0*l1*l2^2*m0^3*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 4*l0*l1*l2^2*m0^3*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2^2*m0^2*m2^2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 2*l0*l1*l2^2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) + 4*l0^2*l1*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 4*l0^2*l1*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 8*l0^2*l1*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 8*l0^2*l1*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 4*l0^2*l1*l2*m0^3*m2*cos(q1des - fi0 + q2des)*cos(fi0 + q0des)*sin(q0des + q1des) - 4*l0^2*l1*l2*m0^3*m2*cos(q1des - fi0 + q2des)*cos(q0des + q1des)*sin(fi0 + q0des) + l0*l1*l2^2*m0*m1^2*m2*cos(fi0 + q0des)*sin(q0des + q1des) - l0*l1*l2^2*m0*m1^2*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 3*l0*l1*l2^2*m0^2*m1*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 3*l0*l1*l2^2*m0^2*m1*m2*cos(q0des + q1des)*sin(fi0 + q0des) + l0*l1*l2^2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - l0*l1*l2^2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 2*l0*l1*l2^2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2^2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 6*l0*l1*l2^2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 6*l0*l1*l2^2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 10*l0^2*l1*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 10*l0^2*l1*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 2*l0^2*l1*l2*m0^2*m1*m2*cos(q1des - fi0 + q2des)*cos(fi0 + q0des)*sin(q0des + q1des) - 2*l0^2*l1*l2*m0^2*m1*m2*cos(q1des - fi0 + q2des)*cos(q0des + q1des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 2*l0*l1^2*l2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 5*l0*l1^2*l2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 5*l0*l1^2*l2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 14*l0*l1^2*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 14*l0*l1^2*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) + l0*l1^2*l2*m0*m1^2*m2*cos(fi0 + q0des)*sin(q0des + q1des)*cos(q2des) - l0*l1^2*l2*m0*m1^2*m2*cos(q0des + q1des)*sin(fi0 + q0des)*cos(q2des) + 4*l0*l1^2*l2*m0^2*m1*m2*cos(fi0 + q0des)*sin(q0des + q1des)*cos(q2des) - 4*l0*l1^2*l2*m0^2*m1*m2*cos(q0des + q1des)*sin(fi0 + q0des)*cos(q2des) - l0*l1*l2^2*m0*m1*m2^2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + l0*l1*l2^2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) - 2*l0*l1*l2^2*m0*m1^2*m2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 2*l0*l1*l2^2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) - 6*l0*l1*l2^2*m0^2*m1*m2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 6*l0*l1*l2^2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des));
                                     ((m0 + m1 + m2)*(8*I0*l2*m0^2*vx*cos(q0des + q1des + q2des) - 8*I2*l1*m0^2*vy*sin(q0des + q1des) - 4*I2*l1*m1^2*vy*sin(q0des + q1des) - 8*I2*l0*m0^2*vy*sin(fi0 + q0des) + 8*I0*l2*m1^2*vx*cos(q0des + q1des + q2des) + 8*I1*l2*m0^2*vx*cos(q0des + q1des + q2des) + 4*I0*l2*m2^2*vx*cos(q0des + q1des + q2des) + 8*I1*l2*m1^2*vx*cos(q0des + q1des + q2des) + 4*I1*l2*m2^2*vx*cos(q0des + q1des + q2des) + 8*I0*l2*m0^2*vy*sin(q0des + q1des + q2des) + 8*I0*l2*m1^2*vy*sin(q0des + q1des + q2des) + 8*I1*l2*m0^2*vy*sin(q0des + q1des + q2des) + 4*I0*l2*m2^2*vy*sin(q0des + q1des + q2des) + 8*I1*l2*m1^2*vy*sin(q0des + q1des + q2des) + 4*I1*l2*m2^2*vy*sin(q0des + q1des + q2des) - 8*I2*l0*m0^2*vx*cos(fi0 + q0des) - 8*I2*l1*m0^2*vx*cos(q0des + q1des) - 4*I2*l1*m1^2*vx*cos(q0des + q1des) - 12*I2*l1*m0*m1*vx*cos(q0des + q1des) - 8*I2*l1*m0*m2*vx*cos(q0des + q1des) - 4*I2*l1*m1*m2*vx*cos(q0des + q1des) - 8*I2*l0*m0*m1*vy*sin(fi0 + q0des) - 8*I2*l0*m0*m2*vy*sin(fi0 + q0des) - 12*I2*l1*m0*m1*vy*sin(q0des + q1des) - 8*I2*l1*m0*m2*vy*sin(q0des + q1des) - 4*I2*l1*m1*m2*vy*sin(q0des + q1des) + 8*k*l0*l2*m0^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*k*l0*l2*m0^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 8*k*l1*l2*m0^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 8*k*l1*l2*m0^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*k*l1*l2*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 4*k*l1*l2*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 8*l0^2*l2*m0*m1^2*vx*cos(q0des + q1des + q2des) + 8*l0^2*l2*m0^2*m1*vx*cos(q0des + q1des + q2des) + 4*l0^2*l2*m0*m2^2*vx*cos(q0des + q1des + q2des) + 8*l0^2*l2*m0^2*m2*vx*cos(q0des + q1des + q2des) + 2*l1^2*l2*m0*m1^2*vx*cos(q0des + q1des + q2des) + 2*l1^2*l2*m0^2*m1*vx*cos(q0des + q1des + q2des) + 4*l1^2*l2*m0*m2^2*vx*cos(q0des + q1des + q2des) + 8*l1^2*l2*m0^2*m2*vx*cos(q0des + q1des + q2des) + l1^2*l2*m1*m2^2*vx*cos(q0des + q1des + q2des) + 2*l1^2*l2*m1^2*m2*vx*cos(q0des + q1des + q2des) + 8*l0^2*l2*m0*m1^2*vy*sin(q0des + q1des + q2des) + 8*l0^2*l2*m0^2*m1*vy*sin(q0des + q1des + q2des) + 4*l0^2*l2*m0*m2^2*vy*sin(q0des + q1des + q2des) + 8*l0^2*l2*m0^2*m2*vy*sin(q0des + q1des + q2des) + 2*l1^2*l2*m0*m1^2*vy*sin(q0des + q1des + q2des) + 2*l1^2*l2*m0^2*m1*vy*sin(q0des + q1des + q2des) + 4*l1^2*l2*m0*m2^2*vy*sin(q0des + q1des + q2des) + 8*l1^2*l2*m0^2*m2*vy*sin(q0des + q1des + q2des) + l1^2*l2*m1*m2^2*vy*sin(q0des + q1des + q2des) + 2*l1^2*l2*m1^2*m2*vy*sin(q0des + q1des + q2des) + 16*I0*l2*m0*m1*vx*cos(q0des + q1des + q2des) + 12*I0*l2*m0*m2*vx*cos(q0des + q1des + q2des) + 16*I1*l2*m0*m1*vx*cos(q0des + q1des + q2des) + 12*I0*l2*m1*m2*vx*cos(q0des + q1des + q2des) + 12*I1*l2*m0*m2*vx*cos(q0des + q1des + q2des) + 12*I1*l2*m1*m2*vx*cos(q0des + q1des + q2des) + 16*I0*l2*m0*m1*vy*sin(q0des + q1des + q2des) + 12*I0*l2*m0*m2*vy*sin(q0des + q1des + q2des) + 16*I1*l2*m0*m1*vy*sin(q0des + q1des + q2des) + 12*I0*l2*m1*m2*vy*sin(q0des + q1des + q2des) + 12*I1*l2*m0*m2*vy*sin(q0des + q1des + q2des) + 12*I1*l2*m1*m2*vy*sin(q0des + q1des + q2des) - 2*l0*l2^2*m0^2*m2*vx*cos(fi0 + q0des) - 2*l1*l2^2*m0^2*m2*vx*cos(q0des + q1des) - l1*l2^2*m1^2*m2*vx*cos(q0des + q1des) - 2*l0*l2^2*m0^2*m2*vy*sin(fi0 + q0des) - 2*l1*l2^2*m0^2*m2*vy*sin(q0des + q1des) - l1*l2^2*m1^2*m2*vy*sin(q0des + q1des) - 8*I2*l0*m0*m1*vx*cos(fi0 + q0des) - 8*I2*l0*m0*m2*vx*cos(fi0 + q0des) - 3*l1*l2^2*m0*m1*m2*vy*sin(q0des + q1des) + 2*l1*l2^2*m0*m2^2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 4*l1*l2^2*m0^2*m2*vx*cos(q0des + q1des + q2des)*cos(q2des) + l1*l2^2*m1*m2^2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 2*l1*l2^2*m1^2*m2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 8*k*l0*l2*m0*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*k*l0*l2*m0*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 4*k*l0*l2*m0*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 4*k*l0*l2*m0*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 2*l1*l2^2*m0*m2^2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 4*l1*l2^2*m0^2*m2*vy*sin(q0des + q1des + q2des)*cos(q2des) + l1*l2^2*m1*m2^2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 2*l1*l2^2*m1^2*m2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 12*k*l1*l2*m0*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 12*k*l1*l2*m0*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*k*l1*l2*m0*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 4*k*l1*l2*m0*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 2*k*l1*l2*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 2*k*l1*l2*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*l0^2*l2*m0^2*m2*vx*cos(q1des - fi0 + q2des)*cos(fi0 + q0des) - 4*l0^2*l2*m0^2*m2*vy*cos(q1des - fi0 + q2des)*sin(fi0 + q0des) + 12*l0^2*l2*m0*m1*m2*vx*cos(q0des + q1des + q2des) + 11*l1^2*l2*m0*m1*m2*vx*cos(q0des + q1des + q2des) + 12*l0^2*l2*m0*m1*m2*vy*sin(q0des + q1des + q2des) + 11*l1^2*l2*m0*m1*m2*vy*sin(q0des + q1des + q2des) - 4*l1^2*l2*m0^2*m2*vx*cos(q0des + q1des)*cos(q2des) - l1^2*l2*m1^2*m2*vx*cos(q0des + q1des)*cos(q2des) + 2*l0*l2^2*m0*m2^2*vx*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des) + 4*l0*l2^2*m0^2*m2*vx*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des) - 4*l1^2*l2*m0^2*m2*vy*sin(q0des + q1des)*cos(q2des) - l1^2*l2*m1^2*m2*vy*sin(q0des + q1des)*cos(q2des) + 2*l0*l2^2*m0*m2^2*vy*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des) + 4*l0*l2^2*m0^2*m2*vy*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des) - 2*l0*l2^2*m0*m1*m2*vx*cos(fi0 + q0des) - 3*l1*l2^2*m0*m1*m2*vx*cos(q0des + q1des) - 2*l0*l2^2*m0*m1*m2*vy*sin(fi0 + q0des) + 6*l1*l2^2*m0*m1*m2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 6*l1*l2^2*m0*m1*m2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 8*l0*l1*l2*m0*m1^2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) + 8*l0*l1*l2*m0^2*m1*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) + 8*l0*l1*l2*m0*m2^2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) + 16*l0*l1*l2*m0^2*m2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) - 4*l0*l1*l2*m0^2*m2*vx*cos(q1des - fi0 + q2des)*cos(q0des + q1des) + 8*l0*l1*l2*m0*m1^2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) + 8*l0*l1*l2*m0^2*m1*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) + 8*l0*l1*l2*m0*m2^2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) + 16*l0*l1*l2*m0^2*m2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) - 4*l0*l1*l2*m0^2*m2*vy*cos(q1des - fi0 + q2des)*sin(q0des + q1des) - 4*l0*l1*l2*m0^2*m2*vx*cos(fi0 + q0des)*cos(q2des) - 4*l1^2*l2*m0*m1*m2*vx*cos(q0des + q1des)*cos(q2des) - 4*l0*l1*l2*m0^2*m2*vy*sin(fi0 + q0des)*cos(q2des) + 4*l0*l2^2*m0*m1*m2*vx*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des) - 4*l1^2*l2*m0*m1*m2*vy*sin(q0des + q1des)*cos(q2des) + 4*l0*l2^2*m0*m1*m2*vy*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des) + 20*l0*l1*l2*m0*m1*m2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) - 2*l0*l1*l2*m0*m1*m2*vx*cos(q1des - fi0 + q2des)*cos(q0des + q1des) + 20*l0*l1*l2*m0*m1*m2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) - 2*l0*l1*l2*m0*m1*m2*vy*cos(q1des - fi0 + q2des)*sin(q0des + q1des) - 2*l0*l1*l2*m0*m1*m2*vx*cos(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2*m0*m1*m2*vy*sin(fi0 + q0des)*cos(q2des)))/(8*I1*l0*l2*m0^3*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*I1*l0*l2*m0^3*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 8*I0*l1*l2*m0^3*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 8*I0*l1*l2*m0^3*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*I0*l1*l2*m1^3*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*I0*l1*l2*m1^3*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 8*I2*l0*l1*m0^3*cos(fi0 + q0des)*sin(q0des + q1des) - 8*I2*l0*l1*m0^3*cos(q0des + q1des)*sin(fi0 + q0des) - 4*l0^2*l1*l2*m0*m1^3*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*l0^2*l1*l2*m0*m1^3*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 8*l0^2*l1*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 8*l0^2*l1*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 8*l0^2*l1*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 8*l0^2*l1*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*I2*l0*l1*m0*m1^2*cos(fi0 + q0des)*sin(q0des + q1des) - 4*I2*l0*l1*m0*m1^2*cos(q0des + q1des)*sin(fi0 + q0des) + 12*I2*l0*l1*m0^2*m1*cos(fi0 + q0des)*sin(q0des + q1des) - 12*I2*l0*l1*m0^2*m1*cos(q0des + q1des)*sin(fi0 + q0des) + 8*I2*l0*l1*m0^2*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 8*I2*l0*l1*m0^2*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 2*l0*l1^2*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 4*l0*l1^2*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 4*l0*l1^2*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 12*l0^2*l1*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 12*l0^2*l1*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*l0^2*l1*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*l0^2*l1*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 8*I1*l0*l2*m0*m1^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*I1*l0*l2*m0*m1^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 16*I1*l0*l2*m0^2*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 16*I1*l0*l2*m0^2*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 4*I1*l0*l2*m0*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 4*I1*l0*l2*m0*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 12*I1*l0*l2*m0^2*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 12*I1*l0*l2*m0^2*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 16*I0*l1*l2*m0*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 16*I0*l1*l2*m0*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 20*I0*l1*l2*m0^2*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 20*I0*l1*l2*m0^2*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*I0*l1*l2*m0*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*I0*l1*l2*m0*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 12*I0*l1*l2*m0^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 12*I0*l1*l2*m0^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 2*I0*l1*l2*m1*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 2*I0*l1*l2*m1*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 6*I0*l1*l2*m1^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 6*I0*l1*l2*m1^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 2*l0*l1*l2^2*m0^3*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 2*l0*l1*l2^2*m0^3*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 2*l0*l1^2*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 8*l0*l1^2*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*l0*l1^2*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 2*l0*l1^2*l2*m0*m1^3*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 2*l0*l1^2*l2*m0*m1^3*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 4*l0*l1^2*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 4*l0*l1^2*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 8*l0*l1^2*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 8*l0*l1^2*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) + 4*I2*l0*l1*m0*m1*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 4*I2*l0*l1*m0*m1*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 2*l0*l1*l2^2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2^2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 4*l0^2*l1*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 4*l0^2*l1*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 4*l0^2*l1*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 4*l0^2*l1*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 4*l0*l1^2*l2*m0^3*m2*cos(fi0 + q0des)*sin(q0des + q1des)*cos(q2des) - 4*l0*l1^2*l2*m0^3*m2*cos(q0des + q1des)*sin(fi0 + q0des)*cos(q2des) - 6*l0*l1^2*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 6*l0*l1^2*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 4*l0*l1^2*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 4*l0*l1^2*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) + l0*l1^2*l2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - l0*l1^2*l2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 2*l0*l1^2*l2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 11*l0*l1^2*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 11*l0*l1^2*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 4*l0*l1*l2^2*m0^3*m2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 4*l0*l1*l2^2*m0^3*m2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) - 2*l0^2*l1*l2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 2*l0^2*l1*l2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 6*l0^2*l1*l2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 6*l0^2*l1*l2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 16*l0^2*l1*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 16*l0^2*l1*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 12*I1*l0*l2*m0*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 12*I1*l0*l2*m0*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 18*I0*l1*l2*m0*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 18*I0*l1*l2*m0*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*l0*l1*l2^2*m0^3*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 4*l0*l1*l2^2*m0^3*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2^2*m0^2*m2^2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 2*l0*l1*l2^2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) + 4*l0^2*l1*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 4*l0^2*l1*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 8*l0^2*l1*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 8*l0^2*l1*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 4*l0^2*l1*l2*m0^3*m2*cos(q1des - fi0 + q2des)*cos(fi0 + q0des)*sin(q0des + q1des) - 4*l0^2*l1*l2*m0^3*m2*cos(q1des - fi0 + q2des)*cos(q0des + q1des)*sin(fi0 + q0des) + l0*l1*l2^2*m0*m1^2*m2*cos(fi0 + q0des)*sin(q0des + q1des) - l0*l1*l2^2*m0*m1^2*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 3*l0*l1*l2^2*m0^2*m1*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 3*l0*l1*l2^2*m0^2*m1*m2*cos(q0des + q1des)*sin(fi0 + q0des) + l0*l1*l2^2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - l0*l1*l2^2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 2*l0*l1*l2^2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2^2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 6*l0*l1*l2^2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 6*l0*l1*l2^2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 10*l0^2*l1*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 10*l0^2*l1*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 2*l0^2*l1*l2*m0^2*m1*m2*cos(q1des - fi0 + q2des)*cos(fi0 + q0des)*sin(q0des + q1des) - 2*l0^2*l1*l2*m0^2*m1*m2*cos(q1des - fi0 + q2des)*cos(q0des + q1des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 2*l0*l1^2*l2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 5*l0*l1^2*l2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 5*l0*l1^2*l2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 14*l0*l1^2*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 14*l0*l1^2*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) + l0*l1^2*l2*m0*m1^2*m2*cos(fi0 + q0des)*sin(q0des + q1des)*cos(q2des) - l0*l1^2*l2*m0*m1^2*m2*cos(q0des + q1des)*sin(fi0 + q0des)*cos(q2des) + 4*l0*l1^2*l2*m0^2*m1*m2*cos(fi0 + q0des)*sin(q0des + q1des)*cos(q2des) - 4*l0*l1^2*l2*m0^2*m1*m2*cos(q0des + q1des)*sin(fi0 + q0des)*cos(q2des) - l0*l1*l2^2*m0*m1*m2^2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + l0*l1*l2^2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) - 2*l0*l1*l2^2*m0*m1^2*m2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 2*l0*l1*l2^2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) - 6*l0*l1*l2^2*m0^2*m1*m2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 6*l0*l1*l2^2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des));
                                     (((vy*(2*l2*m0*sin(q0des + q1des + q2des) + 2*l2*m1*sin(q0des + q1des + q2des) + l2*m2*sin(q0des + q1des + q2des) + 2*l0*m0*sin(fi0 + q0des) + 2*l1*m0*sin(q0des + q1des) + l1*m1*sin(q0des + q1des)))/(2*(m0 + m1 + m2)) + (vx*(2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l0*m0*cos(fi0 + q0des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des)))/(2*(m0 + m1 + m2)))*(((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des))*(4*I0*m0 + 4*I0*m1 + 4*I1*m0 + 4*I0*m2 + 4*I1*m1 + 4*I2*m0 + 4*I1*m2 + 4*I2*m1 + 4*I2*m2 + 4*l0^2*m0*m1 + 4*l0^2*m0*m2 + l1^2*m0*m1 + 4*l1^2*m0*m2 + l1^2*m1*m2 + l2^2*m0*m2 + l2^2*m1*m2 + 4*l0*l1*m0*cos(fi0 - q1des)*(m1 + 2*m2) + 4*l0*l2*m0*m2*cos(q1des - fi0 + q2des) + 4*l1*l2*m0*m2*cos(q2des) + 2*l1*l2*m1*m2*cos(q2des)))/(8*(m0 + m1 + m2)^2) - ((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l0*m0*cos(fi0 + q0des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des))*(4*I1*m0 + 4*I1*m1 + 4*I2*m0 + 4*I1*m2 + 4*I2*m1 + 4*I2*m2 + l1^2*m0*m1 + 4*l1^2*m0*m2 + l1^2*m1*m2 + l2^2*m0*m2 + l2^2*m1*m2 + 2*l0*l1*m0*cos(fi0 - q1des)*(m1 + 2*m2) + 2*l0*l2*m0*m2*cos(q1des - fi0 + q2des) + 4*l1*l2*m0*m2*cos(q2des) + 2*l1*l2*m1*m2*cos(q2des)))/(8*(m0 + m1 + m2)^2)) + ((vy*(4*I0*m0 + 4*I0*m1 + 4*I1*m0 + 4*I0*m2 + 4*I1*m1 + 4*I2*m0 + 4*I1*m2 + 4*I2*m1 + 4*I2*m2 + 4*l0^2*m0*m1 + 4*l0^2*m0*m2 + l1^2*m0*m1 + 4*l1^2*m0*m2 + l1^2*m1*m2 + l2^2*m0*m2 + l2^2*m1*m2 + 4*l0*l1*m0*cos(fi0 - q1des)*(m1 + 2*m2) + 4*l0*l2*m0*m2*cos(q1des - fi0 + q2des) + 4*l1*l2*m0*m2*cos(q2des) + 2*l1*l2*m1*m2*cos(q2des)))/(4*(m0 + m1 + m2)) - (k*(2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l0*m0*cos(fi0 + q0des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des)))/(2*(m0 + m1 + m2)))*((l0*l1*m0^2*cos(fi0 + q0des)*sin(q0des + q1des))/(m0 + m1 + m2)^2 - (l0*l1*m0^2*cos(q0des + q1des)*sin(fi0 + q0des))/(m0 + m1 + m2)^2 - (l0*l2*m0^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des))/(m0 + m1 + m2)^2 + (l0*l2*m0^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des))/(m0 + m1 + m2)^2 + (l0*l1*m0*m1*cos(fi0 + q0des)*sin(q0des + q1des))/(2*(m0 + m1 + m2)^2) - (l0*l1*m0*m1*cos(q0des + q1des)*sin(fi0 + q0des))/(2*(m0 + m1 + m2)^2) - (l0*l2*m0*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des))/(m0 + m1 + m2)^2 + (l0*l2*m0*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des))/(m0 + m1 + m2)^2 - (l0*l2*m0*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des))/(2*(m0 + m1 + m2)^2) + (l0*l2*m0*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des))/(2*(m0 + m1 + m2)^2)))/((((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des))*(4*I0*m0 + 4*I0*m1 + 4*I1*m0 + 4*I0*m2 + 4*I1*m1 + 4*I2*m0 + 4*I1*m2 + 4*I2*m1 + 4*I2*m2 + 4*l0^2*m0*m1 + 4*l0^2*m0*m2 + l1^2*m0*m1 + 4*l1^2*m0*m2 + l1^2*m1*m2 + l2^2*m0*m2 + l2^2*m1*m2 + 4*l0*l1*m0*cos(fi0 - q1des)*(m1 + 2*m2) + 4*l0*l2*m0*m2*cos(q1des - fi0 + q2des) + 4*l1*l2*m0*m2*cos(q2des) + 2*l1*l2*m1*m2*cos(q2des)))/(8*(m0 + m1 + m2)^2) - ((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l0*m0*cos(fi0 + q0des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des))*(4*I2*m0 + 4*I2*m1 + 4*I2*m2 + l2^2*m0*m2 + l2^2*m1*m2 + l1*l2*m2*cos(q2des)*(2*m0 + m1) + 2*l0*l2*m0*m2*cos(q1des - fi0 + q2des)))/(8*(m0 + m1 + m2)^2))*((l0*l1*m0^2*cos(fi0 + q0des)*sin(q0des + q1des))/(m0 + m1 + m2)^2 - (l0*l1*m0^2*cos(q0des + q1des)*sin(fi0 + q0des))/(m0 + m1 + m2)^2 - (l0*l2*m0^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des))/(m0 + m1 + m2)^2 + (l0*l2*m0^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des))/(m0 + m1 + m2)^2 + (l0*l1*m0*m1*cos(fi0 + q0des)*sin(q0des + q1des))/(2*(m0 + m1 + m2)^2) - (l0*l1*m0*m1*cos(q0des + q1des)*sin(fi0 + q0des))/(2*(m0 + m1 + m2)^2) - (l0*l2*m0*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des))/(m0 + m1 + m2)^2 + (l0*l2*m0*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des))/(m0 + m1 + m2)^2 - (l0*l2*m0*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des))/(2*(m0 + m1 + m2)^2) + (l0*l2*m0*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des))/(2*(m0 + m1 + m2)^2)) - (((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des))*(4*I0*m0 + 4*I0*m1 + 4*I1*m0 + 4*I0*m2 + 4*I1*m1 + 4*I2*m0 + 4*I1*m2 + 4*I2*m1 + 4*I2*m2 + 4*l0^2*m0*m1 + 4*l0^2*m0*m2 + l1^2*m0*m1 + 4*l1^2*m0*m2 + l1^2*m1*m2 + l2^2*m0*m2 + l2^2*m1*m2 + 4*l0*l1*m0*cos(fi0 - q1des)*(m1 + 2*m2) + 4*l0*l2*m0*m2*cos(q1des - fi0 + q2des) + 4*l1*l2*m0*m2*cos(q2des) + 2*l1*l2*m1*m2*cos(q2des)))/(8*(m0 + m1 + m2)^2) - ((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l0*m0*cos(fi0 + q0des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des))*(4*I1*m0 + 4*I1*m1 + 4*I2*m0 + 4*I1*m2 + 4*I2*m1 + 4*I2*m2 + l1^2*m0*m1 + 4*l1^2*m0*m2 + l1^2*m1*m2 + l2^2*m0*m2 + l2^2*m1*m2 + 2*l0*l1*m0*cos(fi0 - q1des)*(m1 + 2*m2) + 2*l0*l2*m0*m2*cos(q1des - fi0 + q2des) + 4*l1*l2*m0*m2*cos(q2des) + 2*l1*l2*m1*m2*cos(q2des)))/(8*(m0 + m1 + m2)^2))*(((2*l2*m0*sin(q0des + q1des + q2des) + 2*l2*m1*sin(q0des + q1des + q2des) + l2*m2*sin(q0des + q1des + q2des))*(2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l0*m0*cos(fi0 + q0des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des)))/(4*(m0 + m1 + m2)^2) - ((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des))*(2*l2*m0*sin(q0des + q1des + q2des) + 2*l2*m1*sin(q0des + q1des + q2des) + l2*m2*sin(q0des + q1des + q2des) + 2*l0*m0*sin(fi0 + q0des) + 2*l1*m0*sin(q0des + q1des) + l1*m1*sin(q0des + q1des)))/(4*(m0 + m1 + m2)^2)))];
                obj.ddq_des(:,step) = [0;0;0];
                desiredPosition(:,step) = [x0; y0];
            else
               obj. q_des(:,step) = system.jointCoordinates(desiredPosition(1,step-1)+timeStep*vx, desiredPosition(2,step-1)+timeStep*vy);
                q0des = obj.q_des(1,step);
                q1des = obj.q_des(2,step);
                q2des = obj.q_des(3,step);
                obj.dq_des(:,step) = [-((m0 + m1 + m2)*(8*I1*l2*m0^2*vx*cos(q0des + q1des + q2des) - 4*I2*l1*m1^2*vy*sin(q0des + q1des) - 8*I2*l1*m0^2*vy*sin(q0des + q1des) + 8*I1*l2*m1^2*vx*cos(q0des + q1des + q2des) + 4*I1*l2*m2^2*vx*cos(q0des + q1des + q2des) + 8*I1*l2*m0^2*vy*sin(q0des + q1des + q2des) + 8*I1*l2*m1^2*vy*sin(q0des + q1des + q2des) + 4*I1*l2*m2^2*vy*sin(q0des + q1des + q2des) - 8*I2*l1*m0^2*vx*cos(q0des + q1des) - 4*I2*l1*m1^2*vx*cos(q0des + q1des) - 12*I2*l1*m0*m1*vx*cos(q0des + q1des) - 8*I2*l1*m0*m2*vx*cos(q0des + q1des) - 4*I2*l1*m1*m2*vx*cos(q0des + q1des) - 12*I2*l1*m0*m1*vy*sin(q0des + q1des) - 8*I2*l1*m0*m2*vy*sin(q0des + q1des) - 4*I2*l1*m1*m2*vy*sin(q0des + q1des) + 8*k*l1*l2*m0^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 8*k*l1*l2*m0^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*k*l1*l2*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 4*k*l1*l2*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 2*l1^2*l2*m0*m1^2*vx*cos(q0des + q1des + q2des) + 2*l1^2*l2*m0^2*m1*vx*cos(q0des + q1des + q2des) + 4*l1^2*l2*m0*m2^2*vx*cos(q0des + q1des + q2des) + 8*l1^2*l2*m0^2*m2*vx*cos(q0des + q1des + q2des) + l1^2*l2*m1*m2^2*vx*cos(q0des + q1des + q2des) + 2*l1^2*l2*m1^2*m2*vx*cos(q0des + q1des + q2des) + 2*l1^2*l2*m0*m1^2*vy*sin(q0des + q1des + q2des) + 2*l1^2*l2*m0^2*m1*vy*sin(q0des + q1des + q2des) + 4*l1^2*l2*m0*m2^2*vy*sin(q0des + q1des + q2des) + 8*l1^2*l2*m0^2*m2*vy*sin(q0des + q1des + q2des) + l1^2*l2*m1*m2^2*vy*sin(q0des + q1des + q2des) + 2*l1^2*l2*m1^2*m2*vy*sin(q0des + q1des + q2des) + 16*I1*l2*m0*m1*vx*cos(q0des + q1des + q2des) + 12*I1*l2*m0*m2*vx*cos(q0des + q1des + q2des) + 12*I1*l2*m1*m2*vx*cos(q0des + q1des + q2des) + 16*I1*l2*m0*m1*vy*sin(q0des + q1des + q2des) + 12*I1*l2*m0*m2*vy*sin(q0des + q1des + q2des) + 12*I1*l2*m1*m2*vy*sin(q0des + q1des + q2des) - 2*l1*l2^2*m0^2*m2*vx*cos(q0des + q1des) - l1*l2^2*m1^2*m2*vx*cos(q0des + q1des) - 2*l1*l2^2*m0^2*m2*vy*sin(q0des + q1des) - l1*l2^2*m1^2*m2*vy*sin(q0des + q1des) - 3*l1*l2^2*m0*m1*m2*vy*sin(q0des + q1des) + 2*l1*l2^2*m0*m2^2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 4*l1*l2^2*m0^2*m2*vx*cos(q0des + q1des + q2des)*cos(q2des) + l1*l2^2*m1*m2^2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 2*l1*l2^2*m1^2*m2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 2*l1*l2^2*m0*m2^2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 4*l1*l2^2*m0^2*m2*vy*sin(q0des + q1des + q2des)*cos(q2des) + l1*l2^2*m1*m2^2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 2*l1*l2^2*m1^2*m2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 12*k*l1*l2*m0*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 12*k*l1*l2*m0*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*k*l1*l2*m0*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 4*k*l1*l2*m0*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 2*k*l1*l2*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 2*k*l1*l2*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 11*l1^2*l2*m0*m1*m2*vx*cos(q0des + q1des + q2des) + 11*l1^2*l2*m0*m1*m2*vy*sin(q0des + q1des + q2des) - 4*l1^2*l2*m0^2*m2*vx*cos(q0des + q1des)*cos(q2des) - l1^2*l2*m1^2*m2*vx*cos(q0des + q1des)*cos(q2des) - 4*l1^2*l2*m0^2*m2*vy*sin(q0des + q1des)*cos(q2des) - l1^2*l2*m1^2*m2*vy*sin(q0des + q1des)*cos(q2des) - 3*l1*l2^2*m0*m1*m2*vx*cos(q0des + q1des) + 6*l1*l2^2*m0*m1*m2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 6*l1*l2^2*m0*m1*m2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 4*l0*l1*l2*m0*m1^2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) + 4*l0*l1*l2*m0^2*m1*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) + 4*l0*l1*l2*m0*m2^2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) + 8*l0*l1*l2*m0^2*m2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) - 4*l0*l1*l2*m0^2*m2*vx*cos(q1des - fi0 + q2des)*cos(q0des + q1des) + 4*l0*l1*l2*m0*m1^2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) + 4*l0*l1*l2*m0^2*m1*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) + 4*l0*l1*l2*m0*m2^2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) + 8*l0*l1*l2*m0^2*m2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) - 4*l0*l1*l2*m0^2*m2*vy*cos(q1des - fi0 + q2des)*sin(q0des + q1des) - 4*l1^2*l2*m0*m1*m2*vx*cos(q0des + q1des)*cos(q2des) - 4*l1^2*l2*m0*m1*m2*vy*sin(q0des + q1des)*cos(q2des) + 10*l0*l1*l2*m0*m1*m2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) - 2*l0*l1*l2*m0*m1*m2*vx*cos(q1des - fi0 + q2des)*cos(q0des + q1des) + 10*l0*l1*l2*m0*m1*m2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) - 2*l0*l1*l2*m0*m1*m2*vy*cos(q1des - fi0 + q2des)*sin(q0des + q1des)))/(8*I1*l0*l2*m0^3*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*I1*l0*l2*m0^3*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 8*I0*l1*l2*m0^3*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 8*I0*l1*l2*m0^3*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*I0*l1*l2*m1^3*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*I0*l1*l2*m1^3*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 8*I2*l0*l1*m0^3*cos(fi0 + q0des)*sin(q0des + q1des) - 8*I2*l0*l1*m0^3*cos(q0des + q1des)*sin(fi0 + q0des) - 4*l0^2*l1*l2*m0*m1^3*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*l0^2*l1*l2*m0*m1^3*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 8*l0^2*l1*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 8*l0^2*l1*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 8*l0^2*l1*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 8*l0^2*l1*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*I2*l0*l1*m0*m1^2*cos(fi0 + q0des)*sin(q0des + q1des) - 4*I2*l0*l1*m0*m1^2*cos(q0des + q1des)*sin(fi0 + q0des) + 12*I2*l0*l1*m0^2*m1*cos(fi0 + q0des)*sin(q0des + q1des) - 12*I2*l0*l1*m0^2*m1*cos(q0des + q1des)*sin(fi0 + q0des) + 8*I2*l0*l1*m0^2*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 8*I2*l0*l1*m0^2*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 2*l0*l1^2*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 4*l0*l1^2*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 4*l0*l1^2*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 12*l0^2*l1*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 12*l0^2*l1*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*l0^2*l1*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*l0^2*l1*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 8*I1*l0*l2*m0*m1^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*I1*l0*l2*m0*m1^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 16*I1*l0*l2*m0^2*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 16*I1*l0*l2*m0^2*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 4*I1*l0*l2*m0*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 4*I1*l0*l2*m0*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 12*I1*l0*l2*m0^2*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 12*I1*l0*l2*m0^2*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 16*I0*l1*l2*m0*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 16*I0*l1*l2*m0*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 20*I0*l1*l2*m0^2*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 20*I0*l1*l2*m0^2*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*I0*l1*l2*m0*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*I0*l1*l2*m0*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 12*I0*l1*l2*m0^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 12*I0*l1*l2*m0^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 2*I0*l1*l2*m1*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 2*I0*l1*l2*m1*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 6*I0*l1*l2*m1^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 6*I0*l1*l2*m1^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 2*l0*l1*l2^2*m0^3*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 2*l0*l1*l2^2*m0^3*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 2*l0*l1^2*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 8*l0*l1^2*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*l0*l1^2*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 2*l0*l1^2*l2*m0*m1^3*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 2*l0*l1^2*l2*m0*m1^3*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 4*l0*l1^2*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 4*l0*l1^2*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 8*l0*l1^2*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 8*l0*l1^2*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) + 4*I2*l0*l1*m0*m1*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 4*I2*l0*l1*m0*m1*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 2*l0*l1*l2^2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2^2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 4*l0^2*l1*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 4*l0^2*l1*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 4*l0^2*l1*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 4*l0^2*l1*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 4*l0*l1^2*l2*m0^3*m2*cos(fi0 + q0des)*sin(q0des + q1des)*cos(q2des) - 4*l0*l1^2*l2*m0^3*m2*cos(q0des + q1des)*sin(fi0 + q0des)*cos(q2des) - 6*l0*l1^2*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 6*l0*l1^2*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 4*l0*l1^2*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 4*l0*l1^2*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) + l0*l1^2*l2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - l0*l1^2*l2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 2*l0*l1^2*l2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 11*l0*l1^2*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 11*l0*l1^2*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 4*l0*l1*l2^2*m0^3*m2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 4*l0*l1*l2^2*m0^3*m2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) - 2*l0^2*l1*l2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 2*l0^2*l1*l2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 6*l0^2*l1*l2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 6*l0^2*l1*l2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 16*l0^2*l1*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 16*l0^2*l1*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 12*I1*l0*l2*m0*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 12*I1*l0*l2*m0*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 18*I0*l1*l2*m0*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 18*I0*l1*l2*m0*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*l0*l1*l2^2*m0^3*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 4*l0*l1*l2^2*m0^3*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2^2*m0^2*m2^2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 2*l0*l1*l2^2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) + 4*l0^2*l1*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 4*l0^2*l1*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 8*l0^2*l1*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 8*l0^2*l1*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 4*l0^2*l1*l2*m0^3*m2*cos(q1des - fi0 + q2des)*cos(fi0 + q0des)*sin(q0des + q1des) - 4*l0^2*l1*l2*m0^3*m2*cos(q1des - fi0 + q2des)*cos(q0des + q1des)*sin(fi0 + q0des) + l0*l1*l2^2*m0*m1^2*m2*cos(fi0 + q0des)*sin(q0des + q1des) - l0*l1*l2^2*m0*m1^2*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 3*l0*l1*l2^2*m0^2*m1*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 3*l0*l1*l2^2*m0^2*m1*m2*cos(q0des + q1des)*sin(fi0 + q0des) + l0*l1*l2^2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - l0*l1*l2^2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 2*l0*l1*l2^2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2^2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 6*l0*l1*l2^2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 6*l0*l1*l2^2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 10*l0^2*l1*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 10*l0^2*l1*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 2*l0^2*l1*l2*m0^2*m1*m2*cos(q1des - fi0 + q2des)*cos(fi0 + q0des)*sin(q0des + q1des) - 2*l0^2*l1*l2*m0^2*m1*m2*cos(q1des - fi0 + q2des)*cos(q0des + q1des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 2*l0*l1^2*l2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 5*l0*l1^2*l2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 5*l0*l1^2*l2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 14*l0*l1^2*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 14*l0*l1^2*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) + l0*l1^2*l2*m0*m1^2*m2*cos(fi0 + q0des)*sin(q0des + q1des)*cos(q2des) - l0*l1^2*l2*m0*m1^2*m2*cos(q0des + q1des)*sin(fi0 + q0des)*cos(q2des) + 4*l0*l1^2*l2*m0^2*m1*m2*cos(fi0 + q0des)*sin(q0des + q1des)*cos(q2des) - 4*l0*l1^2*l2*m0^2*m1*m2*cos(q0des + q1des)*sin(fi0 + q0des)*cos(q2des) - l0*l1*l2^2*m0*m1*m2^2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + l0*l1*l2^2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) - 2*l0*l1*l2^2*m0*m1^2*m2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 2*l0*l1*l2^2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) - 6*l0*l1*l2^2*m0^2*m1*m2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 6*l0*l1*l2^2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des));
                                     ((m0 + m1 + m2)*(8*I0*l2*m0^2*vx*cos(q0des + q1des + q2des) - 8*I2*l1*m0^2*vy*sin(q0des + q1des) - 4*I2*l1*m1^2*vy*sin(q0des + q1des) - 8*I2*l0*m0^2*vy*sin(fi0 + q0des) + 8*I0*l2*m1^2*vx*cos(q0des + q1des + q2des) + 8*I1*l2*m0^2*vx*cos(q0des + q1des + q2des) + 4*I0*l2*m2^2*vx*cos(q0des + q1des + q2des) + 8*I1*l2*m1^2*vx*cos(q0des + q1des + q2des) + 4*I1*l2*m2^2*vx*cos(q0des + q1des + q2des) + 8*I0*l2*m0^2*vy*sin(q0des + q1des + q2des) + 8*I0*l2*m1^2*vy*sin(q0des + q1des + q2des) + 8*I1*l2*m0^2*vy*sin(q0des + q1des + q2des) + 4*I0*l2*m2^2*vy*sin(q0des + q1des + q2des) + 8*I1*l2*m1^2*vy*sin(q0des + q1des + q2des) + 4*I1*l2*m2^2*vy*sin(q0des + q1des + q2des) - 8*I2*l0*m0^2*vx*cos(fi0 + q0des) - 8*I2*l1*m0^2*vx*cos(q0des + q1des) - 4*I2*l1*m1^2*vx*cos(q0des + q1des) - 12*I2*l1*m0*m1*vx*cos(q0des + q1des) - 8*I2*l1*m0*m2*vx*cos(q0des + q1des) - 4*I2*l1*m1*m2*vx*cos(q0des + q1des) - 8*I2*l0*m0*m1*vy*sin(fi0 + q0des) - 8*I2*l0*m0*m2*vy*sin(fi0 + q0des) - 12*I2*l1*m0*m1*vy*sin(q0des + q1des) - 8*I2*l1*m0*m2*vy*sin(q0des + q1des) - 4*I2*l1*m1*m2*vy*sin(q0des + q1des) + 8*k*l0*l2*m0^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*k*l0*l2*m0^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 8*k*l1*l2*m0^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 8*k*l1*l2*m0^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*k*l1*l2*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 4*k*l1*l2*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 8*l0^2*l2*m0*m1^2*vx*cos(q0des + q1des + q2des) + 8*l0^2*l2*m0^2*m1*vx*cos(q0des + q1des + q2des) + 4*l0^2*l2*m0*m2^2*vx*cos(q0des + q1des + q2des) + 8*l0^2*l2*m0^2*m2*vx*cos(q0des + q1des + q2des) + 2*l1^2*l2*m0*m1^2*vx*cos(q0des + q1des + q2des) + 2*l1^2*l2*m0^2*m1*vx*cos(q0des + q1des + q2des) + 4*l1^2*l2*m0*m2^2*vx*cos(q0des + q1des + q2des) + 8*l1^2*l2*m0^2*m2*vx*cos(q0des + q1des + q2des) + l1^2*l2*m1*m2^2*vx*cos(q0des + q1des + q2des) + 2*l1^2*l2*m1^2*m2*vx*cos(q0des + q1des + q2des) + 8*l0^2*l2*m0*m1^2*vy*sin(q0des + q1des + q2des) + 8*l0^2*l2*m0^2*m1*vy*sin(q0des + q1des + q2des) + 4*l0^2*l2*m0*m2^2*vy*sin(q0des + q1des + q2des) + 8*l0^2*l2*m0^2*m2*vy*sin(q0des + q1des + q2des) + 2*l1^2*l2*m0*m1^2*vy*sin(q0des + q1des + q2des) + 2*l1^2*l2*m0^2*m1*vy*sin(q0des + q1des + q2des) + 4*l1^2*l2*m0*m2^2*vy*sin(q0des + q1des + q2des) + 8*l1^2*l2*m0^2*m2*vy*sin(q0des + q1des + q2des) + l1^2*l2*m1*m2^2*vy*sin(q0des + q1des + q2des) + 2*l1^2*l2*m1^2*m2*vy*sin(q0des + q1des + q2des) + 16*I0*l2*m0*m1*vx*cos(q0des + q1des + q2des) + 12*I0*l2*m0*m2*vx*cos(q0des + q1des + q2des) + 16*I1*l2*m0*m1*vx*cos(q0des + q1des + q2des) + 12*I0*l2*m1*m2*vx*cos(q0des + q1des + q2des) + 12*I1*l2*m0*m2*vx*cos(q0des + q1des + q2des) + 12*I1*l2*m1*m2*vx*cos(q0des + q1des + q2des) + 16*I0*l2*m0*m1*vy*sin(q0des + q1des + q2des) + 12*I0*l2*m0*m2*vy*sin(q0des + q1des + q2des) + 16*I1*l2*m0*m1*vy*sin(q0des + q1des + q2des) + 12*I0*l2*m1*m2*vy*sin(q0des + q1des + q2des) + 12*I1*l2*m0*m2*vy*sin(q0des + q1des + q2des) + 12*I1*l2*m1*m2*vy*sin(q0des + q1des + q2des) - 2*l0*l2^2*m0^2*m2*vx*cos(fi0 + q0des) - 2*l1*l2^2*m0^2*m2*vx*cos(q0des + q1des) - l1*l2^2*m1^2*m2*vx*cos(q0des + q1des) - 2*l0*l2^2*m0^2*m2*vy*sin(fi0 + q0des) - 2*l1*l2^2*m0^2*m2*vy*sin(q0des + q1des) - l1*l2^2*m1^2*m2*vy*sin(q0des + q1des) - 8*I2*l0*m0*m1*vx*cos(fi0 + q0des) - 8*I2*l0*m0*m2*vx*cos(fi0 + q0des) - 3*l1*l2^2*m0*m1*m2*vy*sin(q0des + q1des) + 2*l1*l2^2*m0*m2^2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 4*l1*l2^2*m0^2*m2*vx*cos(q0des + q1des + q2des)*cos(q2des) + l1*l2^2*m1*m2^2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 2*l1*l2^2*m1^2*m2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 8*k*l0*l2*m0*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*k*l0*l2*m0*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 4*k*l0*l2*m0*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 4*k*l0*l2*m0*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 2*l1*l2^2*m0*m2^2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 4*l1*l2^2*m0^2*m2*vy*sin(q0des + q1des + q2des)*cos(q2des) + l1*l2^2*m1*m2^2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 2*l1*l2^2*m1^2*m2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 12*k*l1*l2*m0*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 12*k*l1*l2*m0*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*k*l1*l2*m0*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 4*k*l1*l2*m0*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 2*k*l1*l2*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) - 2*k*l1*l2*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*l0^2*l2*m0^2*m2*vx*cos(q1des - fi0 + q2des)*cos(fi0 + q0des) - 4*l0^2*l2*m0^2*m2*vy*cos(q1des - fi0 + q2des)*sin(fi0 + q0des) + 12*l0^2*l2*m0*m1*m2*vx*cos(q0des + q1des + q2des) + 11*l1^2*l2*m0*m1*m2*vx*cos(q0des + q1des + q2des) + 12*l0^2*l2*m0*m1*m2*vy*sin(q0des + q1des + q2des) + 11*l1^2*l2*m0*m1*m2*vy*sin(q0des + q1des + q2des) - 4*l1^2*l2*m0^2*m2*vx*cos(q0des + q1des)*cos(q2des) - l1^2*l2*m1^2*m2*vx*cos(q0des + q1des)*cos(q2des) + 2*l0*l2^2*m0*m2^2*vx*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des) + 4*l0*l2^2*m0^2*m2*vx*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des) - 4*l1^2*l2*m0^2*m2*vy*sin(q0des + q1des)*cos(q2des) - l1^2*l2*m1^2*m2*vy*sin(q0des + q1des)*cos(q2des) + 2*l0*l2^2*m0*m2^2*vy*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des) + 4*l0*l2^2*m0^2*m2*vy*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des) - 2*l0*l2^2*m0*m1*m2*vx*cos(fi0 + q0des) - 3*l1*l2^2*m0*m1*m2*vx*cos(q0des + q1des) - 2*l0*l2^2*m0*m1*m2*vy*sin(fi0 + q0des) + 6*l1*l2^2*m0*m1*m2*vx*cos(q0des + q1des + q2des)*cos(q2des) + 6*l1*l2^2*m0*m1*m2*vy*sin(q0des + q1des + q2des)*cos(q2des) + 8*l0*l1*l2*m0*m1^2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) + 8*l0*l1*l2*m0^2*m1*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) + 8*l0*l1*l2*m0*m2^2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) + 16*l0*l1*l2*m0^2*m2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) - 4*l0*l1*l2*m0^2*m2*vx*cos(q1des - fi0 + q2des)*cos(q0des + q1des) + 8*l0*l1*l2*m0*m1^2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) + 8*l0*l1*l2*m0^2*m1*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) + 8*l0*l1*l2*m0*m2^2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) + 16*l0*l1*l2*m0^2*m2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) - 4*l0*l1*l2*m0^2*m2*vy*cos(q1des - fi0 + q2des)*sin(q0des + q1des) - 4*l0*l1*l2*m0^2*m2*vx*cos(fi0 + q0des)*cos(q2des) - 4*l1^2*l2*m0*m1*m2*vx*cos(q0des + q1des)*cos(q2des) - 4*l0*l1*l2*m0^2*m2*vy*sin(fi0 + q0des)*cos(q2des) + 4*l0*l2^2*m0*m1*m2*vx*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des) - 4*l1^2*l2*m0*m1*m2*vy*sin(q0des + q1des)*cos(q2des) + 4*l0*l2^2*m0*m1*m2*vy*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des) + 20*l0*l1*l2*m0*m1*m2*vx*cos(q0des + q1des + q2des)*cos(fi0 - q1des) - 2*l0*l1*l2*m0*m1*m2*vx*cos(q1des - fi0 + q2des)*cos(q0des + q1des) + 20*l0*l1*l2*m0*m1*m2*vy*sin(q0des + q1des + q2des)*cos(fi0 - q1des) - 2*l0*l1*l2*m0*m1*m2*vy*cos(q1des - fi0 + q2des)*sin(q0des + q1des) - 2*l0*l1*l2*m0*m1*m2*vx*cos(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2*m0*m1*m2*vy*sin(fi0 + q0des)*cos(q2des)))/(8*I1*l0*l2*m0^3*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*I1*l0*l2*m0^3*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 8*I0*l1*l2*m0^3*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 8*I0*l1*l2*m0^3*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*I0*l1*l2*m1^3*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*I0*l1*l2*m1^3*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 8*I2*l0*l1*m0^3*cos(fi0 + q0des)*sin(q0des + q1des) - 8*I2*l0*l1*m0^3*cos(q0des + q1des)*sin(fi0 + q0des) - 4*l0^2*l1*l2*m0*m1^3*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*l0^2*l1*l2*m0*m1^3*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 8*l0^2*l1*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 8*l0^2*l1*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 8*l0^2*l1*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 8*l0^2*l1*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*I2*l0*l1*m0*m1^2*cos(fi0 + q0des)*sin(q0des + q1des) - 4*I2*l0*l1*m0*m1^2*cos(q0des + q1des)*sin(fi0 + q0des) + 12*I2*l0*l1*m0^2*m1*cos(fi0 + q0des)*sin(q0des + q1des) - 12*I2*l0*l1*m0^2*m1*cos(q0des + q1des)*sin(fi0 + q0des) + 8*I2*l0*l1*m0^2*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 8*I2*l0*l1*m0^2*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 2*l0*l1^2*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 4*l0*l1^2*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 4*l0*l1^2*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 12*l0^2*l1*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 12*l0^2*l1*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*l0^2*l1*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*l0^2*l1*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 8*I1*l0*l2*m0*m1^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*I1*l0*l2*m0*m1^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 16*I1*l0*l2*m0^2*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 16*I1*l0*l2*m0^2*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 4*I1*l0*l2*m0*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 4*I1*l0*l2*m0*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 12*I1*l0*l2*m0^2*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 12*I1*l0*l2*m0^2*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 16*I0*l1*l2*m0*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 16*I0*l1*l2*m0*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 20*I0*l1*l2*m0^2*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 20*I0*l1*l2*m0^2*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 4*I0*l1*l2*m0*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 4*I0*l1*l2*m0*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 12*I0*l1*l2*m0^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 12*I0*l1*l2*m0^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 2*I0*l1*l2*m1*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 2*I0*l1*l2*m1*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 6*I0*l1*l2*m1^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 6*I0*l1*l2*m1^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 2*l0*l1*l2^2*m0^3*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 2*l0*l1*l2^2*m0^3*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 2*l0*l1^2*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 8*l0*l1^2*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 8*l0*l1^2*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 2*l0*l1^2*l2*m0*m1^3*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 2*l0*l1^2*l2*m0*m1^3*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 4*l0*l1^2*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 4*l0*l1^2*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 8*l0*l1^2*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 8*l0*l1^2*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) + 4*I2*l0*l1*m0*m1*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 4*I2*l0*l1*m0*m1*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 2*l0*l1*l2^2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2^2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 4*l0^2*l1*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 4*l0^2*l1*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 4*l0^2*l1*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 4*l0^2*l1*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 4*l0*l1^2*l2*m0^3*m2*cos(fi0 + q0des)*sin(q0des + q1des)*cos(q2des) - 4*l0*l1^2*l2*m0^3*m2*cos(q0des + q1des)*sin(fi0 + q0des)*cos(q2des) - 6*l0*l1^2*l2*m0^2*m1^2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 6*l0*l1^2*l2*m0^2*m1^2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 4*l0*l1^2*l2*m0^2*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 4*l0*l1^2*l2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) + l0*l1^2*l2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - l0*l1^2*l2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 2*l0*l1^2*l2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) + 11*l0*l1^2*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 11*l0*l1^2*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 4*l0*l1*l2^2*m0^3*m2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 4*l0*l1*l2^2*m0^3*m2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) - 2*l0^2*l1*l2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 2*l0^2*l1*l2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 6*l0^2*l1*l2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 6*l0^2*l1*l2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) - 16*l0^2*l1*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 16*l0^2*l1*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 12*I1*l0*l2*m0*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des) - 12*I1*l0*l2*m0*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des) - 18*I0*l1*l2*m0*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des) + 18*I0*l1*l2*m0*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des) + 4*l0*l1*l2^2*m0^3*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 4*l0*l1*l2^2*m0^3*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2^2*m0^2*m2^2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 2*l0*l1*l2^2*m0^2*m2^2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) + 4*l0^2*l1*l2*m0^3*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 4*l0^2*l1*l2*m0^3*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 8*l0^2*l1*l2*m0^3*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 8*l0^2*l1*l2*m0^3*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 4*l0^2*l1*l2*m0^3*m2*cos(q1des - fi0 + q2des)*cos(fi0 + q0des)*sin(q0des + q1des) - 4*l0^2*l1*l2*m0^3*m2*cos(q1des - fi0 + q2des)*cos(q0des + q1des)*sin(fi0 + q0des) + l0*l1*l2^2*m0*m1^2*m2*cos(fi0 + q0des)*sin(q0des + q1des) - l0*l1*l2^2*m0*m1^2*m2*cos(q0des + q1des)*sin(fi0 + q0des) + 3*l0*l1*l2^2*m0^2*m1*m2*cos(fi0 + q0des)*sin(q0des + q1des) - 3*l0*l1*l2^2*m0^2*m1*m2*cos(q0des + q1des)*sin(fi0 + q0des) + l0*l1*l2^2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - l0*l1*l2^2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 2*l0*l1*l2^2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 2*l0*l1*l2^2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 6*l0*l1*l2^2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(q2des) - 6*l0*l1*l2^2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(q2des) + 10*l0^2*l1*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des)*cos(fi0 - q1des) - 10*l0^2*l1*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des)*cos(fi0 - q1des) + 2*l0^2*l1*l2*m0^2*m1*m2*cos(q1des - fi0 + q2des)*cos(fi0 + q0des)*sin(q0des + q1des) - 2*l0^2*l1*l2*m0^2*m1*m2*cos(q1des - fi0 + q2des)*cos(q0des + q1des)*sin(fi0 + q0des) - 2*l0*l1^2*l2*m0*m1*m2^2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 2*l0*l1^2*l2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 5*l0*l1^2*l2*m0*m1^2*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 5*l0*l1^2*l2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) - 14*l0*l1^2*l2*m0^2*m1*m2*cos(q0des + q1des + q2des)*sin(q0des + q1des)*cos(fi0 - q1des) + 14*l0*l1^2*l2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(q0des + q1des)*cos(fi0 - q1des) + l0*l1^2*l2*m0*m1^2*m2*cos(fi0 + q0des)*sin(q0des + q1des)*cos(q2des) - l0*l1^2*l2*m0*m1^2*m2*cos(q0des + q1des)*sin(fi0 + q0des)*cos(q2des) + 4*l0*l1^2*l2*m0^2*m1*m2*cos(fi0 + q0des)*sin(q0des + q1des)*cos(q2des) - 4*l0*l1^2*l2*m0^2*m1*m2*cos(q0des + q1des)*sin(fi0 + q0des)*cos(q2des) - l0*l1*l2^2*m0*m1*m2^2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + l0*l1*l2^2*m0*m1*m2^2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) - 2*l0*l1*l2^2*m0*m1^2*m2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 2*l0*l1*l2^2*m0*m1^2*m2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des) - 6*l0*l1*l2^2*m0^2*m1*m2*cos(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*sin(q0des + q1des) + 6*l0*l1*l2^2*m0^2*m1*m2*sin(q0des + q1des + q2des)*cos(q1des - fi0 + q2des)*cos(q0des + q1des));
                                     (((vy*(2*l2*m0*sin(q0des + q1des + q2des) + 2*l2*m1*sin(q0des + q1des + q2des) + l2*m2*sin(q0des + q1des + q2des) + 2*l0*m0*sin(fi0 + q0des) + 2*l1*m0*sin(q0des + q1des) + l1*m1*sin(q0des + q1des)))/(2*(m0 + m1 + m2)) + (vx*(2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l0*m0*cos(fi0 + q0des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des)))/(2*(m0 + m1 + m2)))*(((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des))*(4*I0*m0 + 4*I0*m1 + 4*I1*m0 + 4*I0*m2 + 4*I1*m1 + 4*I2*m0 + 4*I1*m2 + 4*I2*m1 + 4*I2*m2 + 4*l0^2*m0*m1 + 4*l0^2*m0*m2 + l1^2*m0*m1 + 4*l1^2*m0*m2 + l1^2*m1*m2 + l2^2*m0*m2 + l2^2*m1*m2 + 4*l0*l1*m0*cos(fi0 - q1des)*(m1 + 2*m2) + 4*l0*l2*m0*m2*cos(q1des - fi0 + q2des) + 4*l1*l2*m0*m2*cos(q2des) + 2*l1*l2*m1*m2*cos(q2des)))/(8*(m0 + m1 + m2)^2) - ((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l0*m0*cos(fi0 + q0des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des))*(4*I1*m0 + 4*I1*m1 + 4*I2*m0 + 4*I1*m2 + 4*I2*m1 + 4*I2*m2 + l1^2*m0*m1 + 4*l1^2*m0*m2 + l1^2*m1*m2 + l2^2*m0*m2 + l2^2*m1*m2 + 2*l0*l1*m0*cos(fi0 - q1des)*(m1 + 2*m2) + 2*l0*l2*m0*m2*cos(q1des - fi0 + q2des) + 4*l1*l2*m0*m2*cos(q2des) + 2*l1*l2*m1*m2*cos(q2des)))/(8*(m0 + m1 + m2)^2)) + ((vy*(4*I0*m0 + 4*I0*m1 + 4*I1*m0 + 4*I0*m2 + 4*I1*m1 + 4*I2*m0 + 4*I1*m2 + 4*I2*m1 + 4*I2*m2 + 4*l0^2*m0*m1 + 4*l0^2*m0*m2 + l1^2*m0*m1 + 4*l1^2*m0*m2 + l1^2*m1*m2 + l2^2*m0*m2 + l2^2*m1*m2 + 4*l0*l1*m0*cos(fi0 - q1des)*(m1 + 2*m2) + 4*l0*l2*m0*m2*cos(q1des - fi0 + q2des) + 4*l1*l2*m0*m2*cos(q2des) + 2*l1*l2*m1*m2*cos(q2des)))/(4*(m0 + m1 + m2)) - (k*(2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l0*m0*cos(fi0 + q0des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des)))/(2*(m0 + m1 + m2)))*((l0*l1*m0^2*cos(fi0 + q0des)*sin(q0des + q1des))/(m0 + m1 + m2)^2 - (l0*l1*m0^2*cos(q0des + q1des)*sin(fi0 + q0des))/(m0 + m1 + m2)^2 - (l0*l2*m0^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des))/(m0 + m1 + m2)^2 + (l0*l2*m0^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des))/(m0 + m1 + m2)^2 + (l0*l1*m0*m1*cos(fi0 + q0des)*sin(q0des + q1des))/(2*(m0 + m1 + m2)^2) - (l0*l1*m0*m1*cos(q0des + q1des)*sin(fi0 + q0des))/(2*(m0 + m1 + m2)^2) - (l0*l2*m0*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des))/(m0 + m1 + m2)^2 + (l0*l2*m0*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des))/(m0 + m1 + m2)^2 - (l0*l2*m0*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des))/(2*(m0 + m1 + m2)^2) + (l0*l2*m0*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des))/(2*(m0 + m1 + m2)^2)))/((((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des))*(4*I0*m0 + 4*I0*m1 + 4*I1*m0 + 4*I0*m2 + 4*I1*m1 + 4*I2*m0 + 4*I1*m2 + 4*I2*m1 + 4*I2*m2 + 4*l0^2*m0*m1 + 4*l0^2*m0*m2 + l1^2*m0*m1 + 4*l1^2*m0*m2 + l1^2*m1*m2 + l2^2*m0*m2 + l2^2*m1*m2 + 4*l0*l1*m0*cos(fi0 - q1des)*(m1 + 2*m2) + 4*l0*l2*m0*m2*cos(q1des - fi0 + q2des) + 4*l1*l2*m0*m2*cos(q2des) + 2*l1*l2*m1*m2*cos(q2des)))/(8*(m0 + m1 + m2)^2) - ((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l0*m0*cos(fi0 + q0des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des))*(4*I2*m0 + 4*I2*m1 + 4*I2*m2 + l2^2*m0*m2 + l2^2*m1*m2 + l1*l2*m2*cos(q2des)*(2*m0 + m1) + 2*l0*l2*m0*m2*cos(q1des - fi0 + q2des)))/(8*(m0 + m1 + m2)^2))*((l0*l1*m0^2*cos(fi0 + q0des)*sin(q0des + q1des))/(m0 + m1 + m2)^2 - (l0*l1*m0^2*cos(q0des + q1des)*sin(fi0 + q0des))/(m0 + m1 + m2)^2 - (l0*l2*m0^2*cos(q0des + q1des + q2des)*sin(fi0 + q0des))/(m0 + m1 + m2)^2 + (l0*l2*m0^2*sin(q0des + q1des + q2des)*cos(fi0 + q0des))/(m0 + m1 + m2)^2 + (l0*l1*m0*m1*cos(fi0 + q0des)*sin(q0des + q1des))/(2*(m0 + m1 + m2)^2) - (l0*l1*m0*m1*cos(q0des + q1des)*sin(fi0 + q0des))/(2*(m0 + m1 + m2)^2) - (l0*l2*m0*m1*cos(q0des + q1des + q2des)*sin(fi0 + q0des))/(m0 + m1 + m2)^2 + (l0*l2*m0*m1*sin(q0des + q1des + q2des)*cos(fi0 + q0des))/(m0 + m1 + m2)^2 - (l0*l2*m0*m2*cos(q0des + q1des + q2des)*sin(fi0 + q0des))/(2*(m0 + m1 + m2)^2) + (l0*l2*m0*m2*sin(q0des + q1des + q2des)*cos(fi0 + q0des))/(2*(m0 + m1 + m2)^2)) - (((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des))*(4*I0*m0 + 4*I0*m1 + 4*I1*m0 + 4*I0*m2 + 4*I1*m1 + 4*I2*m0 + 4*I1*m2 + 4*I2*m1 + 4*I2*m2 + 4*l0^2*m0*m1 + 4*l0^2*m0*m2 + l1^2*m0*m1 + 4*l1^2*m0*m2 + l1^2*m1*m2 + l2^2*m0*m2 + l2^2*m1*m2 + 4*l0*l1*m0*cos(fi0 - q1des)*(m1 + 2*m2) + 4*l0*l2*m0*m2*cos(q1des - fi0 + q2des) + 4*l1*l2*m0*m2*cos(q2des) + 2*l1*l2*m1*m2*cos(q2des)))/(8*(m0 + m1 + m2)^2) - ((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l0*m0*cos(fi0 + q0des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des))*(4*I1*m0 + 4*I1*m1 + 4*I2*m0 + 4*I1*m2 + 4*I2*m1 + 4*I2*m2 + l1^2*m0*m1 + 4*l1^2*m0*m2 + l1^2*m1*m2 + l2^2*m0*m2 + l2^2*m1*m2 + 2*l0*l1*m0*cos(fi0 - q1des)*(m1 + 2*m2) + 2*l0*l2*m0*m2*cos(q1des - fi0 + q2des) + 4*l1*l2*m0*m2*cos(q2des) + 2*l1*l2*m1*m2*cos(q2des)))/(8*(m0 + m1 + m2)^2))*(((2*l2*m0*sin(q0des + q1des + q2des) + 2*l2*m1*sin(q0des + q1des + q2des) + l2*m2*sin(q0des + q1des + q2des))*(2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des) + 2*l0*m0*cos(fi0 + q0des) + 2*l1*m0*cos(q0des + q1des) + l1*m1*cos(q0des + q1des)))/(4*(m0 + m1 + m2)^2) - ((2*l2*m0*cos(q0des + q1des + q2des) + 2*l2*m1*cos(q0des + q1des + q2des) + l2*m2*cos(q0des + q1des + q2des))*(2*l2*m0*sin(q0des + q1des + q2des) + 2*l2*m1*sin(q0des + q1des + q2des) + l2*m2*sin(q0des + q1des + q2des) + 2*l0*m0*sin(fi0 + q0des) + 2*l1*m0*sin(q0des + q1des) + l1*m1*sin(q0des + q1des)))/(4*(m0 + m1 + m2)^2)))];
                
                obj.ddq_des(:,step) = (obj.dq_des(:,step) - obj.dq_des(:,step-1))/timeStep;
                desiredPosition(:,step) = desiredPosition(:,step-1) + timeStep * [vx; vy];
            end
            desiredState = vertcat(obj.q_des(:,step), obj.dq_des(:,step));
            system.refreshMatricesForRK4(desiredState); %puts the desired values in the system matrices
            
            usol = system.H \ (system.M * obj.ddq_des(:,step) + system.C);
            system.refreshMatrices();  %restores the actual values
            
            error_p = stateVariables(2:3,step) - obj.q_des(2:3,step);
            if abs(error_p(1)) > pi
                error_p(1) = wrapToPi(stateVariables(2,step)) - wrapToPi(obj.q_des(2,step));
            end
            if abs(error_p(2)) > pi
                error_p(2) = wrapToPi(stateVariables(3,step)) - wrapToPi(obj.q_des(3,step));
            end
            error_d = stateVariables(5:6,step) - obj.dq_des(2:3,step);
            
            obj.q_error(:,step) = error_p;
            
            u = usol - obj.P.*error_p - obj.D.*error_d;
            
        end
    end
    
end

