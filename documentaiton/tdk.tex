%% LyX 2.2.2 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[12pt,twoside,magyar,twoside,rightopen]{report}
\usepackage[T1]{fontenc}
\usepackage[latin2]{inputenc}
\usepackage[a4paper]{geometry}
\geometry{verbose,tmargin=2cm,bmargin=2cm,lmargin=3cm,rmargin=2cm,headheight=12pt,headsep=24pt}
\usepackage{fancyhdr}
\pagestyle{fancy}
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}
\usepackage{verbatim}
\usepackage{textcomp}
\usepackage{bm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{setspace}
\onehalfspacing

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline
\providecommand{\tabularnewline}{\\}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%\textwidth 160mm
%\oddsidemargin 0cm
%\topmargin -15mm
\usepackage{bm}
\lhead{}
\cfoot{}\rfoot{\thepage}
\renewcommand{\chaptermark}[1]{\markboth{\MakeUppercase{\thechapter.\ fejezet. #1}}{}}
\newcommand{\tg}{\mathop\mathrm{tg}}
\newcommand{\grad}{\mathop\mathrm{grad}}
\newcommand{\BME}{\hrule\vspace{6pt}{\large Budapesti Mûszaki és Gazdaságtudományi Egyetem\\
Gépészmérnöki Kar\\
Mûszaki Mechanikai Tanszék}}
\newcommand{\szerzo}{Gángó Dániel}
\newcommand{\konzulensek}{%
\hfill%
\parbox[t]{6cm}{\normalsize Témavezetõ:\\
\hspace*{3em}Dr. Zelei Ambrus\\
\hspace*{3em}tudományos munkatárs}}



\usepackage{babel}






\usepackage{babel}






\usepackage{babel}
\usepackage[style=numeric, backend=bibtex]{biblatex}
\addbibresource{irodalomjegyzek.bib} 

\fancyhf{}
\fancyfoot[CE, CO]{\thepage}
\fancyhead[RO]{\rightmark}
\fancyhead[LE]{\leftmark}
%\renewcommand{\footrulewidth}{0.4pt}
\renewcommand{\sectionmark}[1]{\markright{\ \uppercase{#1}}}



\usepackage{babel}

\makeatother

\usepackage{babel}
\begin{document}

\title{\vspace{-5cm}
 \includegraphics[width=0.4\textwidth,keepaspectratio]{bme_skyline}\\
 \BME\vspace{5cm}
 \\
 TDK dolgozat címe\\
 ALULAKTUÁLT ÛRBÉLI ROBOT SZABÁLYOZÁSI MÓDSZEREI}

\author{Készítette: \textsc{\szerzo}}

\date{\vspace{3cm}
 \konzulensek\\
 \vspace{4cm}
 Budapest, 2017}

\maketitle
\pagenumbering{roman}\thispagestyle{empty}

Szerzõi jog \copyright~\szerzo, 2017

\newpage{}\thispagestyle{empty}

\tableofcontents{}

\thispagestyle{empty}

\newpage{}

\chapter{Bevezetés}

\pagenumbering{arabic} 

Az ipari robotok szabályozástechnikájának uralkodó irányzata a rendszer
dinamikáját kompenzáló, lineáris szabályozási módszerek használata.
Ennek nagy hátránya, hogy ezek a szabályozási stratégiák nem használják
ki a rendszer természetes dinamikája adta lehetõségeket, így veszítenek
hatékonyságukból. Az alulaktuált rendszerek vizsgálatakor olyan szabályozók
tervezésére törekszünk, amik a rendszer dinamikáját felhasználva gyorsabb,
energia-hatékonyabb és robusztusabb szabályozást tesznek lehetõvé.

Dolgozatom témája egy ûrbéli robot szabályozási módszereinek vizsgálata.
A robot egy robottestbõl és a hozzá kapcsolódó robotkarból épül fel.
A robot 3 szabadságfokú, de csak két aktuátorral rendelkezik, ezért
alulaktuáltnak tekinthetõ.

Dolgozatomban két szabályozási módszert alkalmaztam a robot irányírásához.
Az egyik módszer az általam már korábban vizsgált, Laplace transzformáción
alapuló szabályozó. A szabályozó implementálása során vizsgáltam a
rendszer ún. relative degree-it, melynek segítségével leírható a szabályozó
jel kimeneten való megjelenése.

A második szabályozási módszer a Wen-Bayard szabályozó algoritmuson
alapszik. Ez a szabályozó azonban önmagában nem alkalmazható alulaktuált
rendszerek irányítására. A perdületmegmaradást felírva kiegészítettem
a szabályozót oly módon, hogy így már alkalmazható legyen az ûrbéli
robot szabályozására.

\chapter{A szabályozási módszerek bemutatása}

\section{Analitikus megoldás Laplace transzformációval}

A szabályozó bemutatása néhány módosítással \cite{Gango2016} forrásból
került átvételre.

Tegyük fel, hogy egy $n$ szabadságfokú rendszer mozgásegyenlete lineáris
az általános koordináták $\bm{q}(t)$ vektorára , és annak elsõ és
második idõ szerinti deriváltjaira, $\dot{\bm{q}}(t)$-re és $\ddot{\bm{q}}(t)$-re
nézve. Ekkor a mozgásegyenlet felírható 
\begin{equation}
\bm{M}\ddot{\bm{q}}+\bm{B}\dot{\bm{q}}+\bm{Kq}+\bm{G}=\bm{Hu}\label{eq:lin-mozgasegyenlet}
\end{equation}
alakban, ahol $\bm{M}\in\mathbb{R}^{n\times n}$ a rendszer tömegmátrixa,
$\bm{B}\in\mathbb{R}^{n\times n}$ a rendszer csillapításait tartalmazó
mátrix, $\bm{K}\in\mathbb{R}^{n\times n}$ a rendszer merevségi mátrixa,
$\bm{G}\in\mathbb{R}^{n}$ a rendszerre ható gravitációs erõk vektora,
$\bm{H}\in\mathbb{R}^{n\times m}$ a rendszer bemeneti mátrixa, $\bm{u}\in\mathbb{R}^{m}$
a rendszerre ható bemenetek vektora. Írjuk elõ, hogy a rendszer aktuátorainak
száma legyen kevesebb a szabadságfokok számánál ($m<n$), ezáltal
a rendszer alulaktuálttá válik.

A rendszer mozgásának elõírásához vezessünk be egy ún. szervo-kényszert:
\begin{equation}
\bm{\sigma}(\bm{q},t)=\bm{f}(\bm{q},t)-\bm{y}_{d}(t)=0,\label{eq:szervo}
\end{equation}
ahol $\bm{f}(\bm{q},t)\in\mathbb{R}^{m}$ egy tetszõleges függvény,
$\bm{y}_{d}(\bm{q},t)\in\mathbb{R}^{m}$ pedig $\bm{f}$ elõírt értéke.
Ahhoz, hogy a Laplace transzformációt alkalmazhassuk, írjuk fel \eqref{eq:szervo}
szervo-kényszert egy köttebb, lineáris alakban:
\begin{equation}
\boldsymbol{\sigma}(\bm{q},t)=\bm{Aq}(t)-\bm{y}_{d}(t)=\mathbf{0}\label{eq:szervo-lin}
\end{equation}
alakban.

Ezek után állítsuk elõ \eqref{eq:lin-mozgasegyenlet} és \eqref{eq:szervo-lin}
egyenletek Laplace-transzformáltját : 
\begin{equation}
\begin{array}{rcl}
(\bm{M}s^{2}+\bm{B}s+\bm{K})\bm{Q}(s)-\dot{\bm{q}}_{0}-s\bm{q}_{0}-\bm{q}_{0}+\bm{G} & = & \bm{HU}(s),\\
\bm{AQ}(s)+\bm{Y}_{d}(s) & = & \mathbf{0},
\end{array}
\end{equation}
ahol $\bm{Q}(s)$ az általános koordináták, $\bm{U}(s)$ a beavatkozó
erõk, $\bm{Y}_{d}(s)$ az elõírt pálya Laplace-transzformáltja, $\bm{q}$
és $\dot{\bm{q}}_{0}$ a rendszer általános koordinátáinak és azok
deriváltjának a $t=0$ idõpillanatban vett kezdeti értékei. Az így
kapott lineáris egyenletrendszert
\begin{equation}
\left[\begin{array}{cc}
(\bm{M}s^{2}+\bm{B}s+\bm{K}) & -\bm{H}\\
\bm{A} & \bm{0}
\end{array}\right]\left[\begin{array}{c}
\bm{Q}(s)\\
\bm{U}(s)
\end{array}\right]=\left[\begin{array}{c}
\dot{\bm{q}}_{0}+s\bm{q}_{0}+\bm{q}_{0}-\bm{G}\\
-\bm{Y}_{d}(s)
\end{array}\right]
\end{equation}
hipermátrixos alakba rendezve, amennyiben a hipermátrix invertálható,
megoldást kapunk $\bm{Q}(s)$-ra és $\bm{U}(s)$-ra. A megoldások
inverz Laplace transzformációját elvégezve megkapjuk a rendszer által
leírt $\bm{q}(t)=\bm{y}_{d}(t)$ pályát, és a pálya kövezéséhez szükséges
$\bm{u}(t)$ beavatkozó erõt. A kapott $\bm{u}$ beavatkozó erõ azonban
csak akkor tartja az elõírt $\bm{y}_{d}$ pályán a rendszert, ha a
rendszer kezdeti $\bm{q}_{0}$ állapota és annak $\dot{\bm{q}}_{0}$
deriváltja rendre megegyezik $\bm{y}_{d}$ és $\dot{\bm{y}}_{d}$
$t=0$ idõpontban vett értékével.

Ahhoz, hogy a rendszer tetszõleges kezdeti értékekkel is az elõírt
pályát kövesse, ki kell egészítenünk egy PD szabályozóval. Ehhez elõ
kell állítanunk a rendszer pályakövetési hibáját:
\begin{equation}
\bm{e}=\bm{y}_{d}-\bm{q},
\end{equation}
és annak idõ szerinti deriváltját:
\begin{equation}
\dot{\bm{e}}=\dot{\bm{y}}_{d}-\dot{\bm{q}},
\end{equation}
melyekbõl kiszámíthatjuk a rendszerre beavatkozó erõinek új vektorát
az alábbi módon:
\begin{equation}
\hat{\bm{u}}(t)=\bm{u}(t)+\bm{Pe}(t)+\bm{D}\dot{\bm{e}}(t).\label{eq:input-vector}
\end{equation}
 Megfelelõen megválasztott 
\begin{equation}
\bm{P}=\text{diag}\left\{ (p_{i})\right\} ,\,p_{i}>0,\,i=1,\ldots,m,
\end{equation}
 
\begin{equation}
\bm{D}=\text{diag}\left\{ (d_{i})\right\} ,\,d_{i}>0,\,i=1,\ldots,m
\end{equation}
 mátrixokkal a rendszer véges idõn belül beáll az elõírt $\bm{y}_{d}$
pályára.

Könnyen látható, hogy \eqref{eq:input-vector} egyenlet két részbõl
épül fel. Az $\bm{u}(t)$ tag, ami a pályán való haladást biztosítja,
valójában egy referenciajel, a $\bm{Pe}(t)+\bm{D}\dot{\bm{e}}(t)$
tagok pedig a hibák korrigálásáért felelnek.

\section{Wen-Bayard szabályozó}

Az itt bemutatott szabályozó \cite{mazur1996universal,Gango2016}
eredetileg nem alulaktuált rendszerek irányítására lett kifejlesztve,
de ahogy késõbb REF-ben láthatjuk, kiegészíthetõ úgy, hogy bizonyos
alulaktuált rendszerekhez is alkalmazható legyen.

A szabályozó alapgondolata, hogy az elõírt $\bm{y}_{d}=\bm{q}_{d}$
pályát a mozgásegyenletbe behelyettesítve állítjuk elõ a beavatkozó
erõk alapjelét,
\begin{equation}
\bm{u}=\bm{M}(\bm{q}_{d})\ddot{\bm{q}}_{d}+\bm{C}(\dot{\bm{q}}_{d},\bm{q}_{d})\dot{\bm{q}}_{d}+\bm{G}(\bm{q}).\label{eq:wen-bayard}
\end{equation}
 \eqref{eq:input-vector} egyenlethez hasonlóan, 
\begin{equation}
\bm{e}=\bm{q}_{d}-\bm{q},
\end{equation}
\begin{equation}
\dot{\bm{e}}=\dot{\bm{q}}_{d}-\dot{\bm{q}}
\end{equation}
hibavektorokat bevezetve \eqref{eq:wen-bayard} is kiegészíthetõ egy
korrigáló PD szabályozóval,
\begin{equation}
\hat{\bm{u}}=\bm{M}(\bm{q}_{d})\ddot{\bm{q}}_{d}+\bm{C}(\dot{\bm{q}}_{d},\bm{q}_{d})\dot{\bm{q}}_{d}+\bm{G}(\bm{q})+\bm{Pe}(t)+\bm{D}\dot{\bm{e}}(t).\label{eq:wen-bayard-pd}
\end{equation}

Fontos megjegyezni, hogy alulaktuált rendszereknél $m$ beavatkozó
esetén $m$ kényszer írható elõ, ami kevesebb, mint a $\bm{q}$ vektor
$n$ dimenziója. Következésképp alulaktuált rendszerek szabályozására
\eqref{eq:wen-bayard-pd} önmagában nem alkalmazható.

\chapter{Az ûrbéli robot mozgásegyenletének felírása}

Az ûrbéli robot 2 dimenziós modellje egy robottestbõl és a hozzá kapcsolódó
robotkarból épül fel (\ref{fig:Az-=000171rb=0000E9li-robot-fel=0000E9p=0000EDt=0000E9se}
ábra). A robot két aktuátorral rendelkezik, melyek a robotkaron találhatók.
A robot 3 rotációs szabadsági fokkal (mindhárom rész elfordulása),
és 2 transzlációs szabadsági fokkal (a robot $x$ - $y$ síkbeli pozíciója)
rendelkezik ( \ref{fig:=0000E1ltal=0000E1nos-koordin=0000E1t=0000E1k}
ábra) . A \ref{fig:Az-=000171rb=0000E9li-robot-fel=0000E9p=0000EDt=0000E9se}
ábrán jelölt fizikai mennyiségek numerikus értékeit a \ref{tab:A-robotra-jellemz=000151-fizikai-mennyis=0000E9gek}
táblázat tartalmazza.

\begin{figure}[h]
\begin{centering}
\includegraphics[scale=0.35]{image/robot_paramss}
\par\end{centering}
\caption{Az ûrbéli robot felépítése\label{fig:Az-=000171rb=0000E9li-robot-fel=0000E9p=0000EDt=0000E9se}}

\end{figure}

\begin{figure}[h]
\begin{centering}
\includegraphics[scale=0.35]{image/robot}
\par\end{centering}
\caption{A robot mozgását leíró általános koordináták\label{fig:=0000E1ltal=0000E1nos-koordin=0000E1t=0000E1k}}
\end{figure}
\begin{table}[h]
\begin{centering}
\begin{tabular}{|c|c|}
\hline 
jelölés & érték\tabularnewline
\hline 
\hline 
$\varphi_{0}$ & $30\,\text{\textdegree}$\tabularnewline
\hline 
$m_{0}$ & $40\,\mathrm{kg}$\tabularnewline
\hline 
$m_{1}$ & $4\,\mathrm{kg}$\tabularnewline
\hline 
$m_{2}$ & $3\,\mathrm{kg}$\tabularnewline
\hline 
$\theta_{0}$ & $6,667\,\mathrm{kgm^{2}}$\tabularnewline
\hline 
$\theta_{1}$ & $0,333\,\mathrm{kgm^{2}}$\tabularnewline
\hline 
$\theta_{2}$ & $0,25\,\mathrm{kgm^{2}}$\tabularnewline
\hline 
$l_{0}$ & $1\,\mathrm{m}$\tabularnewline
\hline 
$l_{1}$ & $1\,\mathrm{m}$\tabularnewline
\hline 
$l_{2}$ & $1\,\mathrm{m}$\tabularnewline
\hline 
\end{tabular}
\par\end{centering}
\caption{A robotra jellemzõ fizikai mennyiségek\label{tab:A-robotra-jellemz=000151-fizikai-mennyis=0000E9gek}}

\end{table}

Mivel a rendszer nem tartalmaz disszipatív elemeket, illetve nem hatnak
rá külsõ erõk, felírható rá a lendületmegmaradás tétele. Ennek következtében
a két transzlációs szabadsági fok elhanyagolható, hiszen lendületmegmaradás
értelmében a rendszer közös súlypontja nyugalomban van, vagy egyenes
vonalú egyenletes mozgást végez. Tehát ha a közös súlyponthoz rögzített
koordináta-rendszerbõl vizsgáljuk a rendszert, a szabadsági fokok
száma 3-ra redukálódik. Így a robot mozgása leírható a három rész
elfordulását jellemzõ szögkoordinátával (\ref{fig:=0000E1ltal=0000E1nos-koordin=0000E1t=0000E1k}
ábra),
\[
\bm{q}(t)=\left[\begin{array}{c}
q_{0}(t)\\
q_{1}(t)\\
q_{2}(t)
\end{array}\right].
\]

A mozgási egyenlet felírásához a másodfajú Lagrange egyenletet használjuk,

\begin{equation}
\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial\mathcal{T}}{\partial\dot{q}_{j}}-\frac{\partial\mathcal{T}}{\partial q_{j}}+\frac{\partial\mathcal{D}}{\partial\dot{q_{j}}}+\frac{\partial\mathcal{U}}{\partial q_{j}}=Q_{j},\;j=1...n,\label{lagrange}
\end{equation}

ahol $\mathcal{T}$ a rendszer összes mozgási energiája, $\mathcal{D}$
a disszipatív potenciál, $\mathcal{U}$ a rendszer potenciális energiája.
$Q_{j}$ jelöli a rendszerre ható általános erõket, $q_{j}$ pedig
az $n$ szabadságfokú rendszer $j.$ általános koordinátáját. Az ûrbáli
robot esetében a disszipatív potenciál és a potenciális energia is
azonosan nulla.

A rendszer összes mozgási energiája

\begin{equation}
T=\sum_{i=0}^{2}\frac{1}{2}m_{i}\boldsymbol{v}_{i}^{2}+\frac{1}{2}\theta_{i}\omega_{i}^{2},
\end{equation}
ahol $m_{i}$ a robot egyes részeinek tömege, $\bm{v}_{i}$ a sebességvektora,
$\theta_{i}$ a tehetetlenségi nyomatéka és $\omega_{i}$ a szögsebessége. 

Az egyes részek szögsebességei a következõképpen írhatók fel:
\begin{equation}
\omega_{0}=\dot{q}_{0},
\end{equation}
\begin{equation}
\omega_{1}=\dot{q}_{0}+\dot{q}_{1},
\end{equation}
\begin{equation}
\omega_{2}=\dot{q}_{0}+\dot{q}_{1}+\dot{q}_{2}.
\end{equation}

A sebességvektorok elõállításához elõször fel kell írnunk az egyes
részek súlypontjába mutató helyvektorokat, melyek a következõk:

\begin{equation}
\boldsymbol{r}_{0}=\left[\begin{array}{c}
x_{0}\\
y_{0}
\end{array}\right],
\end{equation}
\begin{equation}
\boldsymbol{r}_{1}=\left[\begin{array}{c}
x_{0}+l_{0}\cos(\varphi_{0}+q_{0})+\frac{l_{1}}{2}\cos(q_{0}+q_{1})\\
y_{0}+l_{0}\sin(\varphi_{0}+q_{0})+\frac{l_{1}}{2}\sin(q_{0}+q_{1})
\end{array}\right],
\end{equation}

\begin{equation}
\boldsymbol{r}_{2}=\left[\begin{array}{c}
x_{0}+l_{0}\cos(\varphi_{0}+q_{0})+l_{1}\cos(q_{0}+q_{1})+\frac{l_{2}}{2}\cos(q_{0}+q_{1}+q_{2})\\
y_{0}+l_{0}\sin(\varphi_{0}+q_{0})+l_{1}\sin(q_{0}+q_{1})+\frac{l_{2}}{2}\sin(q_{0}+q_{1}+q_{2})
\end{array}\right].
\end{equation}

A különálló részek súlypontjába mutató helyvektorokból kiszámítható
a rendszer közös súlypontja
\begin{equation}
\boldsymbol{r}_{S}=\frac{m_{0}\boldsymbol{r}_{0}+m_{1}\boldsymbol{r}_{1}+m_{2}\boldsymbol{r}_{2}}{m_{0}+m_{1}+m_{2}}.
\end{equation}

Ahhoz, hogy a közös súlyponthoz rögzített koordináta-rendszerbõl vizsgáljuk
a rendszert, fel kell írnunk a közös súlypontból az egyes részek súlypontjaiba
mutató helyvektorokat a \ref{fig:s=0000FAlypont} ábrának megfelelõen.

\begin{figure}[h]
\begin{centering}
\includegraphics[scale=0.35]{image/robot_com}
\par\end{centering}
\caption{Az egyes részek súlypontjai és a közös súlypont\label{fig:s=0000FAlypont}}
\end{figure}
\begin{equation}
\begin{array}{c}
\bm{\rho}_{0}=\bm{r}_{0}-\bm{r}_{S}=\\
\left[\begin{array}{c}
-\frac{2l_{0}(m_{1}+m_{2})\cos(\varphi_{0}+q_{0})+l_{1}(m_{1}+2m_{2})\cos(q_{0}+q_{1})+l_{2}m_{2}\cos(q_{0}+q_{1}+q_{2})}{2(m_{0}+m_{1}+m_{2})}\\
-\frac{2l_{0}(m_{1}+m_{2})\sin(\varphi_{0}+q_{0})+l_{1}(m_{1}+2m_{2})\sin(q_{0}+q_{1})+l_{2}m_{2}\sin(q_{0}+q_{1}+q_{2})}{2(m_{0}+m_{1}+m_{2})}
\end{array}\right],
\end{array}
\end{equation}
\begin{equation}
\begin{array}{c}
\bm{\rho}_{1}=\bm{r}_{1}-\bm{r}_{S}=\\
\left[\begin{array}{c}
\frac{2l_{0}m_{0}\cos(\varphi_{0}+q_{0})+l_{1}(m_{0}-m_{2})\cos(q_{0}+q_{1})-l_{2}m_{2}\cos(q_{0}+q_{1}+q_{2})}{2(m_{0}+m_{1}+m_{2})}\\
\frac{2l_{0}m_{0}\sin(\varphi_{0}+q_{0})+l_{1}(m_{0}-m_{2})\sin(q_{0}+q_{1})-l_{2}m_{2}\sin(q_{0}+q_{1}+q_{2})}{2(m_{0}+m_{1}+m_{2})}
\end{array}\right],
\end{array}
\end{equation}
\begin{equation}
\begin{array}{c}
\bm{\rho}_{2}=\bm{r}_{2}-\bm{r}_{S}=\\
\left[\begin{array}{c}
\frac{2l_{0}m_{0}\cos(\varphi_{0}+q_{0})+l_{1}(2m_{0}+m_{1})\cos(q_{0}+q_{1})+l_{2}(m_{0}+m_{1})\cos(q_{0}+q_{1}+q_{2})}{2(m_{0}+m_{1}+m_{2})}\\
\frac{2l_{0}m_{0}\sin(\varphi_{0}+q_{0})+l_{1}(2m_{0}+m_{1})\sin(q_{0}+q_{1})+l_{2}(m_{0}+m_{1})\sin(q_{0}+q_{1}+q_{2})}{2(m_{0}+m_{1}+m_{2})}
\end{array}\right].
\end{array}
\end{equation}
Látható, hogy ezekben a vektorokban már nem szerepelnek az $x_{0}$
és $y_{0}$ koordináták, tehát a rendszer valóban 3 szabadságfokúra
egyszerûsödött.

A sebességvektorok elõállításához vegyük a fent kiszámított helyvektorok
idõ szerinti deriváltját:
\begin{center}
\begin{equation}
\begin{array}{c}
\bm{v}_{0}=\frac{d\bm{\rho}_{0}}{dt}=\\
\left[\begin{array}{c}
-\frac{-2l_{0}(m_{1}+m_{2})\dot{q}_{0}\sin(\varphi_{0}+q_{0})-l_{1}(m_{1}+2m_{2})\left(\dot{q}_{0}+\dot{q}_{1}\right)\sin(q_{0}+q_{1})-l_{2}m_{2}\left(\dot{q}_{0}+\dot{q}_{1}+\dot{q}_{2}\right)\sin(q_{0}+q_{1}+q_{2})}{2(m_{0}+m_{1}+m_{2})}\\
-\frac{2l_{0}(m_{1}+m_{2})\dot{q}_{0}\cos(\varphi_{0}+q_{0})+l_{1}(m_{1}+2m_{2})\left(\dot{q}_{0}+\dot{q}_{1}\right)\cos(q_{0}+q_{1})+l_{2}m_{2}\left(\dot{q}_{0}+\dot{q}_{1}+\dot{q}_{2}\right)\cos(q_{0}+q_{1}+q_{2})}{2(m_{0}+m_{1}+m_{2})}
\end{array}\right],
\end{array}
\end{equation}
\par\end{center}

\begin{center}
\begin{equation}
\begin{array}{c}
\bm{v}_{1}=\frac{d\bm{\rho}_{1}}{dt}=\\
\left[\begin{array}{c}
\frac{-2l_{0}m_{0}\dot{q}_{0}\sin(\varphi_{0}+q_{0})-l_{1}(m_{0}-m_{2})\left(\dot{q}_{0}+\dot{q}_{1}\right)\sin(q_{0}+q_{1})+l_{2}m_{2}\left(\dot{q}_{0}+\dot{q}_{1}+\dot{q}_{2}\right)\sin(q_{0}+q_{1}+q_{2})}{2(m_{0}+m_{1}+m_{2})}\\
\frac{2l_{0}m_{0}\dot{q}_{0}\cos(\varphi_{0}+q_{0})+l_{1}(m_{0}-m_{2})\left(\dot{q}_{0}+\dot{q}_{1}\right)\cos(q_{0}+q_{1})-l_{2}m_{2}\left(\dot{q}_{0}+\dot{q}_{1}+\dot{q}_{2}\right)\cos(q_{0}+q_{1}+q_{2})}{2(m_{0}+m_{1}+m_{2})}
\end{array}\right],
\end{array}
\end{equation}
\begin{equation}
\begin{array}{c}
\bm{v}_{2}=\frac{d\bm{\rho}_{2}}{dt}=\\
\left[\begin{array}{c}
\frac{-2l_{0}m_{0}\dot{q}_{0}\sin(\varphi_{0}+q_{0})-l_{1}(2m_{0}+m_{1})\left(\dot{q}_{0}+\dot{q}_{1}\right)\sin(q_{0}+q_{1})-l_{2}(m_{0}+m_{1})\left(\dot{q}_{0}+\dot{q}_{1}+\dot{q}_{2}\right)\sin(q_{0}+q_{1}+q_{2})}{2(m_{0}+m_{1}+m_{2})}\\
\frac{2l_{0}m_{0}\dot{q}_{0}\cos(\varphi_{0}+q_{0})+l_{1}(2m_{0}+m_{1})\left(\dot{q}_{0}+\dot{q}_{1}\right)\cos(q_{0}+q_{1})+l_{2}(m_{0}+m_{1})\left(\dot{q}_{0}+\dot{q}_{1}+\dot{q}_{2}\right)\cos(q_{0}+q_{1}+q_{2})}{2(m_{0}+m_{1}+m_{2})}
\end{array}\right].
\end{array}
\end{equation}
\par\end{center}

Ezek után a másodfajú Lagrange egyenlet \eqref{lagrange} segítségével
felírhatjuk a rendszer mozgásegyenletét, ami a következõ alakban írható
fel:
\begin{equation}
\bm{M}(\bm{q})\ddot{\bm{q}}+\bm{C}(\bm{q},\dot{\bm{q}})=\bm{Hu},
\end{equation}
ahol $\bm{M}$ a rendszer tömegmátrixa, $\bm{C}$ a centripetális
és Coriolis erõket tartalmazó vektor, 
\begin{equation}
\bm{H}=\left[\begin{array}{cc}
1 & 0\\
0 & 1
\end{array}\right]
\end{equation}
 a rendszer bemeneti mátrixa, 
\begin{equation}
\bm{u}=\left[\begin{array}{c}
u_{1}\\
u_{2}
\end{array}\right]
\end{equation}
 pedig a bemeneti nyomatékok vektora. Terjedelmük miatt az $\bm{M}$
és $\bm{C}$ mátrixok az \ref{chap:A-robot-mozg=0000E1segyenlet=0000E9nek}
függelékben találhatók.

\chapter{A rendszer relatív foka}

\section{Definíció}

Az ún. relatív fok (relative degree) fontos szerepet játszik a nemlineáris
rendszerek szabályozásában. Használatával leírhatjuk a bemenetek és
kimenetek közt fellépõ kapcsolatot. \cite{bencsik2017dynamic,hangos2006analysis}

A relatív fok definiálásához vegyünk egy általános egy bemenetû, egy
kimenetû (SISO) rendszert:
\begin{equation}
\dot{\bm{x}}=\bm{f}(\bm{x})+\bm{g}(\bm{x})u,\label{eq:rel-deg-xdot}
\end{equation}
ahol $\bm{x}=\left[\bm{q}\,\dot{\bm{q}}\right]^{\mathrm{T}},\,\bm{x}\in\mathbb{R}^{2n}$
a rendszer állapotvektora. A rendszer kimenete pedig legyen
\begin{equation}
y=h(\bm{x}).\label{eq:rel-deg-output}
\end{equation}

Ha a rendszer kimenetét $r$-szer differenciáljuk az idõ szerint addig,
amíg az $u$ bemenet explicit módon meg nem jelenik a kifejezésben,
akkor $r$ a rendszer bemenete és kimenete közti relatív fok. Behelyettesítve
\eqref{eq:rel-deg-xdot} egyenletet, \eqref{eq:rel-deg-output} idõ
szerinti deriváltja a következõ:
\begin{equation}
\frac{dy}{dt}=\frac{\partial h(\bm{x})}{\partial\bm{x}}\dot{\bm{x}}=\frac{\partial h(\bm{x})}{\partial\bm{x}}\bm{f}(\bm{x})+\frac{\partial h(\bm{x})}{\partial\bm{x}}\bm{g}(\bm{x})u.
\end{equation}

A jelölések egyszerûsítésének érdekében vezessük be az ún. Lie-derivált
fogalmát:
\[
\frac{\partial h(\bm{x})}{\partial\bm{x}}\bm{f}(\bm{x})=L_{f}h.
\]

A következõkben számítsuk ki a kimenet $k.$ idõ szerinti deriváltját
\cite{hangos2006analysis}:
\begin{itemize}
\item $k=0$:
\[
y=h(\bm{x})
\]
\item $k=1$
\[
\frac{dy}{dt}=\frac{\partial h(\bm{x})}{\partial\bm{x}}\dot{\bm{x}}=\frac{\partial h(\bm{x})}{\partial\bm{x}}(\bm{f}(\bm{x})+\bm{g}(\bm{x})u)=L_{f}h+L_{g}h\cdot u
\]
Feltételezzük, hogy $L_{g}h=0$, így $\dot{y}=L_{f}h$.
\item $k=2$
\[
\frac{d^{2}y}{dt^{2}}==\frac{\partial(L_{f}h)}{\partial\bm{x}}(\bm{f}(\bm{x})+\bm{g}(\bm{x})u)=L_{f}^{2}h+L_{g}L_{f}h\cdot u
\]
Ha $L_{g}L_{f}h\neq0$, akkor $r=2$, ellenkezõ esetben folytatjuk
a differenciálást, amíg a feltétel nem teljesül.
\end{itemize}
A relatív fok általános definíciója tehát a következõ \cite{hangos2006analysis}:

Egy nemlineáris, egy bemenetû, egy kimenetû (SISO) rendszer
\begin{align*}
\dot{\bm{x}} & =\bm{f}(\bm{x})+\bm{g}(\bm{x})u\\
y & =h(\bm{x})
\end{align*}
relatív foka $r$ az $\bm{x}^{0}$ pontban, ha
\begin{enumerate}
\item $L_{g}L_{f}^{k}h(\bm{x})=0$ minden $\bm{x}$-re az $\bm{x}^{0}$
pont környezetében minden $k$-ra úgy, hogy $k<r-1$.
\item $L_{g}L_{f}^{r-1}h(\bm{x}^{0})\neq0.$
\end{enumerate}
Fontos megjegyezni, hogy a relatív fok értelmezhetõ több bemenetû,
több kimenetû (MIMO) rendszerekre is. Ekkor a relatív fokokat páronként,
az összes lehetséges bemenet-kimenet kombinációra számítjuk \cite{hangos2006analysis}.

\section{Az ûrbéli robot relatív fokai}

\chapter{Összefoglalás}

\begin{comment}
\bibliographystyle{plain}
\addcontentsline{toc}{chapter}{\bibname}\nocite{*}
\bibliography{irodalomjegyzek}
\end{comment}
\nocite{*}
\printbibliography[ heading=bibintoc, title={Irodalomjegyzék} ]


\appendix
%dummy comment inserted by tex2lyx to ensure that this paragraph is not empty%dummy comment inserted by tex2lyx to ensure that this paragraph is not empty%dummy comment inserted by tex2lyx to ensure that this paragraph is not empty%dummy comment inserted by tex2lyx to ensure that this paragraph is not empty

\chapter*{Függelék}

\addcontentsline{toc}{chapter}{Függelék} \setcounter{chapter}{6}
%\setcounter{equation}{0} % a fofejezet-szamlalo az angol ABC 6. betuje (F) lesz \numberwithin{equation}{section} \numberwithin{figure}{section}


\section{A robot mozgásegyenletének mátrixai\label{chap:A-robot-mozg=0000E1segyenlet=0000E9nek}}

Az ûrbéli robot mozgásegyenletének tömegmátrixa
\begin{equation}
\bm{M}=\left[\begin{array}{ccc}
m_{11} & m_{12} & m_{13}\\
m_{21} & m_{22} & m_{23}\\
m_{31} & m_{32} & m_{33}
\end{array}\right],
\end{equation}
ahol
\begin{equation}
\begin{array}{cc}
m_{11}= & \frac{4l_{0}l_{1}m_{0}(m_{1}+2m_{2})\cos(\varphi_{0}-q_{1})+4l_{0}l_{2}m_{0}m_{2}\cos(\varphi_{0}-q_{1}-q_{2})+4\theta_{0}m_{0}+4\theta_{0}m_{1}+4\theta_{0}m_{2}}{4(m_{0}+m_{1}+m_{2})}+\\
 & \frac{4\theta_{1}m_{0}+4\theta_{1}m_{1}+4\theta_{1}m_{2}+4\theta_{2}m_{0}+4\theta_{2}m_{1}+4\theta_{2}m_{2}+4l_{0}^{2}m_{0}m_{1}+4l_{0}^{2}m_{0}m_{2}+l_{1}^{2}m_{0}m_{1}}{4(m_{0}+m_{1}+m_{2})}+\\
 & \frac{4l_{1}^{2}m_{0}m_{2}+l_{1}^{2}m_{1}m_{2}+4l_{1}l_{2}m_{0}m_{2}\cos(q_{2})+2l_{1}l_{2}m_{1}m_{2}\cos(q_{2})+l_{2}^{2}m_{0}m_{2}+l_{2}^{2}m_{1}m_{2}}{4(m_{0}+m_{1}+m_{2})},
\end{array}
\end{equation}
\begin{equation}
\begin{array}{cc}
m_{12}= & \frac{2l_{0}l_{1}m_{0}(m_{1}+2m_{2})\cos(\varphi_{0}-q_{1})+2l_{0}l_{2}m_{0}m_{2}\cos(\varphi_{0}-q_{1}-q_{2})+4\theta_{1}m_{0}}{4(m_{0}+m_{1}+m_{2})}+\\
 & \frac{4\theta_{1}m_{1}+4\theta_{1}m_{2}+4\theta_{2}m_{0}+4\theta_{2}m_{1}+4\theta_{2}m_{2}+l_{1}^{2}m_{0}m_{1}+4l_{1}^{2}m_{0}m_{2}+}{4(m_{0}+m_{1}+m_{2})}+\\
 & \frac{l_{1}^{2}m_{1}m_{2}+4l_{1}l_{2}m_{0}m_{2}\cos(q_{2})+2l_{1}l_{2}m_{1}m_{2}\cos(q_{2})+l_{2}^{2}m_{0}m_{2}+l_{2}^{2}m_{1}m_{2}}{4(m_{0}+m_{1}+m_{2})},
\end{array}
\end{equation}
\begin{equation}
\begin{array}{cc}
m_{13}= & \frac{2l_{0}l_{2}m_{0}m_{2}\cos(\varphi_{0}-q_{1}-q_{2})+4\theta_{2}m_{0}+4\theta_{2}m_{1}+4\theta_{2}m_{2}}{4(m_{0}+m_{1}+m_{2})}+\\
 & \frac{l_{1}l_{2}m_{2}(2m_{0}+m_{1})\cos(q_{2})+l_{2}^{2}m_{0}m_{2}+l_{2}^{2}m_{1}m_{2}}{4(m_{0}+m_{1}+m_{2})},
\end{array}
\end{equation}
\begin{equation}
\begin{array}{cc}
m_{21}= & \frac{2l_{0}l_{1}m_{0}(m_{1}+2m_{2})\cos(\varphi_{0}-q_{1})+2l_{0}l_{2}m_{0}m_{2}\cos(\varphi_{0}-q_{1}-q_{2})+4\theta_{1}m_{0}}{4(m_{0}+m_{1}+m_{2})}+\\
 & \frac{4\theta_{1}m_{1}+4\theta_{1}m_{2}+4\theta_{2}m_{0}+4\theta_{2}m_{1}+4\theta_{2}m_{2}+l_{1}^{2}m_{0}m_{1}+4l_{1}^{2}m_{0}m_{2}+}{4(m_{0}+m_{1}+m_{2})}+\\
 & \frac{l_{1}^{2}m_{1}m_{2}+4l_{1}l_{2}m_{0}m_{2}\cos(q_{2})+2l_{1}l_{2}m_{1}m_{2}\cos(q_{2})+l_{2}^{2}m_{0}m_{2}+l_{2}^{2}m_{1}m_{2}}{4(m_{0}+m_{1}+m_{2})},
\end{array}
\end{equation}
\begin{equation}
\begin{array}{cc}
m_{22}= & \frac{4\theta_{1}(m_{0}+m_{1}+m_{2})+4\theta_{2}m_{0}+4\theta_{2}m_{1}+4\theta_{2}m_{2}+l_{1}^{2}m_{0}m_{1}4l_{1}^{2}m_{0}m_{2}}{4(m_{0}+m_{1}+m_{2})}+\\
 & \frac{l_{1}^{2}m_{1}m_{2}+2l_{1}l_{2}m_{2}(2m_{0}+m_{1})\cos(q_{2})+l_{2}^{2}m_{0}m_{2}+l_{2}^{2}m_{1}m_{2}}{4(m_{0}+m_{1}+m_{2})},
\end{array}
\end{equation}
\begin{equation}
m_{23}=\frac{4\theta_{2}(m_{0}+m_{1}+m_{2})+l_{1}l_{2}m_{2}(2m_{0}+m_{1})\cos(q_{2})+l_{2}^{2}m_{2}(m_{0}+m_{1})}{4(m_{0}+m_{1}+m_{2})},
\end{equation}
\begin{equation}
\begin{array}{cc}
m_{31}= & \frac{2l_{0}l_{2}m_{0}m_{2}\cos(\varphi_{0}-q_{1}-q_{2})+4\theta_{2}m_{0}+4\theta_{2}m_{1}+4\theta_{2}m_{2}}{4(m_{0}+m_{1}+m_{2})}+\\
 & \frac{l_{1}l_{2}m_{2}(2m_{0}+m_{1})\cos(q_{2})+l_{2}^{2}m_{0}m_{2}+l_{2}^{2}m_{1}m_{2}}{4(m_{0}+m_{1}+m_{2})},
\end{array}
\end{equation}
\begin{equation}
m_{32}=\frac{4\theta_{2}(m_{0}+m_{1}+m_{2})+l_{1}l_{2}m_{2}(2m_{0}+m_{1})\cos(q_{2})+l_{2}^{2}m_{2}(m_{0}+m_{1})}{4(m_{0}+m_{1}+m_{2})},
\end{equation}
\begin{equation}
m_{33}=\frac{4\theta_{2}(m_{0}+m_{1}+m_{2})+l_{2}^{2}m_{2}(m_{0}+m_{1})}{4(m_{0}+m_{1}+m_{2})}.
\end{equation}

A centripetális és Coriolis erõket tartalmazó vektor
\begin{equation}
\bm{C}=\left[\begin{array}{c}
c_{1}\\
c_{2}\\
c_{3}
\end{array}\right],
\end{equation}
 ahol
\begin{equation}
\begin{array}{cc}
c_{1}= & -\frac{2l_{2}m_{2}\dot{q}_{2}\left(\dot{q}_{0}+\dot{q}_{1}\right)(l_{1}(2m_{0}+m_{1})\sin(q_{2})-2l_{0}m_{0}\sin(\varphi_{0}-q_{1}-q_{2}))}{4(m_{0}+m_{1}+m_{2})}+\\
 & \frac{-2l_{0}m_{0}\dot{q}_{1}\left(2\dot{q}_{0}+\dot{q}_{1}\right)(l_{1}(m_{1}+2m_{2})\sin(\varphi_{0}-q_{1})+l_{2}m_{2}\sin(\varphi_{0}-q_{1}-q_{2}))}{4(m_{0}+m_{1}+m_{2})}+\\
 & \frac{l_{2}m_{2}\dot{q}_{2}^{2}(l_{1}(2m_{0}+m_{1})\sin(q_{2})-2l_{0}m_{0}\sin(\varphi_{0}-q_{1}-q_{2}))}{4(m_{0}+m_{1}+m_{2})},
\end{array}
\end{equation}
\begin{equation}
\begin{array}{cc}
c_{2}= & -\frac{2l_{0}m_{0}\dot{q}_{0}^{2}(l_{1}(m_{1}+2m_{2})\sin(\varphi_{0}-q_{1})+l_{2}m_{2}\sin(\varphi_{0}-q_{1}-q_{2}))}{4(m_{0}+m_{1}+m_{2})}\\
 & \frac{+2l_{1}l_{2}m_{2}(2m_{0}+m_{1})\dot{q}_{0}\dot{q}_{2}\sin(q_{2})+l_{1}l_{2}m_{2}(2m_{0}+m_{1})\dot{q}_{2}\sin(q_{2})\left(2\dot{q}_{1}+\dot{q}_{2}\right)}{4(m_{0}+m_{1}+m_{2})}+
\end{array}
\end{equation}
\begin{equation}
\begin{array}{cc}
c_{3}= & \frac{l_{2}m_{2}\dot{q}_{0}^{2}(l_{1}(2m_{0}+m_{1})\sin(q_{2})-2l_{0}m_{0}\sin(\varphi_{0}-q_{1}-q_{2}))}{4(m_{0}+m_{1}+m_{2})}+\\
 & \frac{l_{2}m_{2}\left(2l_{1}(2m_{0}+m_{1})\dot{q}_{0}\dot{q}_{1}\sin(q_{2})+l_{1}(2m_{0}+m_{1})\dot{q}_{1}^{2}\sin(q_{2})\right)}{4(m_{0}+m_{1}+m_{2})}.
\end{array}
\end{equation}

\end{document}
